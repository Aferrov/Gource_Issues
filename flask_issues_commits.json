[
    {
        "id": 5881,
        "title": "asgiref fails with gevent patching",
        "body": "When `gevent.monkey.patch_all()` is used, `async def` functions fail when multiple concurrent requests are sent. asgiref gives the error `RuntimeError: You cannot use AsyncToSync in the same thread as an async event loop - just await the async function directly.`. This suggests that somehow, gevent is causing a running loop to be visible across threads.\n\n`example.py`:\n\n```python\n# /// script\n# requires-python = \"~=3.14.0\"\n# dependencies = [\n#     \"flask[async]\",\n#     \"gevent\",\n# ]\n#\n# [tool.uv]\n# exclude-newer = \"2026-01-05T00:00:00Z\"\n#\n# [tool.uv.sources]\n# flask = { path = \".\", editable = true }\n# ///\n\nimport gevent.monkey\ngevent.monkey.patch_all()\n\nimport asyncio\n\nfrom flask import Flask\n\napp = Flask(__name__)\n\n@app.get(\"/\")\nasync def hello_world():\n    await asyncio.sleep(0.5)\n    return f\"Hello, World!\"\n```\n\n```\nuv run --with-requirements example.py flask -A example.py run\n```\n\n`load.py`:\n\n```python\n# /// script\n# requires-python = \"~=3.14.0\"\n# dependencies = [\n#     \"httpx\",\n# ]\n#\n# [tool.uv]\n# exclude-newer = \"2026-01-05\"\n# ///\n\nimport asyncio\nimport httpx\n\nasync def get(i, client: httpx.AsyncClient):\n    r = await client.get(\"http://127.0.0.1:5000\")\n    print(i, await r.aread())\n\nasync def main():\n    async with httpx.AsyncClient() as client, asyncio.TaskGroup() as group:\n        for i in range(50):\n            group.create_task(get(i, client))\n\nasyncio.run(main())\n```\n\n```\nuv run load.py\n```\n\nContinues #5817 with more details.",
        "user": "davidism",
        "start_time": "2026-01-05T18:52:04Z",
        "end_time": null,
        "state": "open",
        "labels": [
            "docs"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5885,
                "title": "clarify async view incompatibility with gevent monkey patching",
                "url": "https://github.com/pallets/flask/pull/5885",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "bec6b5ba460c0d0af9daf1707219ded5eb11f321",
                "message": "clarify async view incompatibility with gevent monkey patching",
                "author": "Mind freezer",
                "date": "2026-01-10T19:47:28Z"
            }
        ],
        "affected_files": [
            "docs/async-await.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 1,
            "total_prs": 1
        }
    },
    {
        "id": 5870,
        "title": "Teardown handler chain exception handling",
        "body": "Flask executes registered teardown handlers (used for closing DB connections, releasing locks, etc.) in a chain. The do_teardown_request method which is supposed to make these teardown requests does not wrap individual handlers in a try/except block. If one handler raises an exception, the loop terminates immediately, and all subsequent handlers are skipped, this can lead to the application to skip critical cleanup routines if a non critical one fails.\n\nSample reproduction code\n```python\nimport threading\nimport time\nimport requests\nfrom flask import Flask\n\napp = Flask(__name__)\n\n#a simulation of a limited resource pool\nmock_db_connections = 0\n\n@app.route('/')\ndef index():\n    global mock_db_connections\n    mock_db_connections = mock_db_connections + 1\n    return \"Request Processed\"\n\n#simulating a critical teardown handler which is supposed to free resources from the db\n@app.teardown_request\ndef critical_db_close(exc):\n    global mock_db_connections\n    mock_db_connections = mock_db_connections - 1\n\n#teardown handler which can crash\n@app.teardown_request\ndef buggy_extension(exc):\n    raise Exception(\"Crash in buggy extension!\")\n\ndef run_server():\n    #just for clearner output\n    import logging\n    log = logging.getLogger('werkzeug')\n    log.setLevel(logging.ERROR)\n    app.logger.disabled = True\n    \n    app.run(port=5000, threaded=True)\n\ndef verify_bug():\n    \n    print(f\"Initial DB Connections: {mock_db_connections}\")\n    \n    try:\n        requests.get('http://127.0.0.1:5000/')\n    except Exception:\n        pass\n\n    #wait time to ensure teardown has happened in the other thread\n    time.sleep(1)\n    \n    print(f\"Final DB Connections: {mock_db_connections}\")\n    \n    if mock_db_connections > 0:\n        print(\"Teardown Chain Broken\")\n    else:\n        print(\"Failed to reproduce\")\n\nserver_thread = threading.Thread(target=run_server, daemon=True)\nserver_thread.start()\nverify_bug()\n```",
        "user": "0x-Apollyon",
        "start_time": "2025-12-24T15:27:55Z",
        "end_time": "2025-12-24T16:01:34Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5870.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5863,
        "title": "Modern CSRF Protection Using `Sec-Fetch-Site` Header",
        "body": "Flask's documentation states that CSRF protection requires a form validation framework (which Flask doesn't provide), necessitating one-time tokens stored in cookies and transmitted with form data. However, modern browsers now support `Sec-Fetch-Site` headers, making token-based CSRF protection unnecessary. Rails just merged this approach in [rails/rails#56350](https://github.com/rails/rails/pull/56350). Flask should offer a similar modern solution—but in a more Flask-like way: as a simple argument to `@app.route()`.\n\n## Current State\n\nFrom Flask's security documentation:\n\n> \"Why does Flask not do that for you? The ideal place for this to happen is the form validation framework, which does not exist in Flask.\"\n\nThis was written when CSRF tokens were the only viable protection mechanism. That's no longer true. And with header-based protection, no form validation framework is needed—just a simple check before dispatching to the view.\n\n## The Modern Approach\n\nThe `Sec-Fetch-Site` header is a [Fetch Metadata Request Header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Site) that modern browsers send automatically. It indicates the relationship between the request origin and the target origin:\n\n- `same-origin`: Request from the same origin (same scheme, host, and port)\n- `same-site`: Request from the same site but different origin\n- `cross-site`: Request from a completely different site\n- `none`: User-initiated navigation (typing URL, bookmark, etc.)\n\nFor state-changing requests (POST, PUT, DELETE, PATCH), we can simply reject requests where `Sec-Fetch-Site` is `cross-site`. No tokens needed.\n\n**Browser Support:** All modern browsers (Chrome 76+, Firefox 90+, Safari 16.4+, Edge 79+) - [caniuse.com/mdn-http_headers_sec-fetch-site](https://caniuse.com/mdn-http_headers_sec-fetch-site)\n\n## Why This Matters\n\nToken-based CSRF has significant operational pain:\n\n1. **Caching conflicts**: Cached pages contain stale tokens → false positives\n2. **Session expiry edge cases**: Token/session mismatch after timeout\n3. **SPA complexity**: Managing token refresh in JavaScript applications\n4. **Multi-tab issues**: Tokens invalidated when user opens multiple tabs\n\nHeader-based protection eliminates all of these.\n\n## Proposed Flask Implementation\n\nRather than adding another extension, this should be a first-class citizen in Flask's routing. The implementation is simple enough that it belongs in core—just an argument to `@app.route()`:\n\n```python\nfrom flask import Flask\n\napp = Flask(__name__)\napp.config['CSRF_TRUSTED_ORIGINS'] = ['https://accounts.google.com']\n\n# Protected by default for state-changing methods\n@app.route('/api/data', methods=['POST'])\ndef create_data():\n    return {'status': 'ok'}\n\n# Explicitly disable for webhooks that use signature verification\n@app.route('/webhooks/stripe', methods=['POST'], csrf=False)\ndef stripe_webhook():\n    return {'received': True}\n\n# GET requests are never protected (no state change)\n@app.route('/api/data', methods=['GET'])\ndef get_data():\n    return {'data': []}\n```\n\n## Configuration\n\n```python\n# Default configuration in Flask\nCSRF_ENABLED = True                    # Global kill switch\nCSRF_TRUSTED_ORIGINS = []              # Allow cross-origin from these origins\nCSRF_PROTECTED_METHODS = {'POST', 'PUT', 'PATCH', 'DELETE'}\n```\n\nNote: Unlike my earlier draft, `same-site` requests are **rejected by default**. This is intentional—different subdomains often have different trust levels (e.g., `marketing.example.com` vs `admin.example.com`). If you need same-site requests, add the specific origin to `CSRF_TRUSTED_ORIGINS`.\n\n\n## Questions for Maintainers\n\n1. **Default On vs Off**: Should CSRF protection be on by default for state-changing methods (proposed), or require explicit `csrf=True`?\n\n2. **Same-site Policy**: The algorithm rejects `same-site` requests by default (per Filippo Valsorda's guidance). Should there be a config option to relax this, or is explicit `CSRF_TRUSTED_ORIGINS` sufficient?\n\n3. **Werkzeug Level**: Should the core check logic live in Werkzeug so other frameworks (Bottle, etc.) can use it?\n\n## References\n\n- [MDN: Sec-Fetch-Site](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Site)\n- [web.dev: Fetch Metadata](https://web.dev/articles/fetch-metadata)\n- [Rails PR #56350](https://github.com/rails/rails/pull/56350) - Rails implementation (merged Dec 2025)\n- [Rack Issue #2367](https://github.com/rack/rack/issues/2367) - Rack-level discussion\n- [Go proposal: CrossOriginForgeryHandler](https://github.com/golang/go/issues/73626)\n- [Blog from go author](https://words.filippo.io/csrf/)\n- [OWASP Fetch Metadata positioning](https://github.com/OWASP/CheatSheetSeries/pull/1875)\n\n## Willingness to Implement\n\nI'm prepared to submit a PR implementing this. The change is small and self-contained.\n",
        "user": "sharoonthomas",
        "start_time": "2025-12-15T16:29:24Z",
        "end_time": "2025-12-17T15:35:42Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5864,
                "title": "Add built-in CSRF protection using Sec-Fetch-Site header",
                "url": "https://github.com/pallets/flask/pull/5864",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "54aaa01eb5c87d970145e138de1abeb40136f3b1",
                "message": "Add built-in CSRF protection using Sec-Fetch-Site header",
                "author": "Sharoon Thomas",
                "date": "2025-12-17T02:44:19Z"
            }
        ],
        "affected_files": [
            "tests/test_csrf.py",
            "CHANGES.rst",
            "docs/web-security.rst",
            "src/flask/app.py",
            "src/flask/views.py",
            "docs/config.rst",
            "src/flask/sansio/app.py"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 7,
            "total_prs": 1
        }
    },
    {
        "id": 5861,
        "title": "Proposal: CLI command to validate API endpoints by making test requests",
        "body": "### Motivation\n\nWhen working on Flask applications with many API endpoints, it is sometimes\nuseful to quickly check whether all registered routes can be accessed without\nraising unexpected errors (e.g. unhandled exceptions, 500 errors).\n\nAt the moment, developers typically need to write custom scripts or tests to\nperform this kind of basic validation. Providing an opt-in CLI command could\nhelp improve developer experience, especially during local development.\n\n### Proposal\n\nIntroduce an optional Flask CLI command (for example, `flask check-endpoints`)\nthat iterates over registered routes and makes test requests using Flask’s\ntest client.\n\nThe goal would not be full correctness testing, but a lightweight sanity check\nto detect obvious runtime errors.\n\nPossible initial scope:\n- Only routes with simple methods (e.g. GET by default)\n- Skip routes with required path parameters\n- Report endpoints that raise exceptions or return 5xx responses\n- Development-only usage\n\n### Design considerations\n\n- The command should be fully opt-in and not affect existing behavior.\n- No network requests; use Flask’s built-in test client.\n- Keep output simple and readable (similar to `flask routes`).\n- Advanced features (custom payloads, auth, etc.) could be out of scope initially.\n\n### Open questions\n\n- Should this live as a core CLI command or as an optional extension?\n- How should endpoints with required parameters or authentication be handled?\n- Should the command fail on the first error or report all failures?\n\nFeedback on the general direction and scope would be appreciated before\nstarting an implementation.\n",
        "user": "jyup-escape",
        "start_time": "2025-12-13T10:43:23Z",
        "end_time": "2025-12-13T11:09:29Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5861.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5851,
        "title": "Add Copy-to-Clipboard button for code examples in documentation",
        "body": "### Feature Request: Add copy button to code blocks in documentation\n\n#### Problem\n\nMany pages in the Flask documentation contain multi-line code snippets, but there is no built-in way to copy the entire block with one click. Users currently need to manually select text, which is slower and error-prone.\n\n#### Proposed Solution\n\nAdd a small \"Copy\" button to each `div.highlight` element using a small JavaScript file included via Sphinx.\n\n- Implemented using the native Clipboard API (no external library)\n- Minimal UI impact\n- Applied only to docs frontend, not core package\n\n#### Motivation & Benefits\n\n- Easier copy-paste for beginners following tutorials\n- Consistent with other frameworks (FastAPI, Django, Click docs, etc.)\n- Improves developer experience without affecting core Flask code\n\n#### Status\n\nI have already implemented a working version locally and can submit a PR once approved.\n\nLet me know if this is useful and if I should proceed with a pull request.\n",
        "user": "Anirudh-020505",
        "start_time": "2025-11-21T08:56:06Z",
        "end_time": "2025-11-21T15:59:10Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5851.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5848,
        "title": "Add copy-to-clipboard button for code blocks in Flask documentation.",
        "body": "### Description\n\nI propose to add a \"copy to clipboard\" button next to all code blocks in the Flask documentation. This will allow users to easily copy example code or command-line snippets with a single click instead of manually selecting the text. This feature greatly improves usability and convenience, especially on mobile devices.\n\nFlask documentation uses Sphinx for static site generation, and there is an existing Sphinx extension called [sphinx-copybutton](https://sphinx-copybutton.readthedocs.io/en/latest/) that provides this functionality out of the box. It can be enabled by simply adding it to the `extensions` list in the Sphinx `conf.py` file.\n\n\nThis extension also supports stripping common prompts (like `>>>`, `$`) from copied content, making the copied snippets cleaner.\n\n### Problem this resolves\n\nCurrently, users have to manually select and copy code blocks, which can be error-prone and inconvenient. Adding a copy button makes the process faster and less error-prone.\n\n### Additional notes\n\n- The change is additive and does not affect existing documentation content or structure.\n- This enhancement aligns Flask docs with modern documentation practices seen in many popular projects.\n\nI am happy to implement this feature and create a pull request once the issue is approved.\n\n",
        "user": "MOHITKOURAV01",
        "start_time": "2025-11-19T07:09:10Z",
        "end_time": "2025-11-19T14:30:56Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5849,
                "title": "Add copy-to-clipboard button for code blocks in Flask documentation.",
                "url": "https://github.com/pallets/flask/pull/5849",
                "state": "closed"
            },
            {
                "number": 5850,
                "title": "Add copy-to-clipboard button for code blocks in Flask documentation.",
                "url": "https://github.com/pallets/flask/pull/5850",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "bc616d6537af5484e45f49c30fb7a6fe461598fe",
                "message": "Add copy-to-clipboard support to docs",
                "author": "MOHITKOURAV01",
                "date": "2025-11-19T07:27:47Z"
            },
            {
                "sha": "4014ff1b875aba9fa5ea6e119ff657a463ab9fce",
                "message": "Document copy button setup and add tests",
                "author": "MOHITKOURAV01",
                "date": "2025-11-19T07:48:11Z"
            },
            {
                "sha": "963feeb85e66dcb16ba99b25abaaed5c7825a1b1",
                "message": "Reference issue 5848 for copy button docs entry",
                "author": "MOHITKOURAV01",
                "date": "2025-11-19T09:34:03Z"
            }
        ],
        "affected_files": [
            "docs/contributing.rst",
            "CHANGES.rst",
            "docs/conf.py",
            "tests/test_docs_copybutton.py",
            "pyproject.toml"
        ],
        "stats": {
            "total_commits": 3,
            "total_files": 5,
            "total_prs": 2
        }
    },
    {
        "id": 5839,
        "title": "Really, I can't close connection???",
        "body": "Jesus Christ, what kind of library doesn’t allow forcefully closing a connection? Even after returning or using abort, it still continues to process data in the background. This is disappointing, there’s no way, for example, to forcefully stop a file upload after checking its header. It will still continue to process the remaining 100 GB of the file.\n\n```\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    print(1)\n    return \"wtf\", 400 # still continues to process data\n```",
        "user": "serbinskis",
        "start_time": "2025-10-30T21:35:46Z",
        "end_time": "2025-10-30T22:31:35Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5839.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5836,
        "title": "Test failures with click 8.3.1",
        "body": "Click 8.3.1 was [tagged](https://github.com/pallets/click/releases/tag/8.3.1) but not released on PyPI. Running flask's test suite with that version results in\n```\n============================= test session starts ==============================\nplatform linux -- Python 3.13.8, pytest-8.4.2, pluggy-1.6.0\nrootdir: /build/flask-3.1.2\nconfigfile: pyproject.toml\ntestpaths: tests\ncollected 490 items                                                            \n\ntests/test_appctx.py ..............                                      [  2%]\ntests/test_async.py ........                                             [  4%]\ntests/test_basic.py .................................................... [ 15%]\n........................................................................ [ 29%]\n......                                                                   [ 31%]\ntests/test_blueprints.py ............................................... [ 40%]\n.............                                                            [ 43%]\ntests/test_cli.py ...................................................F.. [ 54%]\n...F                                                                     [ 55%]\ntests/test_config.py ...................                                 [ 58%]\ntests/test_converters.py ..                                              [ 59%]\ntests/test_helpers.py ...................................                [ 66%]\ntests/test_instance_config.py .......                                    [ 67%]\ntests/test_json.py ...............................                       [ 74%]\ntests/test_json_tag.py ..............                                    [ 77%]\ntests/test_logging.py ......                                             [ 78%]\ntests/test_regression.py .                                               [ 78%]\ntests/test_reqctx.py .......ss.....                                      [ 81%]\ntests/test_request.py ...                                                [ 82%]\ntests/test_session_interface.py .                                        [ 82%]\ntests/test_signals.py .......                                            [ 83%]\ntests/test_subclassing.py .                                              [ 83%]\ntests/test_templating.py ................................                [ 90%]\ntests/test_testing.py .........................                          [ 95%]\ntests/test_user_error_handler.py .........                               [ 97%]\ntests/test_views.py .............                                        [100%]\n\n=================================== FAILURES ===================================\n______________________________ test_run_cert_path ______________________________\n\n    def test_run_cert_path():\n        # no key\n        with pytest.raises(click.BadParameter):\n            run_command.make_context(\"run\", [\"--cert\", __file__])\n    \n        # no cert\n>       with pytest.raises(click.BadParameter):\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE       Failed: DID NOT RAISE <class 'click.exceptions.BadParameter'>\n\n\ntests/test_cli.py:590: Failed\n__________________________ test_run_exclude_patterns ___________________________\n\n    def test_run_exclude_patterns():\n>       ctx = run_command.make_context(\"run\", [\"--exclude-patterns\", __file__])\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n\ntests/test_cli.py:701: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/nix/store/53y968aagcaaq46hq3rg2a3mmxwmzvm1-python3.13-click-8.3.1/lib/python3.13/site-packages/click/core.py:1216: in make_context\n    self.parse_args(ctx, args)\n        args       = []\n        ctx        = <click.core.Context object at 0x7ffff4c02b10>\n        extra      = {}\n        info_name  = 'run'\n        parent     = None\n        self       = <Command run>\n/nix/store/53y968aagcaaq46hq3rg2a3mmxwmzvm1-python3.13-click-8.3.1/lib/python3.13/site-packages/click/core.py:1227: in parse_args\n    _, args = param.handle_parse_result(ctx, opts, args)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        _          = 5000\n        args       = []\n        ctx        = <click.core.Context object at 0x7ffff4c02b10>\n        opts       = {'exclude_patterns': '/build/flask-3.1.2/tests/test_cli.py'}\n        param      = <Option key>\n        param_order = [<Option exclude_patterns>]\n        parser     = <click.parser._OptionParser object at 0x7ffff4b08bd0>\n        self       = <Command run>\n/nix/store/53y968aagcaaq46hq3rg2a3mmxwmzvm1-python3.13-click-8.3.1/lib/python3.13/site-packages/click/core.py:2548: in handle_parse_result\n    value = self.process_value(ctx, value)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        args       = []\n        ctx        = <click.core.Context object at 0x7ffff4c02b10>\n        opts       = {'exclude_patterns': '/build/flask-3.1.2/tests/test_cli.py'}\n        self       = <Option key>\n        source     = <ParameterSource.DEFAULT: 3>\n        value      = Sentinel.UNSET\n/nix/store/53y968aagcaaq46hq3rg2a3mmxwmzvm1-python3.13-click-8.3.1/lib/python3.13/site-packages/click/core.py:3283: in process_value\n    return super().process_value(ctx, value)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        __class__  = <class 'click.core.Option'>\n        ctx        = <click.core.Context object at 0x7ffff4c02b10>\n        self       = <Option key>\n        value      = Sentinel.UNSET\n/nix/store/53y968aagcaaq46hq3rg2a3mmxwmzvm1-python3.13-click-8.3.1/lib/python3.13/site-packages/click/core.py:2443: in process_value\n    value = self.callback(ctx, self, value)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        ctx        = <click.core.Context object at 0x7ffff4c02b10>\n        self       = <Option key>\n        value      = None\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nctx = <click.core.Context object at 0x7ffff4c02b10>, param = <Option key>\nvalue = None\n\n    def _validate_key(ctx: click.Context, param: click.Parameter, value: t.Any) -> t.Any:\n        \"\"\"The ``--key`` option must be specified when ``--cert`` is a file.\n        Modifies the ``cert`` param to be a ``(cert, key)`` pair if needed.\n        \"\"\"\n        cert = ctx.params.get(\"cert\")\n        is_adhoc = cert == \"adhoc\"\n    \n        try:\n            import ssl\n        except ImportError:\n            is_context = False\n        else:\n            is_context = isinstance(cert, ssl.SSLContext)\n    \n        if value is not None:\n            if is_adhoc:\n                raise click.BadParameter(\n                    'When \"--cert\" is \"adhoc\", \"--key\" is not used.', ctx, param\n                )\n    \n            if is_context:\n                raise click.BadParameter(\n                    'When \"--cert\" is an SSLContext object, \"--key\" is not used.',\n                    ctx,\n                    param,\n                )\n    \n            if not cert:\n                raise click.BadParameter('\"--cert\" must also be specified.', ctx, param)\n    \n            ctx.params[\"cert\"] = cert, value\n    \n        else:\n            if cert and not (is_adhoc or is_context):\n>               raise click.BadParameter('Required when using \"--cert\".', ctx, param)\nE               click.exceptions.BadParameter: Required when using \"--cert\".\n\ncert       = Sentinel.UNSET\nctx        = <click.core.Context object at 0x7ffff4c02b10>\nis_adhoc   = False\nis_context = False\nparam      = <Option key>\nssl        = <module 'ssl' from '/nix/store/cfapjd2rvqrpry4grb0kljnp8bvnvfxz-python3-3.13.8/lib/python3.13/ssl.py'>\nvalue      = None\n\n/nix/store/12gfdjrf93rixvjrkj9pbfy5349q3j4m-python3.13-flask-3.1.2/lib/python3.13/site-packages/flask/cli.py:870: BadParameter\n=========================== short test summary info ============================\nFAILED tests/test_cli.py::test_run_cert_path - Failed: DID NOT RAISE <class 'click.exceptions.BadParameter'>\nFAILED tests/test_cli.py::test_run_exclude_patterns - click.exceptions.BadParameter: Required when using \"--cert\".\n================== 2 failed, 486 passed, 2 skipped in 13.73s ===================\n```",
        "user": "dotlambda",
        "start_time": "2025-10-25T20:08:38Z",
        "end_time": "2025-11-10T19:18:28Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 454434,
                "title": "python3Packages.click: 8.2.1 -> 8.3.1",
                "url": "https://github.com/NixOS/nixpkgs/pull/454434",
                "state": "closed"
            },
            {
                "number": 3109,
                "title": "Release version 8.3.1",
                "url": "https://github.com/pallets/click/pull/3109",
                "state": "closed"
            },
            {
                "number": 5846,
                "title": "Fix _validate_key to handle click 8.3.1 Sentinel values",
                "url": "https://github.com/pallets/flask/pull/5846",
                "state": "closed"
            },
            {
                "number": 3137,
                "title": "Provide altered context to callbacks to hide `UNSET` values as `None`",
                "url": "https://github.com/pallets/click/pull/3137",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "3cf58860fd67036a4692214e3ba78d61f1a2d33d",
                "message": "python3Packages.click: 8.2.1 -> 8.3.1\n\nDiff: https://github.com/pallets/click/compare/8.2.1...8.3.1\n\nChangelog: https://github.com/pallets/click/blob/8.3.1/CHANGES.rst",
                "author": "Robert Schütz",
                "date": "2025-11-15T20:54:53Z"
            },
            {
                "sha": "1d038f270701498433cb432f54db89f95f07a845",
                "message": "release version 8.3.1",
                "author": "Edward G",
                "date": "2025-10-15T04:27:34Z"
            },
            {
                "sha": "ec942ef2f38c5821c3e66c5662dfcb5461238a47",
                "message": "Fix _validate_key to handle click 8.3.1 Sentinel values\n\nFixes #5836\r\n\r\nUpdates the condition in _validate_key to properly check for click._utils.UNSET sentinel value, which is now present in ctx.params during callbacks in click 8.3.1.",
                "author": "pramod5403",
                "date": "2025-11-10T16:16:07Z",
                "files": [
                    "src/flask/cli.py"
                ]
            },
            {
                "sha": "a6ca4d23bc934d2ae6d47128634551a73e9249ca",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-11-10T16:18:38Z"
            },
            {
                "sha": "f062b89072cefb70fa7e40d7f31aa5f280b20bc4",
                "message": "Fix click module path: use click.utils.UNSET instead of click._utils.UNSET\n\nThe correct path is click.utils.UNSET, not click._utils.UNSET. This fixes the AttributeError that was causing all tests to fail.",
                "author": "pramod5403",
                "date": "2025-11-10T16:27:32Z"
            },
            {
                "sha": "437e1e3295c7ec979fc1bf285bb402ca20d847e7",
                "message": "Temporarily provide a fake context to the callback to hide `UNSET` values as `None`\n\nFix: https://github.com/pallets/click/issues/3136",
                "author": "Kevin Deldycke",
                "date": "2025-11-11T07:58:09Z"
            }
        ],
        "affected_files": [
            "CHANGES.rst",
            "pkgs/development/python-modules/click/default.nix",
            "src/click/core.py",
            "tests/test_context.py",
            "uv.lock",
            "src/flask/cli.py",
            "pyproject.toml"
        ],
        "stats": {
            "total_commits": 6,
            "total_files": 7,
            "total_prs": 4
        }
    },
    {
        "id": 5825,
        "title": "Document 415 on the receiving json section",
        "body": "Documentation on \"json\" request throwing a 415 as well as 400.  \n\nThe problem text is on https://flask.palletsprojects.com/en/stable/patterns/javascript/#receiving-json-in-views\n\n```\nReceiving JSON in Views\n\nUse the [json](https://flask.palletsprojects.com/en/stable/api/#flask.Request.json) property of the [request](https://flask.palletsprojects.com/en/stable/api/#flask.request) object to decode the request’s body as JSON. If the body is not valid JSON, or the Content-Type header is not set to application/json, a 400 Bad Request error will be raised\n```\nI believe you want to indicate that it's a 415 instead of 400 when the Content-Type header doesn't match as it's done on https://flask.palletsprojects.com/en/stable/api/#flask.Request.json\n\n400 is still valid for when the body isn't json (even though the content-type is json).\n\nSo maybe something like this ? \n```\nReceiving JSON in Views\n\nUse the [json](https://flask.palletsprojects.com/en/stable/api/#flask.Request.json) property of the [request](https://flask.palletsprojects.com/en/stable/api/#flask.request) object to decode the request’s body as JSON. If the body is not valid JSON, a 400 Bad Request error will be raised.  If the Content-Type header is not set to application/json, a 415 Unsupported Media Type error will be raised\n```\n\nEnvironment:\n\n- Python version: N/A\n- Flask version: latest doc\n\n\n\nThis is in no way a bug, but it's for being aligned everywhere in your doc :).  I'm just trying to make things better, I love the product ! thanks for the great work you've done ! ",
        "user": "elafonta",
        "start_time": "2025-10-07T15:41:58Z",
        "end_time": null,
        "state": "open",
        "labels": [
            "docs"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5826,
                "title": "docs: clarify JSON parsing error conditions in Flask views",
                "url": "https://github.com/pallets/flask/pull/5826",
                "state": "closed"
            },
            {
                "number": 5827,
                "title": "docs: clarify 415 vs 400 errors for request.json",
                "url": "https://github.com/pallets/flask/pull/5827",
                "state": "open"
            },
            {
                "number": 5860,
                "title": "Fix documentation for JSON error codes",
                "url": "https://github.com/pallets/flask/pull/5860",
                "state": "closed"
            },
            {
                "number": 5872,
                "title": "Fixed error code documentation for request.json",
                "url": "https://github.com/pallets/flask/pull/5872",
                "state": "closed"
            },
            {
                "number": 5874,
                "title": "Clarify 415 Unsupported Media in JSON docs",
                "url": "https://github.com/pallets/flask/pull/5874",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "872f1ba54e88adfdfc570f768b3d0485326822e0",
                "message": "docs: clarify JSON parsing error conditions in Flask views",
                "author": "Samarth",
                "date": "2025-10-08T13:12:48Z"
            },
            {
                "sha": "1c956cd397f1c0f3ba980a9793f715e45f619a1c",
                "message": "docs: clarify 415 vs 400 errors for request.json",
                "author": "Aditya",
                "date": "2025-10-09T07:01:01Z"
            },
            {
                "sha": "28f4f2cfea068fbd0727aab5c49029476d408b1c",
                "message": "docs: clarify 415 vs 400 errors for request.json\n\nDistinguish between 415 Unsupported Media Type (wrong Content-Type)\nand 400 Bad Request (invalid JSON body) to align with API documentation.\n\nFixes #58254",
                "author": "Aditya",
                "date": "2025-10-09T07:03:43Z"
            },
            {
                "sha": "973ac594899ddb211ec808aed18457355cc68289",
                "message": "Merge branch 'main' into docs-clarify-json-415-error",
                "author": "ADITYA SAH",
                "date": "2025-12-02T15:17:37Z"
            },
            {
                "sha": "30cfe7579253d805c48971aeb9b6b474774d399e",
                "message": "Fix documentation for JSON error codes\n\nClarify that request.json raises:\n- 400 Bad Request for invalid JSON content\n- 415 Unsupported Media Type for wrong Content-Type header\n\nFixes #5825",
                "author": "Tsotne Okrostsvaridze",
                "date": "2025-12-10T22:10:07Z",
                "files": [
                    "docs/patterns/javascript.rst"
                ]
            },
            {
                "sha": "9ebdd5c54342583b705f5ec86b84f54b4f3dc43f",
                "message": "Fixed error code documentation for request.json\n\nClarify that a 415 error is raised when Content-Type is incorrect, while a 400 error is raised when the body is not valid JSON.\n\nThis aligns the patterns documentation with the API reference.",
                "author": "Jason",
                "date": "2025-12-27T17:10:03Z"
            },
            {
                "sha": "7185b6086de0a316e35ae2014c1b72b36e08f883",
                "message": "Clarify 415 Unsupported Media Type for invalid JSON Content-Type",
                "author": "Soham-1616",
                "date": "2025-12-29T04:55:28Z"
            }
        ],
        "affected_files": [
            "docs/patterns/javascript.rst"
        ],
        "stats": {
            "total_commits": 7,
            "total_files": 1,
            "total_prs": 5
        }
    },
    {
        "id": 5820,
        "title": "prosper_web.py",
        "body": "<!--\nThis issue tracker is a tool to address bugs in Flask itself. Please use\nGitHub Discussions or the Pallets Discord for questions about your own code.\n\nReplace this comment with a clear outline of what the bug is.\n-->\n\n<!--\nDescribe how to replicate the bug.\n\nInclude a minimal reproducible example that demonstrates the bug.\nInclude the full traceback if there was an exception.\n-->\n\n<!--\nDescribe the expected behavior that should have happened but didn't.\n-->\n\nEnvironment:\n\n- Python version:\n- Flask version:\n",
        "user": "egbaprosper3-del",
        "start_time": "2025-09-24T18:26:43Z",
        "end_time": "2025-09-24T18:28:01Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5820.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5819,
        "title": "Enrich Flask’s public API type hints using typing.Annotated with Doc metadata",
        "body": "## Feature Request\n\n### Summary\n\nEnhance selected public Flask APIs (for example `add_url_rule` and `route`) by adding\n`typing.Annotated` with `Doc` metadata **and `Literal` types for HTTP methods** to provide\nricher IDE assistance and stronger static type checking.\n\n### Example\n\n```python\nfrom typing import Annotated, Literal\nfrom typing_extensions import Doc\n\n# Strict HTTP method type for auto-complete and validation\nMethod = Literal[\"GET\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\", \"OPTIONS\", \"HEAD\"]\n\ndef add_url_rule(\n    rule: Annotated[str, Doc(\"URL path such as '/home' or '/api/items/<int:id>'\")],\n    *,\n    methods: Annotated[list[Method], Doc(\"Allowed HTTP methods, e.g. ['GET', 'POST']\")],\n    ...\n) -> None:\n    ...\n```\n\n### Benefits\n\n* **Better editor/IDE hints and documentation** for route paths and HTTP methods.\n* **Static validation of HTTP verbs** so type checkers catch typos like `\"GEET\"`.\n* **Backward compatible** with existing type checkers and runtime behavior (`typing_extensions.Annotated` and `Literal` are supported across Python versions Flask supports).\n\n### Questions for Maintainers\n\n* Would you accept `Annotated` + `Doc` and `Literal` types in public API signatures?\n* If yes, should I begin with a small pilot (e.g., only `add_url_rule`) before expanding to other decorators such as `route`?\n",
        "user": "manitreasure1",
        "start_time": "2025-09-21T05:31:27Z",
        "end_time": "2025-09-21T05:59:42Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5819.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5817,
        "title": "asyncio is not compatible with gevent",
        "body": "See #5256\n\nasync-await: <https://flask.palletsprojects.com/en/stable/async-await/>\n\n> Using async with greenlet\n> When using gevent or eventlet to serve an application or patch the runtime, greenlet>=1.0 is required. When using PyPy, PyPy>=7.3.7 is required.\n\nFlask uses asgiref, which is not compatible with gevent: <https://github.com/django/asgiref/issues/443>\n\n\nBTW:\nASGI: <https://flask.palletsprojects.com/en/stable/deploying/asgi/>\n\n> The asgiref [WsgiToAsgi](https://github.com/django/asgiref#wsgi-to-asgi-adapter) adapter is recommended as it integrates with the event loop used for Flask’s [Using async and await](https://flask.palletsprojects.com/en/stable/async-await/#async-await) support.\n\nThis makes it seem like the event loop integration means a single worker could process multiple requests concurently, which it can't, the worker will block on `await`.\n\n---\n\nI'm not the only one that found this the hard way: [Flask, Gunicorn, Gevent and Asyncio Don't Mix](https://github.com/moogah/flask-gunicorn-gevent-asyncio/blob/29be08051cd663fa68d982f27232d2a5215a399c/README.md)\n",
        "user": "awoimbee",
        "start_time": "2025-09-16T12:28:32Z",
        "end_time": "2026-01-05T18:57:14Z",
        "state": "closed",
        "labels": [
            "docs"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5824,
                "title": "Clarify asyncio and gevent incompatibility in docs (#5817)",
                "url": "https://github.com/pallets/flask/pull/5824",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "c357bdd7cf2778a3112a974f1f3ab09085312b92",
                "message": "Clarify asyncio and gevent incompatibility in docs (#5817)",
                "author": "anand",
                "date": "2025-09-29T17:05:17Z",
                "files": [
                    "docs/async-await.rst"
                ]
            }
        ],
        "affected_files": [
            "docs/async-await.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 1,
            "total_prs": 1
        }
    },
    {
        "id": 5816,
        "title": "deprecate `should_ignore_error`",
        "body": "This was added in f1918093ac70d589a4d67af0d77140734c06c13d as part of the original code to keep the context around for use in the debugger, tests, etc. It was not part of a PR, and there's no linked issue or explanation on why it was added.\n\nThe intention seems to be to allow ignoring certain errors during debugging, so that cleanup is still run immediately. That's not how context preservation works anymore.  It also causes the exception to not be passed to teardown handlers, but there doesn't seem to be any reason to hide that, and handlers can already choose what to do if they're passed an error.\n\nThe method is only documented in the API, not in any other pages. There's no test for it. I have a feeling this isn't used. It results in an extra function call every single request, only to always return false. This can be deprecated then removed.",
        "user": "davidism",
        "start_time": "2025-09-14T16:38:15Z",
        "end_time": null,
        "state": "open",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5867,
                "title": "Deprecate should_ignore_error method",
                "url": "https://github.com/pallets/flask/pull/5867",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "04a5a0414079b358d17397ae086f85a4ed3c7241",
                "message": "Deprecate should_ignore_error method\n\nThe `should_ignore_error()` method was added in f191809 to support\ncontext preservation for debugging, but it no longer serves its\noriginal purpose and adds unnecessary overhead.\n\nIssues with the current implementation:\n- Always returns False by default\n- Called on every single request with no benefit\n- The original intention for error ignoring during debugging is not\n  how context preservation works anymore\n- No documentation beyond API reference\n- No tests for the functionality\n- No evidence of real-world usage\n\nChanges:\n- Add deprecation warning to App.should_ignore_error() that will be\n  removed in Flask 4.0\n- Optimize call site to only invoke the method if it's been overridden\n  by a subclass, eliminating the function call overhead for 99.9% of\n  requests\n- Add comprehensive tests for the deprecation behavior\n- Update CHANGES.rst with deprecation notice\n\nTeardown handlers should manage their own error handling instead of\nrelying on this method.\n\nFixes #5816",
                "author": "Ayush Patil",
                "date": "2025-12-18T12:17:38Z"
            },
            {
                "sha": "bfb95365f86831d1ceeccea530af8915dc4ce954",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-12-18T12:20:24Z"
            }
        ],
        "affected_files": [
            "src/flask/app.py",
            "src/flask/sansio/app.py",
            "CHANGES.rst",
            "tests/test_deprecations.py"
        ],
        "stats": {
            "total_commits": 2,
            "total_files": 4,
            "total_prs": 1
        }
    },
    {
        "id": 5815,
        "title": "pass context internally instead of using contextvars",
        "body": "Currently, there are a bunch of different methods on the `Flask` class that run to dispatch each request. Many of these access `request` and other context proxies. We should update them to pass the `AppContext` everywhere instead. This is more convenient after #5812 with only one context object instead of two. As @pgjones pointed out in #5229, not having to access the contextvar is a significant speedup to ASGI Quart, although it doesn't appear to affect WSGI Flask as much. Perhaps if we were serving with greenlets and so contexts were switching more, it would be more noticeable in Flask too.\n\nThe obvious problem is that it is a breaking change to the signatures of all these methods. I'm unsure how many methods are affected, but I'm also unsure how many projects are even subclassing `Flask` to override any of the methods. The fact that the methods are public seems unintentional, compared to the much more common ways of configuring and customizing an app.\n\nWe could continue to support both signatures, showing a deprecation warning for the old one, by adding some detection to `Flask.__init__`. This would add some amount of time during app setup, but wouldn't affect runtime performance of the app.\n\n---\n\nAnother idea I had for the future was to have `@route` and other decorators inspect the signature of the decorated function, to allow injecting `request`, `app`, etc. if users would rather use that pattern than import the proxies. Having the request object directly available in all the dispatch methods would make this more straightforward. User code would be able to choose what pattern they want, the current proxy pattern would never be deprecated for user code.\n",
        "user": "davidism",
        "start_time": "2025-09-13T18:19:56Z",
        "end_time": "2025-11-17T16:49:54Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5818,
                "title": "pass context through dispatch methods",
                "url": "https://github.com/pallets/flask/pull/5818",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "6a64969009bf1898bd302e6a9633f71942523f7f",
                "message": "pass context through dispatch methods",
                "author": "David Lord",
                "date": "2025-09-19T23:58:48Z"
            }
        ],
        "affected_files": [
            "tests/test_subclassing.py",
            "CHANGES.rst",
            "src/flask/templating.py",
            "src/flask/app.py",
            "tests/test_reqctx.py",
            "src/flask/ctx.py"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 6,
            "total_prs": 1
        }
    },
    {
        "id": 5804,
        "title": "3.1.2 regression: `stream_with_context` triggers `teardown_request()` calls before response generation",
        "body": "<!--\nThis issue tracker is a tool to address bugs in Flask itself. Please use\nGitHub Discussions or the Pallets Discord for questions about your own code.\n\nReplace this comment with a clear outline of what the bug is.\n-->\n\n<!--\nDescribe how to replicate the bug.\n\nInclude a minimal reproducible example that demonstrates the bug.\nInclude the full traceback if there was an exception.\n-->\n\n<!--\nDescribe the expected behavior that should have happened but didn't.\n-->\nHello,\n\nI believe the changes to `stream_with_context()` in https://github.com/pallets/flask/pull/5799/commits/9822a0351574790cb66c652fcc396ad7aa2b09d8 introduced a bug where the `teardown_request()` callables are invoked too early in the request/response lifecycle (and actually invoked twice, before generating the response and a second time after the end of the request). Take the following example:\n\n```python\n# flask_teardown_stream_with_context.py\nfrom flask import Flask, g, stream_with_context\n\n\ndef _teardown_request(_):\n    print(\"do_teardown_request() called\")\n    g.pop(\"hello\")\n\n\napp = Flask(__name__)\n\napp.teardown_request(_teardown_request)\n\n\n@app.get(\"/stream\")\ndef streamed_response():\n    g.hello = \"world\"\n\n    def generate():\n        print(\"Starting to generate response\")\n        yield f\"<p>Hello {g.hello} !</p>\"\n\n    return stream_with_context(generate())\n\n\napp.run(debug=True)\n```\n\nIn 3.1.1:\n\n```\n% /tmp/venv/bin/flask --version           \nPython 3.13.7\nFlask 3.1.1\nWerkzeug 3.1.3\n% /tmp/venv/bin/python flask_teardown_stream_with_context.py \n[…]\nStarting to generate response\n127.0.0.1 - - [01/Sep/2025 16:07:05] \"GET /stream HTTP/1.1\" 200 -\ndo_teardown_request() called\n```\n\nIn 3.1.2:\n\n```\n% /tmp/venv/bin/flask --version                             \nPython 3.13.7\nFlask 3.1.2\nWerkzeug 3.1.3\n% /tmp/venv/bin/python flask_teardown_stream_with_context.py\ndo_teardown_request() called\nStarting to generate response\ndo_teardown_request() called\nDebugging middleware caught exception in streamed response at a point where response headers were already sent.\nTraceback (most recent call last):\n  File \"/tmp/venv/lib/python3.13/site-packages/flask/helpers.py\", line 132, in generator\n    yield from gen\n  File \"/tmp/flask_teardown_stream_with_context.py\", line 21, in generate\n    yield f\"<p>Hello {g.hello} !</p>\"\n                      ^^^^^^^\n  File \"/tmp/venv/lib/python3.13/site-packages/flask/ctx.py\", line 56, in __getattr__\n    raise AttributeError(name) from None\nAttributeError: hello\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/tmp/venv/lib/python3.13/site-packages/werkzeug/wsgi.py\", line 256, in __next__\n    return self._next()\n           ~~~~~~~~~~^^\n  File \"/tmp/venv/lib/python3.13/site-packages/werkzeug/wrappers/response.py\", line 32, in _iter_encoded\n    for item in iterable:\n                ^^^^^^^^\n  File \"/tmp/venv/lib/python3.13/site-packages/flask/helpers.py\", line 130, in generator\n    with app_ctx, req_ctx:\n                  ^^^^^^^\n  File \"/tmp/venv/lib/python3.13/site-packages/flask/ctx.py\", line 443, in __exit__\n    self.pop(exc_value)\n    ~~~~~~~~^^^^^^^^^^^\n  File \"/tmp/venv/lib/python3.13/site-packages/flask/ctx.py\", line 410, in pop\n    self.app.do_teardown_request(exc)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/tmp/venv/lib/python3.13/site-packages/flask/app.py\", line 1356, in do_teardown_request\n    self.ensure_sync(func)(exc)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/tmp/flask_teardown_stream_with_context.py\", line 7, in _teardown_request\n    g.pop(\"hello\")\n    ~~~~~^^^^^^^^^\n  File \"/tmp/venv/lib/python3.13/site-packages/flask/ctx.py\", line 88, in pop\n    return self.__dict__.pop(name)\n           ~~~~~~~~~~~~~~~~~^^^^^^\nKeyError: 'hello'\n127.0.0.1 - - [01/Sep/2025 16:09:35] \"GET /stream HTTP/1.1\" 200 -\n```\n\nSpecifically,\n\n```\ndo_teardown_request() called\nStarting to generate response\ndo_teardown_request() called\n```\n\nSo `_teardown_request()` is called before flask start to iterate on the response generator.\n\nThis is a simplified version of our own code; I'm not sure we can actually expect `g` to still be available during response generators, but given it worked in 3.1.1 and the phrasing / intent of `teardown_request()`, I'd expect it not to be called before the response is actually generated. Note also that removing the code which causes the error, i.e. the `g` access, and keeping just the `print()` for debugging, will still show `_teardown_request()` being called twice.\n\nIt's not obvious to me where exactly the bug is triggered. Adding a `traceback.print_stack()` call to `_teardown_request()`:\n* in 3.1.1, the only call, once the request is done, is triggered by https://github.com/pallets/flask/blob/7fff56f5172c48b6f3aedf17ee14ef5c2533dfd1/src/flask/helpers.py#L115 ⇒ https://github.com/pallets/flask/blob/330123258e8c3dc391cbe55ab1ed94891ca83af3/src/flask/ctx.py#L443 \n* in 3.1.2, the (new) first call before entering the response generator is triggered by https://github.com/pallets/flask/blob/330123258e8c3dc391cbe55ab1ed94891ca83af3/src/flask/app.py#L1527 ; the second is similar to 3.1.1, i.e. https://github.com/pallets/flask/blob/330123258e8c3dc391cbe55ab1ed94891ca83af3/src/flask/helpers.py#L130 ⇒ https://github.com/pallets/flask/blob/330123258e8c3dc391cbe55ab1ed94891ca83af3/src/flask/ctx.py#L443\n\nEnvironment:\n\n- Python version: 3.13\n- Flask version: 3.1.2\n",
        "user": "noirbee",
        "start_time": "2025-09-01T14:24:02Z",
        "end_time": null,
        "state": "open",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5804.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5803,
        "title": "`flask.testing` misleadingly appears to import `TestResponse`",
        "body": "`testing.py` contains the following:\n```python\nif t.TYPE_CHECKING:  # pragma: no cover\n    from werkzeug.test import TestResponse\n```\nAs such, any IDE or static checker will consider this to be valid code:\n```python\nimport flask.testing as _flask_test\n\ndef my_test_helper(flask_test_client: _flask_test.FlaskClient) -> _flask_test.TestResponse:\n    ...\n```\n\nHowever, at runtime, this code will fail, because `TestResponse` is not actually imported into the `flask.testing` namespace.\n\nPossible solutions:\n- Move `from werkzeug.test import TestResponse` outside the `if t.TYPE_CHECKING` block; you're already importing `werkzeug.test` in that file anyway\n- Remove `from werkzeug.test import TestResponse` entirely and replace `TestResponse` with `werkzeug.test.TestResponse` in type-hints\n- Change `from werkzeug.test import TestResponse` to `from werkzeug.test import TestResponse as _TestResponse`; the leading underscore signals marks the import as private, at which point it doesn't matter if its really imported or not because nobody should be using it from outside the file\n",
        "user": "macdjord",
        "start_time": "2025-08-30T01:20:49Z",
        "end_time": "2025-08-30T02:04:17Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5803.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5792,
        "title": "Test",
        "body": "<!--\nThis issue tracker is a tool to address bugs in Flask itself. Please use\nGitHub Discussions or the Pallets Discord for questions about your own code.\n\nReplace this comment with a clear outline of what the bug is.\n-->\n\n<!--\nDescribe how to replicate the bug.\n\nInclude a minimal reproducible example that demonstrates the bug.\nInclude the full traceback if there was an exception.\n-->\n\n<!--\nDescribe the expected behavior that should have happened but didn't.\n-->\n\nEnvironment:\n\n- Python version:\n- Flask version:\n",
        "user": "VanyaKL1294",
        "start_time": "2025-08-03T03:15:59Z",
        "end_time": "2025-08-03T03:16:18Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5792.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5786,
        "title": "Session is not updated on redirect target endpoint in tests",
        "body": "Hello team.\nDuring writing tests, I noticed a strange session behavior.\n\nI want to verify that after a redirect, the target location sets valid session properties, and it seems like in tests, the session properties when following redirects are not saved/exposed to the test environment.\n\nHere's an example:\n```python\nimport pytest\nfrom flask import Flask, redirect, session\n\n@pytest.fixture\ndef app():\n    app = Flask(__name__)\n    app.debug = True\n    app.secret_key = 'test_secret'  # noqa: S105 – fake secret key for testing purposes\n\n    @app.get('/redirect')\n    def do_redirect():\n        print(\"Redirecting to target endpoint\", flush=True)\n        session[\"redirected\"] = \"true\"\n        return redirect('/target', 302)\n\n    @app.get('/target')\n    def target():\n        print(\"Target endpoint reached\", flush=True)\n        session['foo'] = 'bar'\n        return 'Target', 200\n\n    return app\n\n@pytest.fixture()\ndef client(app):\n    return app.test_client()\n\ndef test_session(client):\n    with client:\n        response = client.get(\"/redirect\", follow_redirects=True)\n\n        print(f\"Session after a redirect: {session.items()}\", flush=True)\n        assert response.status_code == 200\n        assert response.data == b\"Target\"\n\n        assert session.get(\"redirected\") == \"true\"\n        assert session.get('foo') == 'bar'\n\n        client.get(\"/target\", follow_redirects=True)\n        assert session.get('foo') == 'bar'\n        assert response.data == b\"Target\"\n        print(f\"Session after a direct request: {session.items()}\", flush=True)\n```\n\nThe test fails on the first assertion `assert session.get('foo') == 'bar'`. \nIf I comment it out, the test output is the following:\n\n```\nRedirecting to the target endpoint\nTarget endpoint reached\nSession after a redirect: dict_items([('redirected', 'true')])\nTarget endpoint reached\nSession after a direct request: dict_items([('foo', 'bar'), ('redirected', 'true')])\n```\n\n**IMPORTANT**: The described behavior is not reproduced when running the application with the real HTTP requests.\n\nEnvironment:\n\n- Python version: 3.13\n- Flask version: 3.10\n",
        "user": "okovpashko",
        "start_time": "2025-07-30T09:18:04Z",
        "end_time": "2025-08-18T16:56:49Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5797,
                "title": "push preserved contexts in correct order",
                "url": "https://github.com/pallets/flask/pull/5797",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "53b8f08218796d95764c5252bccd8a50a173a6fb",
                "message": "push preserved contexts in correct order",
                "author": "David Lord",
                "date": "2025-08-18T16:41:03Z"
            }
        ],
        "affected_files": [
            "tests/test_testing.py",
            "src/flask/testing.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 3,
            "total_prs": 1
        }
    },
    {
        "id": 5784,
        "title": "Add a \"Scroll to Top\" Button for Long Documentation Pages",
        "body": "Some pages in the Flask documentation—such as [API](https://flask.palletsprojects.com/en/stable/api/) and [Configuration Handling](https://flask.palletsprojects.com/en/stable/config/)—are very long, requiring users to manually scroll all the way back up to access the top navigation links.\n\nAdding a persistent \"Scroll to Top\" button (e.g. fixed to the bottom-left corner) would enhance usability by making navigation easier for users reading on smaller screens or mobile devices. This is a common accessibility and UX pattern on many documentation sites and could improve the overall reading experience.\n\nThis proposal does not affect Flask’s core library—it’s a suggestion for the documentation site UI only. I’m happy to help with a pull request if the maintainers are open to the addition.",
        "user": "nicholasaraj",
        "start_time": "2025-07-28T22:48:31Z",
        "end_time": "2025-07-31T18:47:19Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5788,
                "title": "docs: added scroll-to-top button with JS and CSS",
                "url": "https://github.com/pallets/flask/pull/5788",
                "state": "closed"
            },
            {
                "number": 5789,
                "title": "Scroll to top doc UI",
                "url": "https://github.com/pallets/flask/pull/5789",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "a486b9025e0c27d5e5132e23c14c450065d7b9e9",
                "message": "docs: added scroll-to-top button with JS and CSS",
                "author": "DaleStack",
                "date": "2025-07-31T18:32:49Z"
            },
            {
                "sha": "bc4b1593cc487ce46f4552cb251f6d9521934e93",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-07-31T18:46:49Z"
            },
            {
                "sha": "4785d8edc7daf5111cdbd271bfc5b793e5a16dfd",
                "message": "docs: changed button color in scrolltop.css and spacing in conf.py",
                "author": "DaleStack",
                "date": "2025-07-31T19:14:43Z"
            },
            {
                "sha": "468196d0c8e602b0b18ae32970780dbd9e6e9c23",
                "message": "Merge branch 'pallets:main' into scroll-top-doc-ui",
                "author": "DaleStack",
                "date": "2025-07-31T19:17:37Z"
            },
            {
                "sha": "8ae2bd3552aec5a7062809ba998e9dd23c552fb2",
                "message": "Add scroll-to-top button that appears after scrolling 300px",
                "author": "DaleStack",
                "date": "2025-07-31T19:21:28Z"
            },
            {
                "sha": "ca38ab893e2cfca4e45048d3acc78a63b61d0ef8",
                "message": "Merge branch 'scroll-top-doc-ui' of https://github.com/DaleStack/flask into scroll-top-doc-ui",
                "author": "DaleStack",
                "date": "2025-07-31T19:21:40Z"
            }
        ],
        "affected_files": [
            "docs/_static/scrolltop.css",
            "docs/conf.py",
            "docs/_static/scrolltop.js"
        ],
        "stats": {
            "total_commits": 6,
            "total_files": 3,
            "total_prs": 2
        }
    },
    {
        "id": 5776,
        "title": "Looser type annotations for send_file() path_or_file argument",
        "body": "`path_or_file` argument of `flask.helpers.send_file` is typed as `os.PathLike[t.AnyStr] | str | t.BinaryIO`. This prevents passing some objects that are `t.IO[bytes]`, but not `t.BinaryIO`. The underlying`werkzeug.utils.send_file` already allows `t.IO[bytes]` due to pallets/werkzeug#2209 since version 2.0.2.\n\n\nReproduction:\n```python\nfrom tempfile import NamedTemporaryFile\nfrom typing import IO\n\nfrom flask.helpers import send_file\n\n\n# The return type cannot be \"BinaryIO\" because \"NamedTemporaryFile\" is incompatible with it according to Mypy.\ndef some_function() -> IO[bytes]:\n    file = NamedTemporaryFile()\n    ...\n    return file\n\n\nfile = some_function()\nsend_file(file)\n```\n\nRaises the following exception with Mypy 1.16.1.\n```\nerror: Argument 1 to \"send_file\" has incompatible type \"IO[bytes]\"; expected \"PathLike[str] | str | BinaryIO\"  [arg-type]\n```\n\nI could simply change the return value of `some_function` to `_TemporaryFileWrapper[bytes]` or cast it to `BinaryIO`.\nHowever, I would like to allow `t.IO[bytes]`.\n\nSide note: `_TemporaryFileWrapper[bytes]` conforms to `PathLike[str]` due to python/typeshed#7840. That is why it is accepted by `flask.helpers.send_file`.\n\nAllowing `t.IO[bytes]` would be backwards compatible change as all `t.BinaryIO` are also `t.IO[bytes]`.\n[Mypy Playground](https://mypy-play.net/?mypy=latest&python=3.10&gist=4d7e2a43a847df9d332f5b7daba7a9fe)\n\nEnvironment:\n\n- Python version: 3.12.11\n- Flask version: 3.1.1\n",
        "user": "tvuotila",
        "start_time": "2025-07-16T09:06:28Z",
        "end_time": "2025-08-18T17:26:25Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5777,
                "title": "use IO[bytes] instead of BinaryIO for wider compatibility",
                "url": "https://github.com/pallets/flask/pull/5777",
                "state": "closed"
            },
            {
                "number": 5780,
                "title": "Widen send_file type hint to IO[bytes]",
                "url": "https://github.com/pallets/flask/pull/5780",
                "state": "closed"
            },
            {
                "number": 5781,
                "title": "Widen send_file type hint to IO[bytes]",
                "url": "https://github.com/pallets/flask/pull/5781",
                "state": "closed"
            },
            {
                "number": 5794,
                "title": "Loosen send_file type annotation to include typing.IO[bytes]",
                "url": "https://github.com/pallets/flask/pull/5794",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "d44f1c65239c3e33509224aa1931631243dbfa7f",
                "message": "relax type hint for bytes io",
                "author": "Tero Vuotila",
                "date": "2025-07-16T09:21:50Z"
            },
            {
                "sha": "439f1f2997412d4c3c1a3453af8111bb8120651c",
                "message": "allow IO[bytes] for send_file argument",
                "author": "agape1225",
                "date": "2025-07-23T10:56:02Z"
            },
            {
                "sha": "ab5702677b02d43fdde6103cdc4d5cca7bf8c666",
                "message": "erase comments",
                "author": "agape1225",
                "date": "2025-07-23T11:10:52Z"
            },
            {
                "sha": "655badb80020de0a2586863d3d1b4f8a9cf5bbd7",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-07-23T11:14:06Z"
            },
            {
                "sha": "b99c6afe182f401696aee39a173f9a4092a3f904",
                "message": "import IO for test 'test_send_file_io_bytes'",
                "author": "agape1225",
                "date": "2025-07-23T11:22:58Z"
            },
            {
                "sha": "45eb69f8bac0e4905c8f511a86b8c6705d33ff74",
                "message": "Update helpers.pyLoosen send_file type annotation to include t.IO[bytes]  Include typing.IO[bytes] to align with Werkzeug and resolve issue #5776.",
                "author": "Pouria-yvr",
                "date": "2025-08-06T00:31:06Z"
            }
        ],
        "affected_files": [
            "tests/test_helpers.py",
            "src/flask/helpers.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 6,
            "total_files": 3,
            "total_prs": 4
        }
    },
    {
        "id": 5774,
        "title": "`stream_with_context` does not work with async routes",
        "body": "Consider this trivial route + test in `app.py`:\n\n```python\nimport flask\nfrom flask import Flask\nfrom flask import Response\n\nimport pytest\n\napp = Flask(__name__)\n\n\n@app.route(\"/foo\")\nasync def foo():\n    def gen():\n        yield \"bar\"\n\n    return Response(flask.stream_with_context(gen()))\n\n\ndef test_foo():\n    with app.test_client() as client:\n        client.get(\"/foo\")\n```\n\nWith the following `requirements.txt`:\n\n```\nflask[async]==3.1.1\npytest==8.4.1\nwerkzeug==3.1.3\n```\n\nRunning `pytest app.py` results in:\n\n```\n============================= test session starts ==============================\nplatform darwin -- Python 3.12.11, pytest-8.4.1, pluggy-1.6.0\nrootdir: /private/tmp/stream_with_context\ncollected 1 item\n\napp.py F                                                                 [100%]\n\n=================================== FAILURES ===================================\n___________________________________ test_foo ___________________________________\n\n    def test_foo():\n        with app.test_client() as client:\n>           client.get(\"/foo\")\n\napp.py:20:\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nvenv/lib/python3.12/site-packages/werkzeug/test.py:1162: in get\n    return self.open(*args, **kw)\n           ^^^^^^^^^^^^^^^^^^^^^^\nvenv/lib/python3.12/site-packages/flask/testing.py:235: in open\n    response = super().open(\nvenv/lib/python3.12/site-packages/werkzeug/test.py:1116: in open\n    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nvenv/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app\n    rv = run_wsgi_app(self.application, environ, buffered=buffered)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nvenv/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app\n    app_rv = app(environ, start_response)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nvenv/lib/python3.12/site-packages/flask/app.py:1536: in __call__\n    return self.wsgi_app(environ, start_response)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nvenv/lib/python3.12/site-packages/flask/app.py:1527: in wsgi_app\n    ctx.pop(error)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <RequestContext 'http://localhost/foo' [GET] of app>, exc = None\n\n    def pop(self, exc: BaseException | None = _sentinel) -> None:  # type: ignore\n        \"\"\"Pops the request context and unbinds it by doing that.  This will\n        also trigger the execution of functions registered by the\n        :meth:`~flask.Flask.teardown_request` decorator.\n\n        .. versionchanged:: 0.9\n           Added the `exc` argument.\n        \"\"\"\n        clear_request = len(self._cv_tokens) == 1\n\n        try:\n            if clear_request:\n                if exc is _sentinel:\n                    exc = sys.exc_info()[1]\n                self.app.do_teardown_request(exc)\n\n                request_close = getattr(self.request, \"close\", None)\n                if request_close is not None:\n                    request_close()\n        finally:\n            ctx = _cv_request.get()\n            token, app_ctx = self._cv_tokens.pop()\n>           _cv_request.reset(token)\nE           ValueError: <Token var=<ContextVar name='flask.request_ctx' at 0x103cd9a30> at 0x104b23a40> was created in a different Context\n\nvenv/lib/python3.12/site-packages/flask/ctx.py:418: ValueError\n=========================== short test summary info ============================\nFAILED app.py::test_foo - ValueError: <Token var=<ContextVar name='flask.request_ctx' at 0x103cd9a30>...\n============================== 1 failed in 0.11s ===============================\n```\n\nSimilarly, `python -m flask run` and then `curl http://127.0.0.1:5000/foo` results in:\n\n```\n127.0.0.1 - - [15/Jul/2025 13:40:14] \"GET /foo HTTP/1.1\" 500 -\nError on request:\nTraceback (most recent call last):\n  File \"/private/tmp/stream_with_context/venv/lib/python3.12/site-packages/werkzeug/serving.py\", line 370, in run_wsgi\n    execute(self.server.app)\n  File \"/private/tmp/stream_with_context/venv/lib/python3.12/site-packages/werkzeug/serving.py\", line 331, in execute\n    application_iter = app(environ, start_response)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/private/tmp/stream_with_context/venv/lib/python3.12/site-packages/flask/app.py\", line 1536, in __call__\n    return self.wsgi_app(environ, start_response)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/private/tmp/stream_with_context/venv/lib/python3.12/site-packages/flask/app.py\", line 1527, in wsgi_app\n    ctx.pop(error)\n  File \"/private/tmp/stream_with_context/venv/lib/python3.12/site-packages/flask/ctx.py\", line 418, in pop\n    _cv_request.reset(token)\nValueError: <Token var=<ContextVar name='flask.request_ctx' at 0x1029ccea0> at 0x1049e1980> was created in a different Context\n```\n\nIf the route is defined `def foo():` without `async`, then this works without issue.\n\nOr if we remove `stream_with_context` and just `return Response(gen())`, also works.\n\nBut the combination of `async` + `stream_with_context` fails.\n\nThere's also no issue with e.g. flask 2.1.0; I believe this was introduced in flask 2.2.0, specifically by #4682.\n\nEnvironment:\n\n- Python version: 3.12.11\n- Flask version: 3.1.1",
        "user": "nkouevda-patreon",
        "start_time": "2025-07-15T21:08:57Z",
        "end_time": "2025-08-19T15:24:06Z",
        "state": "closed",
        "labels": [
            "async"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5775,
                "title": "Fix: Raise RuntimeError when stream_with_context is used on async view",
                "url": "https://github.com/pallets/flask/pull/5775",
                "state": "closed"
            },
            {
                "number": 5783,
                "title": "Respect autocorrect_location_header in make_response",
                "url": "https://github.com/pallets/flask/pull/5783",
                "state": "closed"
            },
            {
                "number": 5799,
                "title": "refactor stream_with_context for async views",
                "url": "https://github.com/pallets/flask/pull/5799",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "4d29df43613415aa384e46979f8037cc42e68ef9",
                "message": "Add test for stream_with_context raising RuntimeError on async view",
                "author": "Vignesh Deenadayal",
                "date": "2025-07-16T07:52:39Z"
            },
            {
                "sha": "8ccd430e79dd20f3cd151cdd7e7a4eeb30b04fc3",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-07-16T07:57:44Z"
            },
            {
                "sha": "184036e9af713379bb3ae0fcb6757a5222412ef1",
                "message": "Initial commit",
                "author": "agape1225",
                "date": "2025-07-26T11:35:25Z"
            },
            {
                "sha": "e5fd6e11e40f3fac64d1ae34a414a6b0028f50a9",
                "message": "Merge branch 'pallets:stable' into stable",
                "author": "agape1225",
                "date": "2025-07-26T13:21:28Z"
            },
            {
                "sha": "9016ca3fd09afa85113366cfae9a3676db635598",
                "message": "fix(app): respect autocorrect_location_header in make_response",
                "author": "agape1225",
                "date": "2025-07-26T13:47:21Z"
            },
            {
                "sha": "9822a0351574790cb66c652fcc396ad7aa2b09d8",
                "message": "refactor stream_with_context for async views",
                "author": "David Lord",
                "date": "2025-08-19T15:18:55Z"
            }
        ],
        "affected_files": [
            "tests/test_helpers.py",
            "src/flask/app.py",
            "src/flask/helpers.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 6,
            "total_files": 4,
            "total_prs": 3
        }
    },
    {
        "id": 5768,
        "title": "Flask documentation website does not support dark mode",
        "body": "**Describe the issue**\nThe official Flask documentation at https://flask.palletsprojects.com currently does not support dark mode. For many developers, especially those working at night or with light sensitivity, this can create accessibility and eye strain issues.\n\n**Expected behavior**\nIt would be helpful if the documentation site could support an optional dark theme, either by detecting system preferences (prefers-color-scheme) or allowing manual switching.\n\n**Additional context**\nMany popular frameworks like: \n- Django\n- FastAPI\n- Pydantic\n- Typer\nhave added dark mode support in their docs, improving readability and user comfort.",
        "user": "p-r-a-v-i-n",
        "start_time": "2025-07-09T10:11:48Z",
        "end_time": "2025-07-09T14:22:24Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5768.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5766,
        "title": "Tt",
        "body": "<!--\nReplace this comment with a description of what the feature should do.\nInclude details such as links to relevant specs or previous discussions.\n-->\n\n<!--\nReplace this comment with an example of the problem which this feature\nwould resolve. Is this problem solvable without changes to Flask, such\nas by subclassing or using an extension?\n-->\n",
        "user": "shivamrag",
        "start_time": "2025-07-06T15:33:57Z",
        "end_time": "2025-07-06T15:34:55Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5766.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5763,
        "title": "document that `request.full_path` leaves query string percent encoded",
        "body": "WHAT IS THE BUG?\n\n`request.full_path` is documented as *“Requested path as unicode, including the query string.”*  \nHowever, Werkzeug URL-unquotes only the **path** (before “?”); the **query string** is returned **raw**.  \nCode that searches or whitelists on `full_path` can therefore be bypassed by percent-encoding a slash inside a parameter.\n\n----------------------------------------------------------------------------------------------------------------\n\nHOW TO REPLICATE\n\n```\n```python\nfrom flask import Flask, request\napp = Flask(__name__)\n\n@app.route(\"/show_picture\")\ndef show_picture():\n    # naïve traversal filter\n    if \"../\" in request.full_path:\n        return \"Blocked\", 400\n    return f\"full_path = {request.full_path}\", 200\n\n# run:  flask --app poc run\n\n\n# bypass: \"../\" hidden as \"%2F\"\ncurl \"http://127.0.0.1:5000/show_picture?img=..%2F..%2Fetc%2Fpasswd\"\nResult → 200 OK; the filter misses the traversal because ../ appears as ..%2F.\n```\n\n----------------------------------------------------------------------------------------------------------------\n\n\nEXPECTED BEHAVIOR\nDocumentation (and the full_path docstring) should warn clearly:\n\n\"Only the portion before “?” is URL-unquoted. The query string is returned raw; unquote it manually (e.g. urllib.parse.unquote_plus) before using it for validation or filtering.\"\n\nWithout that notice, filters like\n\nif \"../\" in request.full_path:\n    ...\nif request.full_path.startswith(\"/admin\"):\n    ...\n\ncan be bypassed with %2F inside the query string.\n\n----------------------------------------------------------------------------------------------------------------\n\nPython version: 3.12.3\n\nFlask version: 2.3.3\n\nWerkzeug version: 3.1.3\n\nOS: Ubuntu 24.04 LTS\n\n----------------------------------------------------------------------------------------------------------------\n\nAcknowledgements\nDiscovery: Jefferson Gozanels GHomez\nProof-of-concept & report: Sebastián Alba Vives\n",
        "user": "Sebasteuo",
        "start_time": "2025-06-23T02:47:18Z",
        "end_time": "2025-06-23T17:09:27Z",
        "state": "closed",
        "labels": [
            "docs"
        ],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5763.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5756,
        "title": "404 Flask cannot find /security/login API",
        "body": "We are using airflow 2.8.4, and recently we upgrade it to 2.10.5\n\n### Environment for Airflow 2.8.4\n\n- Python version: 3.10\n- Flask version: \n\n```\nFlask-AppBuilder==4.3.11\nFlask-Babel==2.0.0\nFlask-Bcrypt==1.0.1\nFlask-Caching==2.1.0\nFlask-JWT-Extended==4.6.0\nFlask-Limiter==3.5.1\nFlask-Login==0.6.3\nFlask-SQLAlchemy==2.5.1\nFlask-Session==0.5.0\nFlask-WTF==1.2.1\nFlask==2.2.5\n```\n\nCall /security/login API:\n\n<img width=\"1541\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ef976819-1ac1-4bd6-b84b-3ceab844a998\" />\n\n\n### Environment for Airflow 2.10.5\n\n- Python version: 3.10\n- Flask version: \n\n```\nFlask-AppBuilder==4.5.2\nFlask-Babel==2.0.0\nFlask-Bcrypt==1.0.1\nFlask-Caching==2.3.0\nFlask-JWT-Extended==4.7.1\nFlask-Limiter==3.10.1\nFlask-Login==0.6.3\nFlask-SQLAlchemy==2.5.1\nFlask-Session==0.5.0\nFlask-WTF==1.2.2\nFlask==2.2.5\n```\n\nCall /security/login API:\n\n<img width=\"1552\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/e6ca32db-cb56-49e6-a266-8edb82e8d0b2\" />\n\n\nError Log:\n```\n{\n  \"detail\": \"The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\",\n  \"status\": 404,\n  \"title\": \"Not Found\",\n  \"type\": \"about:blank\"\n}\n```\n\n/security/login API in  Flask-AppBuilder==4.5.2\n\nhttps://github.com/dpgaspar/Flask-AppBuilder/blob/v4.5.2/flask_appbuilder/security/api.py#L32\n\n/security/login API in  Flask-AppBuilder==4.3.11\n\nhttps://github.com/dpgaspar/Flask-AppBuilder/blob/v4.3.11/flask_appbuilder/security/api.py#L32",
        "user": "HuanjieGuo",
        "start_time": "2025-06-09T18:18:08Z",
        "end_time": "2025-06-09T18:33:22Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5756.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5755,
        "title": "Flask cannot find /security/logic API",
        "body": "We are using airflow 2.8.4, and recently we upgrade it to 2.10.5\n\nEnvironment for Airflow 2.8.4\n\n- Python version: 3.10\n- Flask version: \n\n```\nFlask-AppBuilder==4.5.2\nFlask-Babel==2.0.0\nFlask-Bcrypt==1.0.1\nFlask-Caching==2.3.0\nFlask-JWT-Extended==4.7.1\nFlask-Limiter==3.10.1\nFlask-Login==0.6.3\nFlask-SQLAlchemy==2.5.1\nFlask-Session==0.5.0\nFlask-WTF==1.2.2\nFlask==2.2.5\n```\n\nCall /security/logic API:\n\n<img width=\"1541\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ef976819-1ac1-4bd6-b84b-3ceab844a998\" />\n\n\nEnvironment for Airflow 2.10.5\n\n- Python version: 3.10\n- Flask version: \n\n```\nFlask-AppBuilder==4.3.11\nFlask-Babel==2.0.0\nFlask-Bcrypt==1.0.1\nFlask-Caching==2.1.0\nFlask-JWT-Extended==4.6.0\nFlask-Limiter==3.5.1\nFlask-Login==0.6.3\nFlask-SQLAlchemy==2.5.1\nFlask-Session==0.5.0\nFlask-WTF==1.2.1\nFlask==2.2.5\n```\n\nCall /security/logic API:\n\n<img width=\"1552\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/e6ca32db-cb56-49e6-a266-8edb82e8d0b2\" />\n",
        "user": "HuanjieGuo",
        "start_time": "2025-06-09T18:11:05Z",
        "end_time": "2025-06-09T18:13:39Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5755.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5751,
        "title": "Typing mismatch between Flask and Werkzeug \"Response\" objects",
        "body": "There is an odd typing issue where Werkzeug `Response` != Flask `Response`. Please see below:\n\n```python\nfrom flask import Response, redirect, url_for\n\ndef foo() -> Response:\n    return redirect(url_for(\"some.route\"))\n```\n\nThis example returns:\n\n```\nbasedpyright: Type \"Response\" is not assignable to return type \"Response\"                                \n  \"werkzeug.wrappers.response.Response\" is not assignable to \"flask.wrappers.Response\" [reportReturnType]\n```\n\nEnvironment:\n\n- Python version: 3.13\n- Flask version: 3.1.1\n",
        "user": "savchenko",
        "start_time": "2025-06-03T06:07:09Z",
        "end_time": "2025-06-03T11:18:10Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5751.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5746,
        "title": "MAX_FORM_MEMORY_SIZE not being picked up correctly",
        "body": "## ISSUE\nSetting app.config[\"MAX_FORM_MEMORY_SIZE\"] = VALUE\ndoes not have any effect on the actual configuration and the default 500000 bytes from werkzeug request is stilled used\n\n\n## REPLICATION\nSetup a minimum flask project\n\napp = Flask(__name__)\napp.config[\"MAX_FORM_MEMORY_SIZE\"] = 1024 * 1024 * 1024\n\nprint(app.request_class.max_form_memory_size)\n\n## MISSBEHAVIOUR\nI would expect if I set the MAX FORM MEMORY SIZE in my config it is properly applied and I can send requests with a content length appropriate to the setting but flask defaults to 500kb\n\nEnvironment:\n\n- Python version:  3.11\n- Flask version: 2.3.3\n",
        "user": "skiwan",
        "start_time": "2025-05-27T13:03:43Z",
        "end_time": "2025-05-27T13:35:07Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5746.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5745,
        "title": "Model Context Protocol (MCP) Support for Flask",
        "body": "## Feature Request: Model Context Protocol (MCP) Support for Flask\n\n### Description\n\nThis feature request proposes adding native support for the Model Context Protocol (MCP) to Flask. MCP is an open protocol that enables secure connections between host applications and AI model providers, allowing for standardized communication patterns in AI-powered applications.\n\n**Key aspects of MCP integration would include:**\n- Built-in MCP server capabilities for Flask applications\n- Middleware for handling MCP message routing\n- Authentication and authorization mechanisms for MCP connections\n- WebSocket and HTTP transport support as per MCP specification\n- Integration with Flask's existing request/response cycle\n\n**Relevant links:**\n- [Model Context Protocol Specification](https://modelcontextprotocol.io/introduction)\n- [MCP GitHub Repository](https://github.com/modelcontextprotocol/python-sdk)\n\n### Problem Statement\n\nCurrently, developers who want to build AI-powered Flask applications that communicate via MCP must implement the protocol manually or rely on third-party libraries. This creates several challenges:\n\n1. **Boilerplate Code**: Developers need to write significant boilerplate to handle MCP message formatting, routing, and transport\n2. **Inconsistent Implementation**: Without standardized Flask integration, different projects implement MCP differently\n3. **Security Concerns**: Manual implementation may miss important security considerations built into the MCP spec\n4. **Maintenance Overhead**: Keeping custom MCP implementations up-to-date with protocol changes\n\n**Example use case:**\nA Flask application serving as an AI assistant backend needs to:\n- Accept MCP connections from client applications\n- Handle tool calls and resource requests\n- Maintain secure, authenticated sessions\n- Process streaming responses\n\nCurrently, this requires extensive custom code that could be standardized.\n\n### Proposed Solution\n\nAdd Flask-MCP as either a core extension or built-in functionality that provides:\n\n```python\nfrom flask import Flask\nfrom flask_mcp import MCPServer\n\napp = Flask(__name__)\nmcp = MCPServer(app)\n\n@mcp.tool(\"get_weather\")\ndef get_weather(location: str) -> str:\n    # Tool implementation\n    return f\"Weather in {location}\"\n\n@mcp.resource(\"user_preferences\")\ndef get_user_prefs():\n    # Resource implementation\n    return {\"theme\": \"dark\"}\n```\n\nThis would make Flask a first-class citizen in the MCP ecosystem alongside other frameworks.\n\n### Alternative Approaches\n\nWhile this could be implemented as a third-party extension (and some exist), native Flask support would:\n- Ensure better integration with Flask's ecosystem\n- Provide official maintenance and security updates  \n- Encourage broader MCP adoption in Python web development\n- Offer performance optimizations through deeper Flask integration\n\nWhat do you think?  🚀\n",
        "user": "jorben",
        "start_time": "2025-05-25T03:21:12Z",
        "end_time": "2025-05-25T03:57:26Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5745.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5738,
        "title": "Allow multiple template folders for large projects",
        "body": "\nJinja2 supports multiple search paths for templates so Flask should do the same. This will allow template inheriting without copying files.\n\n\nhttps://github.com/pallets/jinja/blob/main/src/jinja2/loaders.py#L190\n",
        "user": "Tobey",
        "start_time": "2025-05-20T10:48:36Z",
        "end_time": "2025-05-20T12:18:26Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5739,
                "title": "Allow iterables for multiple template paths",
                "url": "https://github.com/pallets/flask/pull/5739",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "063544167d6691c081007612419c237962dd1c71",
                "message": "allow iterables template paths",
                "author": "Tobey Asinugo",
                "date": "2025-05-20T10:52:15Z"
            },
            {
                "sha": "914b3bfdd0fe9c39cc10414941ddfa14ba1dc38e",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-05-20T11:01:02Z"
            }
        ],
        "affected_files": [
            "src/flask/app.py",
            "src/flask/blueprints.py",
            "src/flask/sansio/app.py",
            "src/flask/sansio/blueprints.py",
            "src/flask/sansio/scaffold.py"
        ],
        "stats": {
            "total_commits": 2,
            "total_files": 5,
            "total_prs": 1
        }
    },
    {
        "id": 5729,
        "title": "The `template_filter` decorator doesn't work if you don't pass an argument",
        "body": "## What's the issue?\n\nYou can use `template_filter` as a decorator, but it only registers the filter if you write an explicit name or an empty set of parentheses. If you call it without parens, the filter doesn't get registered.\n\nIt's a small difference and can be confusing.\n\n## Minimal example\n\nConsider the following program:\n\n```python\nfrom flask import Flask, render_template_string\n\n\napp = Flask(__name__)\n\n\n@app.template_filter\ndef double(x):\n    return x * 2\n\n\n@app.route(\"/\")\ndef index():\n    return render_template_string(\"2 times 2 is {{ 2 | double }}\")\n```\n\nIf you run this app (`flask run --port 8008 --debug`) and then open it in your browser (`http://localhost:8008`) you'll get an error:\n\n```\njinja2.exceptions.TemplateAssertionError: No filter named 'double'.\n```\n\nThis is confusing, and it took me a while to realise the missing parentheses in `app.template_filter` were at fault.\n\n## Suggested fix\n\nI think it would be helpful if the decorator either:\n\n* Supported being called without parentheses, or\n* Printed an explicit warning if called this way, e.g. `Did you use 'template_filter' as a decorator without parentheses? You need to call it with 'template_filter()'`\n\nThis is caught by type checkers, but not everybody type checks their Python and the error message is less obvious:\n\n```\nArgument 1 to \"template_filter\" of \"App\" has incompatible type \"Callable[[Any], Any]\"; expected \"str | None\"\n```\n\nI've had a look at the relevant code, and I'd be happy to provide a patch if you think this is a useful change.\n\n## Environment\n\n- Python version: Python 3.11.11\n- Flask version: Flask 3.1.0\n",
        "user": "alexwlchan",
        "start_time": "2025-05-12T08:33:00Z",
        "end_time": "2025-08-19T19:36:01Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5734,
                "title": "Fix template_filter decorator to support usage without parentheses",
                "url": "https://github.com/pallets/flask/pull/5734",
                "state": "closed"
            },
            {
                "number": 5735,
                "title": "fix #5729: raise TypeError when @app.template_filter is used without parenthesis",
                "url": "https://github.com/pallets/flask/pull/5735",
                "state": "closed"
            },
            {
                "number": 5736,
                "title": "support call template_filter without parens",
                "url": "https://github.com/pallets/flask/pull/5736",
                "state": "closed"
            },
            {
                "number": 5743,
                "title": "Fix template decorators to work without parentheses",
                "url": "https://github.com/pallets/flask/pull/5743",
                "state": "closed"
            },
            {
                "number": 5761,
                "title": "fix: template_filter function ( function parameter was overridden by 'name')",
                "url": "https://github.com/pallets/flask/pull/5761",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "c94824744c673a3408b5b3f87d71f05f48e35f48",
                "message": "Fix: Support decorator usage without parentheses for template_filter",
                "author": "Akshay",
                "date": "2025-05-16T08:41:54Z"
            },
            {
                "sha": "6ff24afee826daf4348b1f04911dc51120b8827b",
                "message": "Fix template_filter decorator to support both usage styles and update docstring; update CHANGES.rst",
                "author": "Akshay",
                "date": "2025-05-16T09:19:45Z"
            },
            {
                "sha": "c5d00407b39f2fed6669eb15dd3f26dbf7cd4a7d",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-05-16T09:28:03Z"
            },
            {
                "sha": "cec6f73b88343293b49af5c278714b079f6291de",
                "message": "Fix template_filter to support usage without parentheses; fix typing error",
                "author": "Akshay",
                "date": "2025-05-16T09:43:22Z"
            },
            {
                "sha": "4b261ffeb71a1207b3ce3cb2550e2a639d99253e",
                "message": "modified the .readthedocs.yaml",
                "author": "Akshay",
                "date": "2025-05-16T10:05:51Z"
            },
            {
                "sha": "8ac92a7b7b4c2a94772dad22423e246aba02fa89",
                "message": "fix: install Sphinx in .readthedocs.yaml to fix docs build error",
                "author": "Akshay",
                "date": "2025-05-16T10:11:17Z"
            },
            {
                "sha": "34cf340bdf21f434e3598b7bda15acb6b8b63f1d",
                "message": "fix: install pallets_sphinx_themes in .readthedocs.yaml to fix docs build error",
                "author": "Akshay",
                "date": "2025-05-16T10:13:41Z"
            },
            {
                "sha": "e22cdae09abc36a091f57a3aa6b053abbc306819",
                "message": "fix: install Flask package and doc dependencies in ReadTheDocs build config",
                "author": "Akshay",
                "date": "2025-05-16T10:17:35Z"
            },
            {
                "sha": "96b13fdea968cfee82233365485bdb40ebe394a5",
                "message": "requirements.txt added",
                "author": "Akshay",
                "date": "2025-05-16T10:23:28Z"
            },
            {
                "sha": "02978820383655bfcf3f9847fba78f4b447f046f",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-05-16T11:02:32Z"
            },
            {
                "sha": "2c331f67ea514fc510e40e3a99cbaa6a8c98eb9b",
                "message": "fix: raise TypeError when @app.template_filter is used without parentheses",
                "author": "gable-github",
                "date": "2025-05-16T22:07:40Z"
            },
            {
                "sha": "daf1510a4bda652ac2cfca03ec5567b03ddf8bf1",
                "message": "use template_filter without parens",
                "author": "kadai0308",
                "date": "2025-05-17T04:17:18Z"
            },
            {
                "sha": "edebd3704437f19b5b137eaffe97130fe817d144",
                "message": "rewrite docs, clean up typing for template decorators",
                "author": "David Lord",
                "date": "2025-08-19T19:29:47Z"
            },
            {
                "sha": "08f277903985ec8a8f486045b56eebd8204542e1",
                "message": "Fix template decorators to work without parentheses\n\nThis fixes an issue where template decorators like @app.template_filter\ndon't work when used without parentheses. The fix allows the decorators\nto be used in both ways:\n\n- @app.template_filter\n- @app.template_filter()\n\nThe following decorators have been fixed:\n- template_filter, template_test, template_global in Flask\n- app_template_filter, app_template_test, app_template_global in Blueprint\n\nFixes #5729",
                "author": "Alex Ding",
                "date": "2025-05-22T18:13:37Z",
                "files": [
                    "src/flask/sansio/app.py",
                    "src/flask/sansio/blueprints.py",
                    "tests/test_decorator_no_parens.py"
                ]
            },
            {
                "sha": "184ec3c5453e1156372085df35e8d922ce7e3559",
                "message": "Fix global CONTRIBUTING link",
                "author": "AJ Jordan",
                "date": "2025-05-18T15:11:00Z"
            },
            {
                "sha": "a42c4d54a3e5cd56c0700479ede75157a748acd6",
                "message": "Fix global CONTRIBUTING link (#5737)",
                "author": "David Lord",
                "date": "2025-05-20T16:30:04Z"
            },
            {
                "sha": "e4bf79329ae48c5dc2ffd727ef601dc80d9299f4",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-05-22T18:30:50Z"
            },
            {
                "sha": "b6618c687d0e513bc17b5e1df52cd966e1402ca4",
                "message": "fix: template_filter function",
                "author": "Pravin Kamble",
                "date": "2025-06-17T17:33:19Z"
            },
            {
                "sha": "bd63d982ca486f277df9a5c92a17b55dca412c63",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-06-17T17:37:02Z"
            }
        ],
        "affected_files": [
            "CHANGES.rst",
            "tests/test_template_filters.py",
            "docs/contributing.rst",
            "docs/templating.rst",
            "tests/test_templating.py",
            "tests/test_decorator_no_parens.py",
            "tests/test_blueprints.py",
            "src/flask/sansio/app.py",
            "src/flask/sansio/blueprints.py",
            "requirements.txt",
            ".readthedocs.yaml"
        ],
        "stats": {
            "total_commits": 19,
            "total_files": 11,
            "total_prs": 5
        }
    },
    {
        "id": 5726,
        "title": "Adding Architecture Diagram Contribution",
        "body": "Hello maintainers!\nI've created an architecture diagram that visualizes Flask's core components and their relationships. This visualization could help new contributors understand the codebase structure and assist users in grasping Flask's high-level architecture.\n\n![Image](https://github.com/user-attachments/assets/143025cf-6094-4c19-93f5-ac06bfa59738)\n\n[Flask Architecture Diagram on Kloudfarm.io](https://app.kloudfarm.io/share/379c2674f0b240c387a5135690c8f01c8c18a988878e99846fb36ea18ad7e1ef)\nThe diagram shows:\n- Core Flask classes and relationships\n- Request/response lifecycle\n- Extension integration points\n- Blueprint organization\n\nI'd be happy to:\n\n1. Submit a PR to add this to documentation\n2. Provide different file formats\n3. Create more focused diagrams of specific subsystems\n\nWould this be a helpful addition to the project? Open to any feedback or suggestions.\nThanks!",
        "user": "kiran-kf",
        "start_time": "2025-05-10T16:22:17Z",
        "end_time": "2025-05-10T16:45:20Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5726.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5721,
        "title": "Ihmuukin_ai",
        "body": "<!--\nThis issue tracker is a tool to address bugs in Flask itself. Please use\nGitHub Discussions or the Pallets Discord for questions about your own code.\n\nReplace this comment with a clear outline of what the bug is.\n-->\n\n<!--\nDescribe how to replicate the bug.\n\nInclude a minimal reproducible example that demonstrates the bug.\nInclude the full traceback if there was an exception.\n-->\n\n<!--\nDescribe the expected behavior that should have happened but didn't.\n-->\n\nEnvironment:\n\n- Python version:\n- Flask version:\n",
        "user": "ihmuukin",
        "start_time": "2025-04-22T11:37:28Z",
        "end_time": "2025-04-22T11:40:56Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5721.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5718,
        "title": "Recommend Warning and Safer Defaults for url_for(..., _external=True)",
        "body": "Hi Flask team,\n\nWe recently analyzed several Flask-based applications and noticed a recurring security concern related to url_for(..., _external=True) when used in untrusted request contexts. Specifically, since it uses request.host by default to construct the external URL, applications that do not explicitly configure SERVER_NAME or sanitize headers can be vulnerable to host header injection.\n\nTo improve developer awareness and reduce misuse, we suggest: Add a warning to the url_for documentation about the risk of relying on request.host, and recommend the use of SERVER_NAME or trusted_hosts when generating external URLs.\n\nWe’d be happy to help draft the relevant documentation or contribute a pull request if this direction aligns with the maintainers' goals.\n\nBest regards,\nRui Yang and Zhengyu Liu\nJohns Hopkins University\n",
        "user": "BrookeYangRui",
        "start_time": "2025-04-14T03:53:08Z",
        "end_time": "2025-08-18T18:47:07Z",
        "state": "closed",
        "labels": [
            "docs"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5722,
                "title": "docs: add warning and best practices for url_for(..., _external=True)…",
                "url": "https://github.com/pallets/flask/pull/5722",
                "state": "closed"
            },
            {
                "number": 5750,
                "title": "Add section on host header injection and _external=True in url_for (#…",
                "url": "https://github.com/pallets/flask/pull/5750",
                "state": "closed"
            },
            {
                "number": 5798,
                "title": "security docs for TRUSTED_HOSTS",
                "url": "https://github.com/pallets/flask/pull/5798",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "676aa43430b9f047f95cef068cb0735c6d92a101",
                "message": "docs: add warning and best practices for url_for(..., _external=True) (closes #5718)",
                "author": "Rajveer Verma",
                "date": "2025-04-27T07:55:38Z",
                "files": [
                    "docs/web-security.rst"
                ]
            },
            {
                "sha": "7205e1aadc10ebbcf94fcb5277d24195b60fcd2b",
                "message": "Add section on host header injection and _external=True in url_for (#5718)",
                "author": "BlaytonV",
                "date": "2025-06-03T01:47:34Z",
                "files": [
                    "docs/web-security.rst"
                ]
            },
            {
                "sha": "b228ca3d87745b746d904a2108429617a814ffda",
                "message": "security docs for TRUSTED_HOSTS",
                "author": "David Lord",
                "date": "2025-08-18T18:42:48Z"
            }
        ],
        "affected_files": [
            "docs/web-security.rst"
        ],
        "stats": {
            "total_commits": 3,
            "total_files": 1,
            "total_prs": 3
        }
    },
    {
        "id": 5711,
        "title": "close resources before reload (option --reload)",
        "body": "I have a Flask application that establishes connections to multiple SQLite databases.  When the local development server (werkzeug) is started with option ``--reload`` the connections are not closed on reload, since Python 3.13 this is also logged with a [ResourceWarning](https://docs.python.org/3/whatsnew/3.13.html#sqlite3):\n\n    ResourceWarning: unclosed database in <sqlite3.Connection object at ...>\n\nSince the application (since each thread) establishes various DB connections, the (debug) log is flooded with such warnings during development.\n\nI am aware that the DB connectors can be closed when the context is [torn down](https://flask.palletsprojects.com/en/stable/patterns/sqlite3/), but this is not desired. The DB connections should be open over the entire lifetime of the server (thread).\n\nAnd the problem is not limited to sqlite3, in general, it would be better to close resources before reloading the modules.\n\nIs there perhaps a hook or another chance with which it would be possible to close open resources?\n\n\n-----\n\n*I placed it here as a feature-request .. may we better move this issue to werkzeug?*",
        "user": "return42",
        "start_time": "2025-04-09T14:00:37Z",
        "end_time": "2025-04-09T15:00:53Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5711.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5709,
        "title": "Reference cycle caused by exception handling",
        "body": "A reference cycle is introduced by Flask's exception handling mechanism. Specifically, the exception object retains a reference to the stack frame, which in turn holds a reference back to the exception. This creates a reference cycle between the traceback and the exception instance.\n\nThis becomes particularly problematic in applications where the garbage collector is disabled (gc.disable()). Even when the GC is enabled, this cycle puts unnecessary pressure on memory management.\n\nThe issue originates from the following line in the Flask source code: https://github.com/pallets/flask/blob/9225f8bb28d291b1610c8a58e3233aa6bbdc1808/src/flask/app.py#L1507\n\nThe fix is simple: the reference to the exception object should be explicitly released once it is no longer needed.\n\nA minimal reproducible example demonstrating this issue can be found here:\n👉 https://github.com/tomasz-pankowski/exception-memory-leak/tree/main\n\nEnvironment:\n\n- Python version: any\n- Flask version: 3.1.0 (earlier ones too)\n",
        "user": "tomasz-pankowski",
        "start_time": "2025-04-06T08:05:19Z",
        "end_time": "2025-04-07T18:00:31Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5710,
                "title": "fix for 5709: explicitly delete error references to prevent memory leaks",
                "url": "https://github.com/pallets/flask/pull/5710",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "9225f8bb28d291b1610c8a58e3233aa6bbdc1808",
                "message": "fix: explicitly delete error references to prevent memory leaks\n\nAdd explicit \"del error\" statement to prevent reference cycles between\nexception objects and local variables. This helps the garbage collector\npromptly reclaim memory after request processing, which is especially\nimportant in high-traffic web applications where exception objects with\ntraceback information can consume significant memory.",
                "author": "Tomasz Pankowski",
                "date": "2025-04-04T22:13:34Z"
            },
            {
                "sha": "9075225c5bfb4086c6ea662bd85b3138f6c72df8",
                "message": "update CHANGES",
                "author": "Tomasz Pankowski",
                "date": "2025-04-06T08:12:15Z"
            }
        ],
        "affected_files": [
            "src/flask/app.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 2,
            "total_files": 2,
            "total_prs": 1
        }
    },
    {
        "id": 5707,
        "title": "Jija2 security vulnerability",
        "body": "There is a security vulnerability reported for Jinja2 https://github.com/advisories/GHSA-cpwx-vrp4-4pq7\n\nSolution is to update the Jinja2 version to 3.1.6\n\n\nEnvironment:\n\n- Python version: latest\n- Flask version: latest\n",
        "user": "pdhotems",
        "start_time": "2025-04-01T13:49:09Z",
        "end_time": "2025-04-01T13:51:03Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5707.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5692,
        "title": "'pkgutil.get_loader' is removed from Python 3.14",
        "body": "Per What's new in Python 3.14:\n> Remove deprecated pkgutil.get_loader() and pkgutil.find_loader(). These had previously raised a DeprecationWarning since Python 3.12. (Contributed by Bénédikt Tran in gh-97850.)\n\nIt manifests in flask's tests: \n\n```\n______________ ERROR at setup of test_prefix_package_paths[True] _______________\n\nrequest = <SubRequest 'limit_loader' for <Function test_prefix_package_paths[True]>>\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f1fe6cb9b70>\n\n    @pytest.fixture(params=(True, False))\n    def limit_loader(request, monkeypatch):\n        \"\"\"Patch pkgutil.get_loader to give loader without get_filename or archive.\n    \n        This provides for tests where a system has custom loaders, e.g. Google App\n        Engine's HardenedModulesHook, which have neither the `get_filename` method\n        nor the `archive` attribute.\n    \n        This fixture will run the testcase twice, once with and once without the\n        limitation/mock.\n        \"\"\"\n        if not request.param:\n            return\n    \n        class LimitedLoader:\n            def __init__(self, loader):\n                self.loader = loader\n    \n            def __getattr__(self, name):\n                if name in {\"archive\", \"get_filename\"}:\n                    raise AttributeError(f\"Mocking a loader which does not have {name!r}.\")\n                return getattr(self.loader, name)\n    \n>       old_get_loader = pkgutil.get_loader\nE       AttributeError: module 'pkgutil' has no attribute 'get_loader'\n\nERROR tests/test_instance_config.py::test_installed_module_paths[True] - Attr...\nERROR tests/test_instance_config.py::test_installed_package_paths[True] - Att...\nERROR tests/test_instance_config.py::test_prefix_package_paths[True] - Attrib...\n```\n\nRun the tests with Python 3.14\n\nEnvironment:\n\n- Python version: 3.14.0a6\n- Flask version: 3.1.0\n",
        "user": "befeleme",
        "start_time": "2025-03-19T11:08:53Z",
        "end_time": "2025-03-29T22:45:22Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5693,
                "title": "add fixture to mock importlib.util.find_spec for custom loaders in tests",
                "url": "https://github.com/pallets/flask/pull/5693",
                "state": "closed"
            },
            {
                "number": 5696,
                "title": "add fixture to mock importlib.util.find_spec for custom loaders in tests",
                "url": "https://github.com/pallets/flask/pull/5696",
                "state": "closed"
            },
            {
                "number": 5697,
                "title": "Stable",
                "url": "https://github.com/pallets/flask/pull/5697",
                "state": "closed"
            },
            {
                "number": 5702,
                "title": "remove tests about deprecated pkgutil.get_loader",
                "url": "https://github.com/pallets/flask/pull/5702",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "9ce6e72e2ccc60ed862b3bedf0a6a263844ee530",
                "message": "add fixture to mock importlib.util.find_spec for custom loaders in tests",
                "author": "degerahmet",
                "date": "2025-03-20T07:11:18Z"
            },
            {
                "sha": "c0bbfef68da6be07e6b8b3755b1a513673e55068",
                "message": "Fix Read the Docs build failure",
                "author": "degerahmet",
                "date": "2025-03-25T03:10:13Z"
            },
            {
                "sha": "41ec5760a2c55a099c3a1733fdd36fbb1258a02b",
                "message": "remove tests about deprecated pkgutil.get_loader",
                "author": "David Lord",
                "date": "2025-03-29T22:42:58Z"
            }
        ],
        "affected_files": [
            "_build/.doctrees/contributing.doctree",
            "_build/.doctrees/deploying/waitress.doctree",
            "_build/.doctrees/deploying/mod_wsgi.doctree",
            "_build/.doctrees/deploying/proxy_fix.doctree",
            "_build/.doctrees/index.doctree",
            "_build/.doctrees/changes.doctree",
            "_build/.doctrees/deploying/gunicorn.doctree",
            "_build/.doctrees/blueprints.doctree",
            "_build/.doctrees/api.doctree",
            "tests/test_instance_config.py",
            "_build/.doctrees/debugging.doctree",
            "_build/.doctrees/deploying/asgi.doctree",
            "_build/.doctrees/deploying/nginx.doctree",
            "tests/conftest.py",
            "_build/.doctrees/license.doctree",
            "_build/.doctrees/config.doctree",
            "_build/.buildinfo",
            "_build/.doctrees/extensions.doctree",
            "_build/.doctrees/deploying/apache-httpd.doctree",
            "_build/.doctrees/installation.doctree",
            "_build/.doctrees/extensiondev.doctree",
            "_build/.doctrees/lifecycle.doctree",
            "_build/.doctrees/deploying/index.doctree",
            "_build/.doctrees/async-await.doctree",
            "_build/.doctrees/appcontext.doctree",
            "_build/.doctrees/deploying/eventlet.doctree",
            "_build/.doctrees/design.doctree",
            "_build/.doctrees/deploying/gevent.doctree",
            "_build/.doctrees/errorhandling.doctree",
            "_build/.doctrees/environment.pickle",
            "_build/.doctrees/cli.doctree",
            "_build/.doctrees/deploying/uwsgi.doctree"
        ],
        "stats": {
            "total_commits": 3,
            "total_files": 32,
            "total_prs": 4
        }
    },
    {
        "id": 5691,
        "title": "flask.__init__.__getattr__ can hide typing errors",
        "body": "admittedly this is a bit of an edge case -- but perhaps if the `__getattr__` pattern is implemented next time for deprecations this can be taken into consideration!\n\nI have an unfortunately-named bit in my webapp called \"flash\" and I've used flask for years and my fingers tend to typo one as the other.\n\nI had a file like this (simplified!):\n\n```python\nimport flask\n\nflask.FlashMessage\n```\n\nwhich is obviously wrong -- flask doesn't have a `FlashMessage`!  but it was passing mypy due to `def __getattr__(name: str) -> t.Any:` in `__init__.py`\n\nit _might_ be better to guard that behind a `if not t.TYPE_CHECKING: ...` block such that mypy doesn't pick that up and lead to misleading results\n\nnot a big deal though and I see that the `__getattr__`  is already removed in mainline\n\nanother idea would be to use `@overload` on `__getattr__` such that it only allows the particular Literals? but it looks like mypy doesn't even support that so nevermind! https://github.com/python/mypy/issues/8203#issuecomment-1670344931\n\n\nEnvironment:\n\n- Python version: 3.13.1\n- Flask version: 3.1.0\n",
        "user": "asottile",
        "start_time": "2025-03-08T16:56:50Z",
        "end_time": "2025-03-29T22:28:33Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5700,
                "title": "better type checking during deprecation",
                "url": "https://github.com/pallets/flask/pull/5700",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "7d5d1874581209f66ad7bcdfb7f85b2b9a7ca471",
                "message": "better type checking during deprecation",
                "author": "David Lord",
                "date": "2025-03-29T22:23:34Z"
            }
        ],
        "affected_files": [
            "src/flask/__init__.py"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 1,
            "total_prs": 1
        }
    },
    {
        "id": 5689,
        "title": "Is flask still being maintained?",
        "body": "Is flask still being maintained, I see the git was updated 2 month back, can I still use flask for my new project?",
        "user": "ayushpythonista",
        "start_time": "2025-03-04T11:47:03Z",
        "end_time": "2025-03-04T12:07:01Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5689.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5688,
        "title": "Error using sample code in favicon documentation",
        "body": "The code sample gives the assert `view_func is not None, \"expected view func if endpoint is not provided.\"`.\n\nDocumentation in question: https://flask.palletsprojects.com/en/stable/patterns/favicon/\n\nSample code in question:\n```\napp.add_url_rule('/favicon.ico',\n                 redirect_to=url_for('static', filename='favicon.ico'))\n```",
        "user": "AluminumAngel",
        "start_time": "2025-03-02T06:04:51Z",
        "end_time": "2025-03-29T22:32:36Z",
        "state": "closed",
        "labels": [
            "docs"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5701,
                "title": "add endpoint name in favicon example",
                "url": "https://github.com/pallets/flask/pull/5701",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "c94d2a77db0102a7cf8ceec7804f366f180c373f",
                "message": "add endpoint name in favicon example",
                "author": "David Lord",
                "date": "2025-03-29T22:30:56Z"
            }
        ],
        "affected_files": [
            "docs/patterns/favicon.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 1,
            "total_prs": 1
        }
    },
    {
        "id": 5686,
        "title": "Inaccurate documentation for adding a favicon redirect",
        "body": "The code sample in the existing documentation on how to redirect a favicon request assumes that add_url_rule takes a parameter named redirect_to. It does not.\n\nDocumentation in question: https://flask.palletsprojects.com/en/stable/patterns/favicon/\n\nSample code in question:\n```\napp.add_url_rule('/favicon.ico',\n                 redirect_to=url_for('static', filename='favicon.ico'))\n```",
        "user": "AluminumAngel",
        "start_time": "2025-03-02T05:29:12Z",
        "end_time": "2025-03-02T05:32:32Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5687,
                "title": "Fix inaccurate documentation for adding a favicon redirect",
                "url": "https://github.com/pallets/flask/pull/5687",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "74c1dd808100b8e88d5c30fc2d369a15638fc4b9",
                "message": "Update favicon \n\nThe code sample in the existing documentation on how to redirect a favicon request assumes that add_url_rule takes a parameter named redirect_to. It does not.",
                "author": "Daniel Nelson",
                "date": "2025-03-02T05:37:08Z"
            }
        ],
        "affected_files": [
            "docs/patterns/favicon.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 1,
            "total_prs": 1
        }
    },
    {
        "id": 5679,
        "title": "How to solve",
        "body": "```python\nresponse = {\n        \"status\": \"ok\",\n        \"message\": \"Success\",\n        \"response\": url\n    }\n    return jsonify(response)\n```\n\nIn this getting output like this \n\n```json\n{\"message\": \"success\", \"response\": url, \"status\": \"old\"}\n```\n\nHow to solve that getting incorrect output\n\nI need this like\n\n```\n{\n        \"status\": \"ok\",\n        \"message\": \"Success\",\n        \"response\": url\n    }\n```\n\nHow to solve ",
        "user": "Tanjiroop",
        "start_time": "2025-02-18T09:21:49Z",
        "end_time": "2025-02-18T09:28:00Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5679.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5676,
        "title": "Admin endpoint seems to be reserved",
        "body": "```python\n@app.route(\"/admin/<password>/<int:page>\", methods=[\"GET\"])\ndef admin(password: str, page: int = 1) -> Any:\n    print(page)\n    files, total = [], 2\n    return render_template(\"admin.html\", files=files, password=password, total=total)\n```\n\nThis fails when page is 1,2,3 or 8.\n\nAt least. it might fail in more cases.\n\nIf page is 4 or 5, 9,  etc, it works.\n\nBy works I mean, it uses the actual argument instead of the default: 1\n\nI'm guessing the admin endpoint is being reserved in some way, but should it?\n\nIf I replace 'admin' to 'pok' for example:\n\n`@app.route(\"/pok/<password>/<int:page>\", methods=[\"GET\"])`\n\nThen it works as expected.\n\n\nEnvironment:\n\n- Python version: 3.13.1\n- Flask version: 3.1.0",
        "user": "madprops",
        "start_time": "2025-02-08T04:41:55Z",
        "end_time": "2025-02-08T05:02:48Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5676.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5673,
        "title": "Custom commands not listed",
        "body": "When I run the `flask` command by itself I get help output with all of my custom commands listed. But when I run `flask --help` I get the help output with only the built-in flask commands (`routes`, `run`, `shell`). I am using the `FLASK_APP` environment variable to load the app.\n\nI would think I should get the same help output (showing my custom commands) whether or not I add the `--help` parameter?\n\nEnvironment:\n\n- Python 3.12.2\n- Flask 3.1.0",
        "user": "dunkmann00",
        "start_time": "2025-01-28T06:57:24Z",
        "end_time": "2025-03-29T22:15:26Z",
        "state": "closed",
        "labels": [
            "cli"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5674,
                "title": "Handle help arg by itself the same as no args",
                "url": "https://github.com/pallets/flask/pull/5674",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "da600394865c06a4772c433c1a560453dcf4f868",
                "message": "Handle help arg by itself the same as no args\n\nWhen the 'flask' command is used with only the '--help' parameter, this\nchange will make sure to try and load the app before the help callback\nis run. This was previously only being done when the 'flask' command was\nused by itself. This meant when passing in '--help', any custom commands\nwere not getting shown in the help message. With this change, custom\ncommands will be included in the help message when running 'flask' on\nthe command line by itself or with the '--help' parameter.",
                "author": "George Waters",
                "date": "2025-01-30T03:22:52Z"
            }
        ],
        "affected_files": [
            "src/flask/cli.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 2,
            "total_prs": 1
        }
    },
    {
        "id": 5670,
        "title": "int route converters are actually uint, but not documented as such",
        "body": "In #2643, a user noted that flask routes with an `int` converter only accepts unsigned integers.\r\n\r\nI'll summarize a few different opinions and options in that thread:\r\n1. a user can create their own converter that accepts unsigned integers, or modifies the existing converter (but only on their codebase). An example code snippet was provided in the issue.\r\n2. The user's report could be treated as a bug in the `int` converter, so the fix would be to modify the flask `int` converter to accept the other ~50% of legitimate integers. Assumptions were made about which part of the integer space most people would use. Concerns were raised about how users may be relying on this bug, and that it should not be fixed for fear of breaking said users.\r\n3. The user's report could be treated as a bug in the documentation, so a presumed fix would be to amend [the documentation](https://flask.palletsprojects.com/en/stable/api/#url-route-registrations) which currently states \"The following converters are available: [...] `int`: accepts integers\"; it could be changed to \"`int`: accepts _unsigned_ integers\".\r\n\r\nMy expectation would have been that either option 2 or 3 would be selected, but instead it appears that the issue was locked to further comment and no further action was taken. So, the documentation is still at odds with the behavior of flask vs the math and computer science definition of integer. I'm not wedded to either solution, but would the pallets team be open to implementing a fix in either direction?\r\n\r\nThank you,\r\n-Andrew\r\n\r\n",
        "user": "widdowson",
        "start_time": "2025-01-13T04:57:35Z",
        "end_time": "2025-01-13T07:22:53Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5670.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5669,
        "title": "ok",
        "body": "<!--\r\nReplace this comment with a description of what the feature should do.\r\nInclude details such as links to relevant specs or previous discussions.\r\n-->\r\n\r\n<!--\r\nReplace this comment with an example of the problem which this feature\r\nwould resolve. Is this problem solvable without changes to Flask, such\r\nas by subclassing or using an extension?\r\n-->\r\n",
        "user": "gamestime102",
        "start_time": "2025-01-10T14:36:15Z",
        "end_time": "2025-01-10T14:48:44Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5669.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5667,
        "title": "Consider supporting HOT reload with `hmr`?",
        "body": "Hot Module Replacement has been existed in JavaScript ecosystem for a long time, but Python web applications are still using full reloads by default.\r\n\r\nTo solve this situation, I implemented the `hmr` package, which does the fine-grained dependency tracking, on-demand reloading jobs. Here is a demo of what the results look like:\r\n\r\nhttps://github.com/user-attachments/assets/7937d1c2-ed41-4f38-be18-9cc29b9961a1\r\n\r\nObviously the `a.py` runs everytime in `flask run --reload` but reloads only when needed in `hmr app.py`. But everything else works fine (at least for this small demo)\r\n\r\nYou may say that user should use lazy imports and cache expensive calculations themselves, but in fact not every function can be cached, and lazy imports may lead to ugly code style. This can be solved with on-demand hot reloading without overhead. So I believe this is the future.\r\n\r\nAlthough this is just a minimal demo, but I value hmr's potential in the Python ecosystem, and believe that with our efforts this is a reachable goal.\r\n\r\n> [!TIP]\r\n> You can try the example above [here](https://github.com/promplate/hmr/tree/readme/examples/flask) with `hmr app.py`\r\n\r\n---\r\n\r\nAbout `hmr`, you can refer to its [README](https://github.com/promplate/hmr) for details.\r\n",
        "user": "CNSeniorious000",
        "start_time": "2025-01-10T08:58:37Z",
        "end_time": "2025-01-10T09:02:03Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5667.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5666,
        "title": "intersphinx broken for flask.Flask.cli",
        "body": "https://flask.palletsprojects.com/en/stable/api/#flask.Flask.cli has a type of `Group`, but it doesn't link to further docs.",
        "user": "AstraLuma",
        "start_time": "2025-01-03T18:51:42Z",
        "end_time": "2025-01-08T21:04:29Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5666.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5662,
        "title": "Containerization",
        "body": "Hello  team I am planning to containerized the entire flask framework using docker so whenever user needs to work on the project they can able to run entire framework just by running docker container so can i work on this feature. ",
        "user": "vignesh-0512",
        "start_time": "2024-12-29T12:29:29Z",
        "end_time": "2024-12-29T13:19:44Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5662.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5661,
        "title": "Design Enhancement",
        "body": "Hello team, planning to develop flask documentation with web interface with great and clean UI, also trying to make the concept more simple and understandable can you assign me this task.",
        "user": "vignesh-0512",
        "start_time": "2024-12-28T15:14:44Z",
        "end_time": "2024-12-28T15:36:53Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5661.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5655,
        "title": "app.run(debug=True)，会导致flask_sqlalchemy错误!",
        "body": "开启debug模式后，debug=Ture的时候，flask_sqlalchemy的with self.app.app_context()会重复执行。\r\n例如我写入一条数据 {user:\"123\",name:\"youname\"}, 在debug模式下 with self.app.app_context() 会执行完写入完毕后，会重新执行一次，导致程序退出，提示重复写入！\r\n我以为是我代码问题，我检查了无数次，都无法找到我代码问题，最后关闭debug模式后，就可以正常使用。\r\n\r\n复现办法：\r\napp.py:\r\napp.run(debug=True)\r\n\r\nmodel.py：\r\npass\r\n\r\nuserdb.py:\r\n        with self.app.app_context():\r\n            new_user = userdbmodel(userdb)(user='11eee',\r\n                                           name=input(\"input\")\r\n                                           )\r\n            userdb.session.add(new_user)\r\n            userdb.session.commit()\r\n\r\n会出现两次input输入，之后会提示重复后程序停止。\r\n\r\n\r\n\r\n\r\n\r\n目前只要把app.run(debug=True)改为app.run(debug=False)，例如：\r\napp.py:\r\napp.run(debug=False)\r\n就只会执行一次，不会报错。",
        "user": "gitDebianD",
        "start_time": "2024-12-12T07:26:31Z",
        "end_time": "2024-12-12T15:52:07Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5655.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5654,
        "title": "Mypy error when accessing flask.request.json",
        "body": "I use mypy to validate my project, I upgraded from flask 2 to flask 3 and now I see plenty of errors when I try to access the json property or flask.request\r\n\r\nI just have a top level\r\n\r\nimport flask\r\n\r\nThen:\r\n\r\nj = flask.request.json  # \"Request\" has no attribute \"json\"\r\n\r\nMypy: \"Request\" has no attribute \"json\" [attr-defined]\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.13.0\r\n- Flask version: 3.1.0\r\n",
        "user": "skonstant",
        "start_time": "2024-12-11T16:15:26Z",
        "end_time": "2024-12-11T17:15:31Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5654.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5653,
        "title": "Flash message with Markup fails",
        "body": "Upgrading my platform from Python 3.8 + Flask 3.0.3 +  Flask-Session 0.8.0 with redis backend, to Python 3.11 + Flask 3.1.0 +  Flask-Session 0.8.0 with redis backend. Same user code.\r\n\r\nIssue: fancy flash message breaks on the new platform (work fine on the old platform).\r\n\r\nFlash message:\r\n`flash(Markup('press the play button <i class=\"bi-play-btn-fill black\"></i> below'), 'info')`\r\n\r\nError:\r\n```\r\n[2024-12-10 19:01:28,998] ERROR in base: Failed to serialize session data: Encoding objects of type Markup is unsupported\r\n[2024-12-10 19:01:28,998] ERROR in app: Exception on / [POST]\r\nTraceback (most recent call last):\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 1511, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 920, in full_dispatch_request\r\n    return self.finalize_request(rv)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 941, in finalize_request\r\n    response = self.process_response(response)\r\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 1322, in process_response\r\n    self.session_interface.save_session(self, ctx.session, response)\r\n  File \"/var/www/lib/python3.11/site-packages/flask_session/base.py\", line 305, in save_session\r\n    self._upsert_session(app.permanent_session_lifetime, session, store_id)\r\n  File \"/var/www/lib/python3.11/site-packages/flask_session/redis/redis.py\", line 78, in _upsert_session\r\n    serialized_session_data = self.serializer.encode(session)\r\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask_session/base.py\", line 132, in encode\r\n    return self.encoder.encode(dict(session))\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nTypeError: Encoding objects of type Markup is unsupported\r\n[2024-12-10 19:01:29,002] ERROR in base: Failed to serialize session data: Encoding objects of type Markup is unsupported\r\n[2024-12-10 19:01:29,002] ERROR in app: Request finalizing failed with an error while handling an error\r\nTraceback (most recent call last):\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 1511, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 920, in full_dispatch_request\r\n    return self.finalize_request(rv)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 941, in finalize_request\r\n    response = self.process_response(response)\r\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 1322, in process_response\r\n    self.session_interface.save_session(self, ctx.session, response)\r\n  File \"/var/www/lib/python3.11/site-packages/flask_session/base.py\", line 305, in save_session\r\n    self._upsert_session(app.permanent_session_lifetime, session, store_id)\r\n  File \"/var/www/lib/python3.11/site-packages/flask_session/redis/redis.py\", line 78, in _upsert_session\r\n    serialized_session_data = self.serializer.encode(session)\r\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask_session/base.py\", line 132, in encode\r\n    return self.encoder.encode(dict(session))\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nTypeError: Encoding objects of type Markup is unsupported\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 941, in finalize_request\r\n    response = self.process_response(response)\r\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask/app.py\", line 1322, in process_response\r\n    self.session_interface.save_session(self, ctx.session, response)\r\n  File \"/var/www/lib/python3.11/site-packages/flask_session/base.py\", line 305, in save_session\r\n    self._upsert_session(app.permanent_session_lifetime, session, store_id)\r\n  File \"/var/www/lib/python3.11/site-packages/flask_session/redis/redis.py\", line 78, in _upsert_session\r\n    serialized_session_data = self.serializer.encode(session)\r\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/var/www/lib/python3.11/site-packages/flask_session/base.py\", line 132, in encode\r\n    return self.encoder.encode(dict(session))\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nTypeError: Encoding objects of type Markup is unsupported\r\n```",
        "user": "jeroen-80",
        "start_time": "2024-12-10T18:08:02Z",
        "end_time": "2024-12-10T18:38:05Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5653.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5652,
        "title": "flask==2.2.4 incompatible with werkzeug==3.1.3",
        "body": "I use flask==2.2.4 for my project and when I install flask, it pulls **any** werkzeug>=2.2.2 (which is the default behaviour). After [werkzeug==3.1.3](https://pypi.org/project/Werkzeug/3.1.3/) got released on 8 Nov, 2024, flask pulls the latest version of it. With this new version of werkzeug, while executing unit tests, I get an error saying `module 'werkzeug' has no attribute '__version__'`\r\n\r\n**A small example to reproduce the issue:**\r\n(myenv) root@6426d8424cca:~# python3\r\nPython 3.9.16 (main, Sep  2 2024, 12:46:28) \r\n[GCC 10.2.1 20210110] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n **\">>> from flask import Flask\r\n \">>> app = Flask(__name__)\r\n \">>> my_test_client = app.test_client()\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/root/myenv/lib/python3.9/site-packages/flask/app.py\", line 1252, in test_client\r\n    return cls(  # type: ignore\r\n  File \"/root/myenv/lib/python3.9/site-packages/flask/testing.py\", line 116, in __init__\r\n    \"HTTP_USER_AGENT\": f\"werkzeug/{werkzeug.__version__}\",\r\n**AttributeError: module 'werkzeug' has no attribute '__version__'****\r\n\r\n\r\nI shouldn't be seeing any error like above.\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.9.16\r\n- Flask version: 2.2.4\r\n",
        "user": "ranaprathapthanneeru",
        "start_time": "2024-12-05T11:56:45Z",
        "end_time": "2024-12-05T14:50:24Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5652.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5646,
        "title": "Remove unnecessary whitespace in slice notation to align with PEP 8 and Black standards",
        "body": "File: flask/src/flask/cli.py\r\nLine: 701\r\n\r\nThe return statement in the _path_is_ancestor function can be updated to improve readability and align with PEP 8 and Black formatting standards for slice notation. Currently, there is unnecessary whitespace around the colon (:) in the slice, which is inconsistent with these guidelines.\r\n\r\nCurrent Code:\r\n```return os.path.join(path, other[len(path) :].lstrip(os.sep)) == other```\r\n\r\nSuggested Change:\r\nRemove the unnecessary whitespace around the colon (:) in the slice notation to improve readability:\r\n```return os.path.join(path, other[len(path):].lstrip(os.sep)) == other```\r\n\r\nThis change ensures compliance with PEP 8 and Black standards, contributing to cleaner and more consistent formatting across the codebase.",
        "user": "michaelwlin-osu",
        "start_time": "2024-11-20T04:56:02Z",
        "end_time": "2024-11-20T07:21:22Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5646.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5645,
        "title": "Type hint for FlaskCliRunner.invoke is not specific",
        "body": "The type hint of the return type of `FlaskCliRunner.invoke` ist `typing.Any` but should use `click.testing.Result`. This leads to missing auto completions in the IDE as well as errors from the type checker if not additional type narrowing is done.\r\n\r\nThe Problem is here: https://github.com/pallets/flask/blob/main/src/flask/testing.py#L276\r\n\r\nTo fix this `Result` must be imported from `click.testing` and used as a return type annotation.\r\n\r\nThe documentation already specifies `click.testing.Result` as return type.\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.12.2\r\n- Flask version: 3.1.0 but is also present in current main branch.\r\n",
        "user": "loewexy",
        "start_time": "2024-11-19T12:14:20Z",
        "end_time": "2024-11-24T01:53:05Z",
        "state": "closed",
        "labels": [
            "typing"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5647,
                "title": "fix type hint for `cli_runner.invoke`",
                "url": "https://github.com/pallets/flask/pull/5647",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "f84bc646bb27793e65ec8fc279387e7a5f607df2",
                "message": "Fix testing.invoke type hint. (#5645)",
                "author": "Stas Dzasokhov",
                "date": "2024-11-23T00:23:09Z",
                "files": [
                    "src/flask/testing.py"
                ]
            },
            {
                "sha": "54c3f87af9f6c0d6622cec2c3d9695b0229fb8fa",
                "message": "fix type hint for `cli_runner.invoke`",
                "author": "kurtatter",
                "date": "2024-11-23T00:23:09Z"
            },
            {
                "sha": "e128e06d3ea3a0c6136afee34e41c3a91f207293",
                "message": "Fix testing.invoke type hint. (#5645)",
                "author": "kurtatter",
                "date": "2024-11-23T00:23:09Z",
                "files": [
                    "src/flask/testing.py"
                ]
            },
            {
                "sha": "aa4af95cd4accb2ee030bc43ed9d59fd9e4dadad",
                "message": "Fix testing.invoke type hint. (#5645)",
                "author": "kurtatter",
                "date": "2024-11-23T00:23:09Z",
                "files": [
                    "src/flask/testing.py"
                ]
            }
        ],
        "affected_files": [
            "src/flask/testing.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 4,
            "total_files": 2,
            "total_prs": 1
        }
    },
    {
        "id": 5642,
        "title": "PROVIDE_AUTOMATIC_OPTIONS causes KeyError if not set",
        "body": "https://github.com/pallets/flask/blob/bc098406af9537aacc436cb2ea777fbc9ff4c5aa/src/flask/sansio/app.py#L641C12-L641C86\r\n\r\nSimply changing this to : `self.config.get(\"PROVIDE_AUTOMATIC_OPTIONS\", False)` should resolve the problem.\r\n\r\nThis change now released is causing upstream trouble in other packages such as Quart:\r\nhttps://github.com/pallets/quart/issues/371\r\n\r\n",
        "user": "develerltd",
        "start_time": "2024-11-14T12:01:51Z",
        "end_time": "2024-11-14T15:25:04Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5642.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5639,
        "title": "merge app and request contexts into a single context",
        "body": "Right now we have two separate contexts managed separately, the app and request contexts. This makes the implementation pretty complicated, as we need to maintain two context var stacks, and do a bunch of checks in the request context to make sure we're managing the correct app context. It makes an already confusing topic more complicated to explain: app context is active for requests and cli commands, don't push an app context before making a request, etc.\r\n\r\nI think merging the two contexts could be possible. The single context (`ExecutionContext`?) would have the `g`, `request`, and `session` attributes, but accessing `request` or `session` when not in a request would raise an error.",
        "user": "davidism",
        "start_time": "2024-11-13T16:28:05Z",
        "end_time": "2025-09-19T23:45:28Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5705,
                "title": "Merge app and request contexts into a single context (#5639)",
                "url": "https://github.com/pallets/flask/pull/5705",
                "state": "closed"
            },
            {
                "number": 5812,
                "title": "merge app and request context",
                "url": "https://github.com/pallets/flask/pull/5812",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "aa37c0a1457bf6dba636c94050f67e0496ca9e56",
                "message": "Merge app and request contexts into a single context (#5639)",
                "author": "ascender1729",
                "date": "2025-03-30T07:29:46Z",
                "files": [
                    "src/flask/app.py",
                    "src/flask/ctx.py",
                    "src/flask/globals.py"
                ]
            },
            {
                "sha": "21e094d696a9087f06b12384f7be7071131fefb5",
                "message": "[pre-commit.ci lite] apply automatic fixes",
                "author": "pre-commit-ci-lite[bot]",
                "date": "2025-03-30T07:33:45Z"
            },
            {
                "sha": "c2705ffd9ce1dc8476cb29eaf5ff5d4c719852d9",
                "message": "merge app and request context",
                "author": "David Lord",
                "date": "2025-09-12T21:52:03Z"
            }
        ],
        "affected_files": [
            "src/flask/globals.py",
            "src/flask/json/__init__.py",
            "docs/tutorial/tests.rst",
            "docs/extensiondev.rst",
            "docs/design.rst",
            "docs/tutorial/database.rst",
            "docs/reqcontext.rst",
            "CHANGES.rst",
            "src/flask/helpers.py",
            "docs/shell.rst",
            "src/flask/templating.py",
            "docs/patterns/sqlalchemy.rst",
            "src/flask/cli.py",
            "docs/appcontext.rst",
            "docs/quickstart.rst",
            "src/flask/sansio/scaffold.py",
            "docs/api.rst",
            "docs/testing.rst",
            "src/flask/app.py",
            "src/flask/ctx.py",
            "docs/index.rst",
            "src/flask/sansio/app.py",
            "docs/patterns/sqlite3.rst",
            "docs/patterns/streaming.rst",
            "docs/tutorial/blog.rst",
            "docs/tutorial/views.rst",
            "docs/lifecycle.rst",
            "src/flask/debughelpers.py",
            "docs/tutorial/templates.rst",
            "docs/signals.rst"
        ],
        "stats": {
            "total_commits": 3,
            "total_files": 30,
            "total_prs": 2
        }
    },
    {
        "id": 5636,
        "title": "configure and check `request.trusted_hosts`",
        "body": "If `request.trusted_hosts` is set, it will be checked when accessing `request.host`/`url`/etc. Add `TRUSTED_HOSTS` config, and check it during routing.",
        "user": "davidism",
        "start_time": "2024-11-13T01:49:21Z",
        "end_time": "2024-11-13T05:03:24Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5637,
                "title": "configure and check `request.trusted_hosts`",
                "url": "https://github.com/pallets/flask/pull/5637",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "4f7156f2c3271613b34d04040b502b9d7ae35eb9",
                "message": "configure and check trusted_hosts",
                "author": "David Lord",
                "date": "2024-11-13T04:32:53Z"
            }
        ],
        "affected_files": [
            "docs/config.rst",
            "src/flask/app.py",
            "CHANGES.rst",
            "tests/test_request.py"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 4,
            "total_prs": 1
        }
    },
    {
        "id": 5628,
        "title": "dotenv file arg should take precedence over default dotenv files",
        "body": "As pointed out in #5532, `-e file` is loaded after the default `.env` and `.flaskenv` files, which means it won't override env vars that are set by the defaults. It will be a little tricky to track during CLI startup, but I think it should be possible to fix this so that precedence is: `os.environ` > `-e path` > `.env` > `.flaskenv`.",
        "user": "davidism",
        "start_time": "2024-11-06T17:34:15Z",
        "end_time": "2024-11-07T19:56:28Z",
        "state": "closed",
        "labels": [
            "cli"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5532,
                "title": "Provide more clear flask -e, --env-file flag desription",
                "url": "https://github.com/pallets/flask/pull/5532",
                "state": "closed"
            },
            {
                "number": 5629,
                "title": "give priority to '-e/--env-file' option over default files (#5628)",
                "url": "https://github.com/pallets/flask/pull/5629",
                "state": "closed"
            },
            {
                "number": 5630,
                "title": "update env file precedence",
                "url": "https://github.com/pallets/flask/pull/5630",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "2ed9dd0aecebc0204554ec5edcf932a3120748f4",
                "message": "Provide more clear flask -e, --env-file flag desription",
                "author": "differencialx",
                "date": "2024-07-19T00:11:37Z"
            },
            {
                "sha": "f60d6c90429289fddcc93b8f215f9ebf16d2e1cd",
                "message": "give priority to '-e/--env-file' option over default files (#5628)\n\nSigned-off-by: Jalaj <96870071+jalaj711@users.noreply.github.com>",
                "author": "Jalaj",
                "date": "2024-11-07T17:37:51Z",
                "files": [
                    "CHANGES.rst",
                    "src/flask/cli.py",
                    "tests/test_apps/.customenv",
                    "tests/test_cli.py"
                ]
            },
            {
                "sha": "d4b54f9c3ed210820cd3b9382c645c6278cf4518",
                "message": "use override feature of `dotenv` instead of deferring loading of default files\n\nIn the previous commit, #5628 was fixed by creating the context\nbefore loading the default environment variables. However, as\npointed out by @davidism, this can cause issues with the load\npipeline. Thus, this commit reverses that approach and uses the\n`override` argument provided by `python-dotenv` to give priority\nto custom file over default file.\n\nSigned-off-by: Jalaj <96870071+jalaj711@users.noreply.github.com>",
                "author": "Jalaj",
                "date": "2024-11-07T18:03:45Z"
            },
            {
                "sha": "2c3160304278d323da8485057770926d1b582579",
                "message": "update env file precedence",
                "author": "David Lord",
                "date": "2024-11-07T19:27:51Z"
            }
        ],
        "affected_files": [
            "tests/test_cli.py",
            "tests/test_apps/.customenv",
            "src/flask/cli.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 4,
            "total_files": 4,
            "total_prs": 3
        }
    },
    {
        "id": 5625,
        "title": "extend config for Request form memory settings",
        "body": "Werkzeug provides three settings on `Request` to control form parsing: `max_content_length`, `max_form_memory_size`, and `max_form_parts`. Only `max_content_length` is exposed as a Flask config right now, and the way it's implemented means it can only be set for the whole application, not per-request. Fix all that. Document these in the security page as well as the config page.",
        "user": "davidism",
        "start_time": "2024-10-31T20:19:45Z",
        "end_time": "2024-11-01T20:21:37Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5626,
                "title": "add config and docs for limits",
                "url": "https://github.com/pallets/flask/pull/5626",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "c7a53888a1a514619b0611fd8b7928592f4ed612",
                "message": "add config and docs for limits",
                "author": "David Lord",
                "date": "2024-11-01T20:13:05Z"
            }
        ],
        "affected_files": [
            "CHANGES.rst",
            "tests/test_request.py",
            "tests/test_basic.py",
            "docs/web-security.rst",
            "src/flask/wrappers.py",
            "src/flask/app.py",
            "docs/config.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 7,
            "total_prs": 1
        }
    },
    {
        "id": 5621,
        "title": "Rotating secret keys",
        "body": "I'd like to have a couple of secret keys available, like so\r\n```\r\napp.secret_keys = [\r\n   'key-1',\r\n   'key-2',\r\n]\r\n```\r\nTo allow them to rotate.\r\n\r\nI've seen this issue which seems to have auto-closed\r\nhttps://github.com/pallets/flask/issues/1574\r\n\r\nIt seems like itsdangerous now supports this\r\nhttps://github.com/pallets/itsdangerous/pull/141\r\n\r\nThis would allow secret keys to be rotated regularly without sessions being invalidated.\r\n",
        "user": "CanaryWharf",
        "start_time": "2024-10-25T13:50:09Z",
        "end_time": "2024-11-08T16:16:05Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5632,
                "title": "enable secret key rotation",
                "url": "https://github.com/pallets/flask/pull/5632",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "e13373f838ab34027c5a80e16a6cb8262d41eab7",
                "message": "enable secret key rotation",
                "author": "David Lord",
                "date": "2024-11-08T16:09:01Z"
            }
        ],
        "affected_files": [
            "CHANGES.rst",
            "tests/test_basic.py",
            "tests/type_check/typing_app_decorators.py",
            "src/flask/app.py",
            "tests/type_check/typing_error_handler.py",
            "docs/config.rst",
            "tests/type_check/typing_route.py",
            "pyproject.toml",
            "src/flask/sessions.py"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 9,
            "total_prs": 1
        }
    },
    {
        "id": 5605,
        "title": "Error: No such command 'db'.",
        "body": "\r\n[OJ.zip](https://github.com/user-attachments/files/17025798/OJ.zip)\r\n```\r\n(onlinejudge_env) kimi@KimideMacBook-Air OJ % flask db init\r\n\r\nError: While importing 'run', an ImportError was raised:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/kimi/OJ/onlinejudge_env/lib/python3.9/site-packages/flask/cli.py\", line 218, in locate_app\r\n    __import__(module_name)\r\n  File \"/Users/kimi/OJ/run.py\", line 3, in <module>\r\n    app = create_app()\r\n  File \"/Users/kimi/OJ/app/__init__.py\", line 25, in create_app\r\n    from app.auth import auth as auth_blueprint\r\n  File \"/Users/kimi/OJ/app/auth.py\", line 6, in <module>\r\n    from werkzeug.urls import url_parse\r\nImportError: cannot import name 'url_parse' from 'werkzeug.urls' (/Users/kimi/OJ/onlinejudge_env/lib/python3.9/site-packages/werkzeug/urls.py)\r\n\r\n\r\nUsage: flask [OPTIONS] COMMAND [ARGS]...\r\nTry 'flask --help' for help.\r\n\r\nError: No such command 'db'.\r\n(onlinejudge_env) kimi@KimideMacBook-Air OJ % \r\n```",
        "user": "ghost",
        "start_time": "2024-09-17T09:17:38Z",
        "end_time": "2024-09-17T14:01:20Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5605.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5598,
        "title": "Allow choice of reloader type",
        "body": "I know it was closed in #5007, but would it be possible to reconsider this? I'm having a lot of trouble with `watchdog` despite following all the fixes proposed  such as #2603. The reloader constantly detects spurious file changes, whereas I've never experienced such issues with `stat`. If you really dislike the idea of a new flag, maybe an environment variable would be an option?\r\n\r\nThanks a lot for the work on this awesome package!",
        "user": "oelhammouchi",
        "start_time": "2024-08-31T06:26:15Z",
        "end_time": "2024-09-01T19:11:29Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5598.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5557,
        "title": "`Config` `type: ignore` causing downstream error reports",
        "body": "The `# type: ignore` in the code here https://github.com/pallets/flask/blob/8a6cdf1e2a5efa81c30f6166602064ceefb0a35b/src/flask/config.py#L50\r\nis causing type errors to be reported in user code with pyright strict settings.\r\n\r\n```python\r\nfrom flask import Flask\r\n\r\n\r\nFlask(\"x\").config.update({\"A\": \"3\"})  # 'Type of \"update\" is partially unknown - reportUnknownMemberType'\r\n```\r\n\r\nBased on other typing in the same class, it looks like it could be:\r\n```python\r\nclass Config(dict[str, t.Any]):\r\n```\r\n\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.12\r\n- Flask version: 3.0.3\r\n",
        "user": "beauxq",
        "start_time": "2024-08-21T23:08:00Z",
        "end_time": "2024-08-22T00:09:57Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5557.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5556,
        "title": "Test failures in tutorial with python3.12",
        "body": "The tests runned with `pytest` works with python3.11 and not in 3.12:\r\n\r\nHow to reproduce:\r\n```\r\ngit clone git@github.com:pallets/flask.git\r\ncd flask/examples/tutorial\r\npython3.11 -m venv venv3.11\r\npython3.12 -m venv venv3.12\r\n# install dependencies\r\n# setup db\r\n```\r\nIn both cases, the webservice runs properly with `./venv3.1x/bin/flask --app flaskr run --debug`.\r\n\r\nHowever, running the tests show different results. In `venv3.11`, the 24 tests are green. In `venv3.12` virtualenv, there is 6 failures (and 18 green). The failures are due to a `DeprecationWarning` which becomes an error:\r\n```\r\nDeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes\r\n```\r\n\r\nThe full output is provided at the end of the bug report.\r\n\r\nThe `DeprecationWarning` is documented in the [3.12 release](https://docs.python.org/3/whatsnew/3.12.html): '[default adapters and converters](https://docs.python.org/3/library/sqlite3.html#sqlite3-default-converters) are now deprecated. Instead, use the [Adapter and converter recipes](https://docs.python.org/3/library/sqlite3.html#sqlite3-adapter-converter-recipes) and tailor them to your needs.' Copy-pasting blindly the recipes in `tests/conftest.py`, `flaskr/__init__.py` and `flaskr/db.py` does not fix the errors.\r\n\r\nThe errors can be fixed by adding thoses lines in conftest.py:\r\n```python\r\ndef convert_timestamp(val):\r\n    \"\"\"Convert Unix epoch timestamp to datetime.datetime object.\"\"\"\r\n    return datetime.datetime.strptime(val.decode(\"utf-8\"), \"%Y-%m-%d %H:%M:%S\").replace(tzinfo=datetime.timezone.utc)\r\n\r\nsqlite3.register_converter(\"timestamp\", convert_timestamp)\r\n```\r\n\r\nIt's probably not the best fix but it's a start.\r\n\r\n\r\nPytest output:\r\n\r\n```\r\n(venv3.12) $ ./venv3.12/bin/pytest\r\n========================================= test session starts ==========================================\r\nplatform linux -- Python 3.12.4, pytest-8.3.2, pluggy-1.5.0\r\nrootdir: /home/stephane/src/flasktuto/flask/examples/tutorial\r\nconfigfile: pyproject.toml\r\ntestpaths: tests\r\ncollected 24 items                                                                                     \r\n\r\ntests/test_auth.py ....F...                                                                      [ 33%]\r\ntests/test_blog.py F...F...F.FF                                                                  [ 83%]\r\ntests/test_db.py ..                                                                              [ 91%]\r\ntests/test_factory.py ..                                                                         [100%]\r\n\r\n=============================================== FAILURES ===============================================\r\n______________________________________________ test_login ______________________________________________\r\n\r\nclient = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297abc6900>\r\n\r\n    def test_login(client, auth):\r\n        # test that viewing the page renders without template errors\r\n        assert client.get(\"/auth/login\").status_code == 200\r\n    \r\n        # test that successful login redirects to the index page\r\n        response = auth.login()\r\n        assert response.headers[\"Location\"] == \"/\"\r\n    \r\n        # login request set the user_id in the session\r\n        # check that the user is loaded from the session\r\n        with client:\r\n>           client.get(\"/\")\r\n\r\ntests/test_auth.py:50: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1162: in get\r\n    return self.open(*args, **kw)\r\nvenv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open\r\n    response = super().open(\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open\r\n    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app\r\n    rv = run_wsgi_app(self.application, environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app\r\n    app_rv = app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__\r\n    return self.wsgi_app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app\r\n    response = self.handle_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app\r\n    response = self.full_dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request\r\n    rv = self.dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request\r\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\r\nflaskr/blog.py:24: in index\r\n    ).fetchall()\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nval = b'2018-01-01 00:00:00'\r\n\r\n    def convert_timestamp(val):\r\n>       warn(msg.format(what=\"timestamp converter\"), DeprecationWarning, stacklevel=2)\r\nE       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes\r\n\r\n/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning\r\n______________________________________________ test_index ______________________________________________\r\n\r\nclient = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297ad26390>\r\n\r\n    def test_index(client, auth):\r\n>       response = client.get(\"/\")\r\n\r\ntests/test_blog.py:7: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1162: in get\r\n    return self.open(*args, **kw)\r\nvenv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open\r\n    response = super().open(\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open\r\n    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app\r\n    rv = run_wsgi_app(self.application, environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app\r\n    app_rv = app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__\r\n    return self.wsgi_app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app\r\n    response = self.handle_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app\r\n    response = self.full_dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request\r\n    rv = self.dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request\r\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\r\nflaskr/blog.py:24: in index\r\n    ).fetchall()\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nval = b'2018-01-01 00:00:00'\r\n\r\n    def convert_timestamp(val):\r\n>       warn(msg.format(what=\"timestamp converter\"), DeprecationWarning, stacklevel=2)\r\nE       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes\r\n\r\n/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning\r\n_________________________________________ test_author_required _________________________________________\r\n\r\napp = <Flask 'flaskr'>, client = <FlaskClient <Flask 'flaskr'>>\r\nauth = <conftest.AuthActions object at 0x7f297ad3e210>\r\n\r\n    def test_author_required(app, client, auth):\r\n        # change the post author to another user\r\n        with app.app_context():\r\n            db = get_db()\r\n            db.execute(\"UPDATE post SET author_id = 2 WHERE id = 1\")\r\n            db.commit()\r\n    \r\n        auth.login()\r\n        # current user can't modify other user's post\r\n>       assert client.post(\"/1/update\").status_code == 403\r\n\r\ntests/test_blog.py:34: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1167: in post\r\n    return self.open(*args, **kw)\r\nvenv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open\r\n    response = super().open(\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open\r\n    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app\r\n    rv = run_wsgi_app(self.application, environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app\r\n    app_rv = app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__\r\n    return self.wsgi_app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app\r\n    response = self.handle_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app\r\n    response = self.full_dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request\r\n    rv = self.dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request\r\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\r\nflaskr/auth.py:27: in wrapped_view\r\n    return view(**kwargs)\r\nflaskr/blog.py:90: in update\r\n    post = get_post(id)\r\nflaskr/blog.py:48: in get_post\r\n    .fetchone()\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nval = b'2018-01-01 00:00:00'\r\n\r\n    def convert_timestamp(val):\r\n>       warn(msg.format(what=\"timestamp converter\"), DeprecationWarning, stacklevel=2)\r\nE       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes\r\n\r\n/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning\r\n_____________________________________________ test_update ______________________________________________\r\n\r\nclient = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297abc7920>\r\napp = <Flask 'flaskr'>\r\n\r\n    def test_update(client, auth, app):\r\n        auth.login()\r\n>       assert client.get(\"/1/update\").status_code == 200\r\n\r\ntests/test_blog.py:59: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1162: in get\r\n    return self.open(*args, **kw)\r\nvenv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open\r\n    response = super().open(\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open\r\n    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app\r\n    rv = run_wsgi_app(self.application, environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app\r\n    app_rv = app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__\r\n    return self.wsgi_app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app\r\n    response = self.handle_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app\r\n    response = self.full_dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request\r\n    rv = self.dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request\r\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\r\nflaskr/auth.py:27: in wrapped_view\r\n    return view(**kwargs)\r\nflaskr/blog.py:90: in update\r\n    post = get_post(id)\r\nflaskr/blog.py:48: in get_post\r\n    .fetchone()\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nval = b'2018-01-01 00:00:00'\r\n\r\n    def convert_timestamp(val):\r\n>       warn(msg.format(what=\"timestamp converter\"), DeprecationWarning, stacklevel=2)\r\nE       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes\r\n\r\n/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning\r\n________________________________ test_create_update_validate[/1/update] ________________________________\r\n\r\nclient = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297ace5160>\r\npath = '/1/update'\r\n\r\n    @pytest.mark.parametrize(\"path\", (\"/create\", \"/1/update\"))\r\n    def test_create_update_validate(client, auth, path):\r\n        auth.login()\r\n>       response = client.post(path, data={\"title\": \"\", \"body\": \"\"})\r\n\r\ntests/test_blog.py:71: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1167: in post\r\n    return self.open(*args, **kw)\r\nvenv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open\r\n    response = super().open(\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open\r\n    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app\r\n    rv = run_wsgi_app(self.application, environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app\r\n    app_rv = app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__\r\n    return self.wsgi_app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app\r\n    response = self.handle_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app\r\n    response = self.full_dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request\r\n    rv = self.dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request\r\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\r\nflaskr/auth.py:27: in wrapped_view\r\n    return view(**kwargs)\r\nflaskr/blog.py:90: in update\r\n    post = get_post(id)\r\nflaskr/blog.py:48: in get_post\r\n    .fetchone()\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nval = b'2018-01-01 00:00:00'\r\n\r\n    def convert_timestamp(val):\r\n>       warn(msg.format(what=\"timestamp converter\"), DeprecationWarning, stacklevel=2)\r\nE       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes\r\n\r\n/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning\r\n_____________________________________________ test_delete ______________________________________________\r\n\r\nclient = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297ada5610>\r\napp = <Flask 'flaskr'>\r\n\r\n    def test_delete(client, auth, app):\r\n        auth.login()\r\n>       response = client.post(\"/1/delete\")\r\n\r\ntests/test_blog.py:77: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1167: in post\r\n    return self.open(*args, **kw)\r\nvenv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open\r\n    response = super().open(\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open\r\n    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app\r\n    rv = run_wsgi_app(self.application, environ, buffered=buffered)\r\nvenv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app\r\n    app_rv = app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__\r\n    return self.wsgi_app(environ, start_response)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app\r\n    response = self.handle_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app\r\n    response = self.full_dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request\r\n    rv = self.dispatch_request()\r\nvenv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request\r\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\r\nflaskr/auth.py:27: in wrapped_view\r\n    return view(**kwargs)\r\nflaskr/blog.py:121: in delete\r\n    get_post(id)\r\nflaskr/blog.py:48: in get_post\r\n    .fetchone()\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nval = b'2018-01-01 00:00:00'\r\n\r\n    def convert_timestamp(val):\r\n>       warn(msg.format(what=\"timestamp converter\"), DeprecationWarning, stacklevel=2)\r\nE       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes\r\n\r\n/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning\r\n======================================= short test summary info ========================================\r\nFAILED tests/test_auth.py::test_login - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...\r\nFAILED tests/test_blog.py::test_index - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...\r\nFAILED tests/test_blog.py::test_author_required - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...\r\nFAILED tests/test_blog.py::test_update - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...\r\nFAILED tests/test_blog.py::test_create_update_validate[/1/update] - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...\r\nFAILED tests/test_blog.py::test_delete - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...\r\n===================================== 6 failed, 18 passed in 8.05s =====================================\r\n\r\n``\r\n\r\n",
        "user": "sblondon",
        "start_time": "2024-08-21T16:38:58Z",
        "end_time": "2024-11-02T01:07:02Z",
        "state": "closed",
        "labels": [
            "docs"
        ],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5627,
                "title": "fix example and tutorial compatibility and update metadata",
                "url": "https://github.com/pallets/flask/pull/5627",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "df201ed152b61c439ea1ace179f35b424594ba6c",
                "message": "fix js example test",
                "author": "David Lord",
                "date": "2024-11-01T23:44:17Z"
            },
            {
                "sha": "8aa161a43731795841fa2678d3dff0559cee527e",
                "message": "add sqlite datetime converter",
                "author": "David Lord",
                "date": "2024-11-02T00:18:52Z"
            },
            {
                "sha": "a9b99b3489cc24b5bed99fbadbd91f598a5a1420",
                "message": "update example project metadata",
                "author": "David Lord",
                "date": "2024-11-02T01:00:39Z"
            }
        ],
        "affected_files": [
            "examples/javascript/pyproject.toml",
            "docs/tutorial/database.rst",
            "examples/tutorial/LICENSE.txt",
            "examples/tutorial/pyproject.toml",
            "examples/tutorial/flaskr/db.py",
            "examples/javascript/LICENSE.txt",
            "examples/celery/pyproject.toml",
            "examples/javascript/tests/test_js_example.py"
        ],
        "stats": {
            "total_commits": 3,
            "total_files": 8,
            "total_prs": 1
        }
    },
    {
        "id": 5554,
        "title": "test_helpers.py.test_open_resource_with_encoding function attribute error",
        "body": "the function test_open_resource_with_encoding, sends encoding arguemnt to app.open_resource() function. the open_resource function doesnt has any enoding parameter in it's signature.\r\n\r\n- Python version: 3.11.5\r\n\r\n- Flask version: current\r\n",
        "user": "40gilad",
        "start_time": "2024-08-20T10:32:55Z",
        "end_time": "2024-08-20T14:23:33Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5554.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5553,
        "title": "Revisit SERVER_NAME's impact on routing and external URL generation",
        "body": "#998 was a discussion regarding the impact the `SERVER_NAME` setting has on an application.  IMO, there was consensus in that issue, including by @mitsuhiko, that `SERVER_NAME` being used both in routing and in URL generation was problematic.  \r\n\r\nThat issue was closed by https://github.com/pallets/flask/pull/2635, which made a change regarding subdomain matching.  However, IMO, it did not address the fundamental problem of `SERVER_NAME` impacting two disparate mechanisms in Flask.\r\n\r\nI found two additional issues since #998 that have attempted to point out the problem with `SERVER_NAME`: #2813, #3465\r\n\r\nIn #2813, a minimal, complete, and verifiable example was requested and I have therefore prepared an [example gist that demonstrates the problem](https://gist.github.com/rsyring/c50a500a5d35787ef45c1ff1e78d8898).\r\n\r\nThe gist's third \"currently impossible\" test demonstrates that it's currently impossible to:\r\n\r\n* Set `SERVER_NAME` so external URL generation works outside a request context with only an app context; and\r\n* Have the app respond properly to multiple host names. \r\n\r\nMy particular use case currently is that I need `SERVER_NAME` set so external URLs will be created accurately in distributed tasks where no web request is present.  Additionally, I need the app to respond to multiple host names 1) the canonical URL the public uses; and 2) the IP address based URL our load balancer uses for health checks.\r\n\r\nIMO, `SERVER_NAME` should be deprecated and two new settings should be created.  One which affects external URL generation and a second that affects routing resolution.\r\n\r\nThe setting for the URL generation could be `CANONICAL_URL` and, because its a URL, it could eliminate the need for `url_for()`'s `_scheme` arg.\r\n\r\nThanks for your consideration.\r\n\r\n- Python version: 3.12\r\n- Flask version: 3.0.3\r\n",
        "user": "rsyring",
        "start_time": "2024-08-15T06:31:40Z",
        "end_time": "2024-11-12T18:13:40Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5634,
                "title": "setting `SERVER_NAME` does not restrict routing for both `subdomain_matching` and `host_matching`",
                "url": "https://github.com/pallets/flask/pull/5634",
                "state": "closed"
            },
            {
                "number": 1040,
                "title": "Fix subdomain issue with Flask 3.1",
                "url": "https://github.com/pallets-eco/flask-security/pull/1040",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "4995a775df21a206b529403bc30d71795a994fd4",
                "message": "fix subdomain_matching=False behavior",
                "author": "David Lord",
                "date": "2024-11-11T04:13:05Z"
            },
            {
                "sha": "c6d2b1938f83de2f480d14d221932635aab61b65",
                "message": "",
                "author": "",
                "date": "",
                "files": []
            },
            {
                "sha": "7f3977d3557498b9e94333473e5d186b303ba05c",
                "message": "",
                "author": "",
                "date": "",
                "files": []
            }
        ],
        "affected_files": [
            "CHANGES.rst",
            "tests/test_basic.py",
            "src/flask/app.py",
            "docs/config.rst",
            "tests/test_blueprints.py",
            ".pre-commit-config.yaml"
        ],
        "stats": {
            "total_commits": 3,
            "total_files": 6,
            "total_prs": 2
        }
    },
    {
        "id": 5549,
        "title": "Pyright Type Errors",
        "body": "We have a number of various Pyright typing errors.\r\n\r\nEnvironment:\r\n\r\n- Python version: `3.12`\r\n- Flask version: `3.1.0`\r\n",
        "user": "brendon-codes",
        "start_time": "2024-08-07T00:56:36Z",
        "end_time": "2024-10-24T21:55:10Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5550,
                "title": "Pyright types fixes",
                "url": "https://github.com/pallets/flask/pull/5550",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "eeae10c14225bd33cdec4d8bcebd0ebe162e8d4d",
                "message": "Fixes Pyright type errors",
                "author": "bre-17387639",
                "date": "2024-08-06T22:46:15Z"
            }
        ],
        "affected_files": [
            "src/flask/helpers.py",
            "CHANGES.rst",
            "src/flask/wrappers.py",
            "src/flask/app.py",
            "src/flask/views.py",
            "src/flask/blueprints.py",
            "src/flask/cli.py",
            "src/flask/testing.py"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 8,
            "total_prs": 1
        }
    },
    {
        "id": 5547,
        "title": "Pyright type errors: `src/flask/helpers.py`",
        "body": "Pyright reports type errors for `src/flask/helpers.py`:\r\n\r\n```\r\nflask/src/flask/helpers.py\r\n  flask/src/flask/helpers.py:590:27 - error: Cannot access attribute \"get_filename\" for class \"Loader\"\r\n    Attribute \"get_filename\" is unknown (reportAttributeAccessIssue)\r\n```\r\n\r\nCommand which was run:\r\n\r\n```shell\r\n.venv/bin/pyright --pythonpath .venv/bin/python3 --project pyproject.toml\r\n```\r\n\r\nEnvironment:\r\n\r\n- Python version: `3.12`\r\n- Flask version: `3.1.0`\r\n",
        "user": "brendon-codes",
        "start_time": "2024-08-07T00:02:58Z",
        "end_time": "2024-08-07T00:30:20Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5548,
                "title": "Fixes Pyright type errors for `src/flask/helpers.py`",
                "url": "https://github.com/pallets/flask/pull/5548",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "b156cd2d5e830c7877589f710540467d77d8c90c",
                "message": "Fixes Pyright type errors for `src/flask/helpers.py`",
                "author": "bre-17387639",
                "date": "2024-08-07T00:03:28Z"
            }
        ],
        "affected_files": [
            "src/flask/helpers.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 2,
            "total_prs": 1
        }
    },
    {
        "id": 5545,
        "title": "Pyright type errors: `src/flask/blueprint.py`",
        "body": "Pyright reports type errors for `src/flask/blueprint.py`:\r\n\r\n```\r\nflask/src/flask/blueprints.py\r\n  flask/src/flask/blueprints.py:126:20 - error: Expression of type \"BufferedReader\" is incompatible with return type \"IO[AnyStr@open_resource]\"\r\n    \"BufferedReader\" is incompatible with \"IO[AnyStr@open_resource]\"\r\n      Type parameter \"AnyStr@IO\" is invariant, but \"bytes\" is not the same as \"AnyStr@open_resource\" (reportReturnType)\r\n```\r\n\r\nCommand which was run:\r\n\r\n```shell\r\n.venv/bin/pyright --pythonpath .venv/bin/python3 --project pyproject.toml\r\n```\r\n\r\nEnvironment:\r\n\r\n- Python version: `3.12`\r\n- Flask version: `3.1.0`\r\n",
        "user": "brendon-codes",
        "start_time": "2024-08-06T23:17:47Z",
        "end_time": "2024-08-07T00:30:10Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5546,
                "title": "Fixes Pyright type errors for `src/flask/blueprint.py`",
                "url": "https://github.com/pallets/flask/pull/5546",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "06b3125207877a94f98eed8b2401f60c7ece48e4",
                "message": "Fixes Pyright type errors for `src/flask/blueprint.py`",
                "author": "bre-17387639",
                "date": "2024-08-06T23:18:34Z"
            }
        ],
        "affected_files": [
            "src/flask/blueprints.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 2,
            "total_prs": 1
        }
    },
    {
        "id": 5543,
        "title": "Pyright type errors: `src/flask/app.py`",
        "body": "Pyright reports type errors for `src/flask/app.py`:\r\n\r\n```\r\nflask/src/flask/app.py\r\n  flask/src/flask/app.py:352:20 - error: Expression of type \"BufferedReader\" is incompatible with return type \"IO[AnyStr@open_resource]\"\r\n    \"BufferedReader\" is incompatible with \"IO[AnyStr@open_resource]\"\r\n      Type parameter \"AnyStr@IO\" is invariant, but \"bytes\" is not the same as \"AnyStr@open_resource\" (reportReturnType)\r\n  flask/src/flask/app.py:1178:21 - error: Expression with type \"Tuple[ResponseValue, HeadersValue] | Tuple[ResponseValue, int] | Tuple[ResponseValue, int, HeadersValue]\" cannot be assigned to target tuple\r\n    Type \"Tuple[ResponseValue, int, HeadersValue]\" is incompatible with target tuple\r\n      Tuple size mismatch; expected 2 but received 3 (reportAssignmentType)\r\n  flask/src/flask/app.py:1205:28 - error: Argument of type \"HeadersValue | int | None\" cannot be assigned to parameter \"status\" of type \"int | str | HTTPStatus | None\" in function \"__init__\" (reportArgumentType)\r\n  flask/src/flask/app.py:1240:29 - error: Cannot assign to attribute \"status\" for class \"Response\" (reportAttributeAccessIssue)\r\n  flask/src/flask/app.py:1242:34 - error: Cannot assign to attribute \"status_code\" for class \"Response\"\r\n    Type \"HeadersValue | int\" is incompatible with type \"int\"\r\n      \"Mapping[str, HeaderValue]\" is incompatible with \"int\" (reportAttributeAccessIssue)\r\n```\r\n\r\nCommand which was run:\r\n\r\n```shell\r\nsource .venv/bin/activate\r\npyright\r\n```\r\n\r\nEnvironment:\r\n\r\n- Python version: `3.12`\r\n- Flask version: `3.1.0`\r\n",
        "user": "brendon-codes",
        "start_time": "2024-08-06T22:52:48Z",
        "end_time": "2024-08-07T00:29:26Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5544,
                "title": "Fixes Pyright type errors for `src/flask/app.py`",
                "url": "https://github.com/pallets/flask/pull/5544",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "adbc23dcb8f811f3d9866303a6202ab5534c2bcd",
                "message": "Fixes Pyright type errors for `src/flask/app.py`",
                "author": "bre-17387639",
                "date": "2024-08-06T22:46:15Z"
            }
        ],
        "affected_files": [
            "src/flask/app.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 2,
            "total_prs": 1
        }
    },
    {
        "id": 5537,
        "title": "`pyright` type checking seems to be unused. `mypy` still being used.",
        "body": "We added `pyright` in 3.0.3 (see: https://github.com/pallets/flask/pull/5457), but `mypy` is still being used for type checking https://github.com/pallets/flask/blob/main/tox.ini#L29-L32, and `pyright` is not.\r\n\r\nIf this was an intentional change of type checkers, then would expect that `mypy` be completely removed, and `pyright` be the command run in `tox typing`.\r\n\r\nIt should be noted, however, that running `pyright` yields 90 errors (71 tests/19 src). Is there an upgrade path or was this an oversight?\r\n\r\nEnvironment:\r\n\r\n- Python version:\r\n- 3.12\r\n- Flask version:\r\n- 3.0.3\r\n",
        "user": "pygeek",
        "start_time": "2024-07-31T04:29:38Z",
        "end_time": "2024-10-24T21:55:35Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5552,
                "title": "git add tox.ini requirements/typing.txt",
                "url": "https://github.com/pallets/flask/pull/5552",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "e1b1228a7b527a11b52487342780776615361df6",
                "message": "git add tox.ini requirements/typing.txt\ngit commit -m \"Replace mypy with pyright in tox.ini for consistent type checking\"",
                "author": "HanaAlizai",
                "date": "2024-08-10T00:54:02Z"
            }
        ],
        "affected_files": [
            "tox.ini"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 1,
            "total_prs": 1
        }
    },
    {
        "id": 5530,
        "title": "Encountering Jinja2 SyntaxError after adding another css file",
        "body": "I've been encountering this confusing error; which is Jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'string'.\r\nThis only happened after I added another css file to my html script. But previously, it worked fine. \r\n\r\nHere are the previous errors i've encountered regarding this issue:\r\n\r\n```\r\n<link rel=\"icon\" href=\"{{ url_for('static', filename='images/favicon.png') }}\">\r\njinja2.exceptions.TemplateSyntaxError: expected token ',', got 'static'\r\n    <li onclick=\"redirectUser('/homepage')\">Home</li>\r\njinja2.exceptions.TemplateSyntaxError: expected token ',', got 'string'\r\n```\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.12.4\r\n- Flask version: 3.0.3\r\n",
        "user": "K0sh1R1zumu",
        "start_time": "2024-07-18T07:33:00Z",
        "end_time": "2024-07-18T07:45:48Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5530.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5527,
        "title": "\"catch-all\" endpoint doesn't work with `static_url_path=\"/\"`",
        "body": "### Catch all endpoint for SPA from [docs](https://flask.palletsprojects.com/en/2.2.x/patterns/singlepageapplications/) doesn't work with `static_url_path=\"/\"` or `static_url_path=\"\"`\r\n\r\n### Context\r\n\r\nI'm using Flask to serve React SPA with client-side routing. \r\nFlask worked perfectly, until I added images and decided to serve it from `static/` folder.\r\n\r\n### Expected:\r\n\r\nI can serve images from `static/` folder. \r\nI can reload a non-root page and Flask won't respond with `404 Not Found`.\r\n\r\n### Current:\r\n\r\nI can navigate to `/path` or `/path1/path2` and etc. with no problems, but when I reload any non-root page the Flask gives me `404 Not Found` and the catch-all route didn't trigger.\r\n\r\n\r\n### Example:\r\n\r\n**`folder structure`**\r\n```\r\n.\r\n├── __init__.py\r\n└── main/\r\n    ├── static/\r\n    │   ├── image1.jpg\r\n    │   ├── image2.jpg\r\n    │   ├── index.html\r\n    │   └── main.js\r\n    ├── __init__.py\r\n    └── routes.py\r\n```\r\n\r\n**`./__init__.py`**\r\n```python\r\ndef create_app(config_class=Config) -> Flask:\r\n  app = Flask(__name__)\r\n  from .main import bp as main_bp\r\n  app.register_blueprint(main_bp)\r\n  return app\r\n```\r\n\r\n**`./main/__init__.py`**\r\n```python\r\nfrom flask import Blueprint\r\n\r\nbp = Blueprint(\"main\", __name__, static_folder=\"static\", static_url_path=\"/\")\r\n\r\nfrom .main import routes\r\n``` \r\n\r\n**`./main/routes.py`**\r\n```python\r\nfrom .main import bp\r\n\r\n@bp.route(\"/\", defaults={\"path\": \"\"})\r\n@bp.route(\"/<path:path>\")\r\ndef catch_all(path):\r\n    return bp.send_static_file(\"index.html\")\r\n```\r\n\r\n### Error message\r\n\r\n```\r\n<!doctype html>\r\n<html lang=en>\r\n<title>404 Not Found</title>\r\n<h1>Not Found</h1>\r\n<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>\r\n```\r\n\r\nEnvironment:\r\n\r\n- Python version: `Python 3.9.2`\r\n- Flask version: `Flask 2.2.5`\r\n",
        "user": "DRMPN",
        "start_time": "2024-07-12T16:07:14Z",
        "end_time": "2024-07-14T18:17:04Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5527.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5523,
        "title": "Update Werkzeug to 3.0.3",
        "body": "Update Werkzeug to 3.0.3 to address vulnerability found in Werkzeug debugger.\r\nhttps://werkzeug.palletsprojects.com/en/3.0.x/changes/\r\n\r\nUpdating Werkzeug to version 3.0.3 fixes the debugger vulnerability.\r\n\r\n",
        "user": "gaburn",
        "start_time": "2024-07-09T21:45:29Z",
        "end_time": "2024-07-09T22:04:33Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5524,
                "title": "bumping werkzueg version to 3.0.3",
                "url": "https://github.com/pallets/flask/pull/5524",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "58f16692699d06a273a4bac7f63a65b916702014",
                "message": "bumping Werkzeug version to 3.0.3",
                "author": "Gary Burns",
                "date": "2024-07-09T19:54:27Z"
            },
            {
                "sha": "dcd00c30d39e4054068646a3139784372eef7e1b",
                "message": "bumping werkzueg version to 3.0.3 in tests",
                "author": "Gary Burns",
                "date": "2024-07-09T19:57:04Z"
            }
        ],
        "affected_files": [
            "pyproject.toml",
            "requirements-skip/tests-min.txt",
            "CHANGES.rst",
            "requirements-skip/tests-min.in"
        ],
        "stats": {
            "total_commits": 2,
            "total_files": 4,
            "total_prs": 1
        }
    },
    {
        "id": 5521,
        "title": "false redirect from /name to /name/ causes 404",
        "body": "<!--\r\nroute name redirects to /name/ when the canonical name is /name\r\nthis causes the page to be 404 Not Found, since when using /name as a canonical name, / isn't avaliable\r\n-->\r\n\r\n<!--\r\nhow to replicate:\r\ndownload flask on ubuntu 24.04 using the command:\r\nsudo apt install python3-flask\r\n\r\nrun the code from the terminal:\r\nflask --app my_app run --debug\r\nin this order:\r\n1). first using @app.route(\"/hello\")\r\n2). then using @app.route(\"/hello/\")\r\n3). then using @app.route(\"/hello\")\r\nthe page should now autocomplete /hello to /hello/\r\n\r\nexample end code picture: \r\n![Screenshot from 2024-07-08 22-01-58](https://github.com/pallets/flask/assets/87893493/1a91c062-4739-497d-8446-32089db91017)\r\n-->\r\n\r\n<!--\r\nafter changing back the code to @app.route(\"/name\") the code should have not autocompleted the url to /name/\r\n-->\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.12.3\r\n- Flask version: 3.0.2\r\n",
        "user": "shirjs",
        "start_time": "2024-07-08T19:10:37Z",
        "end_time": "2024-07-08T19:29:59Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5521.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5519,
        "title": "Flask incorrectly parses chained query parameters ",
        "body": "When accessing the /test route with both category and location query parameters (http://localhost:5000/test?category=fish&location=water), Flask correctly parses category but ignores location.\r\n\r\n### Steps to Reproduce\r\nAccess the URL http://localhost:5000/test?category=fish&location=water.\r\nExpected behavior: Both category and location parameters should be correctly parsed by Flask.\r\nActual behavior: Flask parses category correctly (\"excavator\"), but location is ignored.\r\n\r\n```(python)\r\nfrom flask import Flask, request, jsonify\r\n\r\napp = Flask(__name__)\r\n\r\n@app.route(\"/test\")\r\ndef test():\r\n    category = request.args.get(\"category\")\r\n    location = request.args.get(\"location\")\r\n    return {\"category\": category, \"location\": location}\r\n\r\nif __name__ == \"__main__\":\r\n    app.run(debug=True)\r\n```\r\n\r\nExpected:\r\n```(json)\r\n{\r\n    \"category\": \"fish\",\r\n    \"location\": \"water\"\r\n}\r\n```\r\n\r\nGot:\r\n```(json)\r\n{\r\n    \"category\": \"fish\",\r\n    \"location\": null\r\n}\r\n```\r\n### Environment:\r\n\r\n- Python version: 3.8.10\r\n- Flask version: 3.0.3\r\n",
        "user": "alemiherbert",
        "start_time": "2024-07-07T00:27:03Z",
        "end_time": "2024-07-07T01:19:13Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5519.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5513,
        "title": "Handler `before_request` doesn't work as expected.",
        "body": "I want to implement CORS processing without any third party libraries (like flask-cors). My desire is simple: assign multiple headers to any response, access and process the pre-flight OPTIONS request.\r\n\r\n```python\r\nclass CORSMiddleware:\r\n    def before_request(self):\r\n        if request.method == \"OPTIONS\":\r\n            response = jsonify({\"status\": \"ok\"})\r\n            return self.process_response(response)\r\n\r\n    def after_request(self, response):\r\n        return self.process_response(response)\r\n\r\n    # noinspection PyMethodMayBeStatic\r\n    def process_response(self, response):\r\n        if response:\r\n            response.headers.add(\"Access-Control-Allow-Origin\", \"*\")\r\n            response.headers.add(\"Access-Control-Allow-Headers\", \"Content-Type, Authorization\")\r\n            response.headers.add(\"Access-Control-Allow-Methods\", \"GET, POST, OPTIONS, DELETE, PUT\")\r\n        return response\r\n\r\n    def register(self, app: Flask):\r\n        app.before_request(self.before_request)\r\n        app.after_request(self.after_request)\r\n```\r\n\r\nIt can be tested like this\r\n\r\n```py\r\n\r\n# Note: helper function to reduce view logic\r\ndef add_cors_headers(response):\r\n    response.headers.add(\"Access-Control-Allow-Origin\", \"*\")\r\n    response.headers.add(\"Access-Control-Allow-Headers\", \"Content-Type,Authorization\")\r\n    response.headers.add(\"Access-Control-Allow-Methods\", \"GET,POST,OPTIONS,DELETE,PUT\")\r\n    return response\r\n\r\n\r\nuser_blueprint = Blueprint(\"user\", __name__, url_prefix=\"/users\")\r\n\r\n\r\n@user_blueprint.route(\"/signup\", methods=[\"POST\", \"OPTIONS\"])\r\ndef create_user_handler():\r\n    # Note: uncomment me to see a desired behaviour\r\n    # if request.method == \"OPTIONS\":\r\n    #     response = jsonify({\"status\": \"ok\"})\r\n    #     return add_cors_headers(response)\r\n    # response = jsonify({\"message\": \"registered\"})\r\n    # return add_cors_headers(response)\r\n    return {\"message\": \"registered\"}\r\n\r\n\r\ndef create_app() -> Flask:\r\n    app = Flask(__name__)\r\n    app.register_blueprint(user_blueprint)\r\n    # Note: comment me to see a desired behaviour\r\n    CORSMiddleware().register(app)\r\n    return app\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    app = create_app()\r\n    app.run(host=\"127.0.0.1\", port=5000, debug=True\r\n```\r\n\r\nWith the middleware, it handles a preflight OPTIONS request as an original one:\r\n<img width=\"650\" alt=\"Screenshot 2024-07-01 at 10 59 27\" src=\"https://github.com/pallets/flask/assets/45794357/b49f736d-5b1b-46c7-8569-aa6dd178266c\">\r\n\r\nBut the desired behaviour should be like that (you can comment middleware registration and uncomment logic in the view-handler):\r\n<img width=\"653\" alt=\"Screenshot 2024-07-01 at 11 00 15\" src=\"https://github.com/pallets/flask/assets/45794357/9668ea85-de6a-46c2-8c8c-39b9b1ffd7b7\">\r\n\r\nAlso, I was able to implement desired functionality with the middleware, but with the Werkzeug one:\r\n\r\n```py\r\nfrom werkzeug.wrappers import Request, Response\r\n\r\n\r\nclass CORSMiddleware:\r\n    def __init__(self, app):\r\n        self.app = app\r\n\r\n    def __call__(self, environ, start_response):\r\n        request_ = Request(environ)\r\n\r\n        if request_.method == \"OPTIONS\":\r\n            response = Response(status=200)\r\n            response = self.process_response(response)\r\n            return response(environ, start_response)\r\n\r\n        def custom_start_response(status, headers, exc_info=None):\r\n            response_headers = self.process_headers(headers)\r\n            return start_response(status, response_headers, exc_info)\r\n\r\n        return self.app(environ, custom_start_response)\r\n\r\n    def process_response(self, response):\r\n        response.headers.add(\"Access-Control-Allow-Origin\", \"*\")\r\n        response.headers.add(\"Access-Control-Allow-Headers\",\r\n                             \"Content-Type, Authorization\")\r\n        response.headers.add(\"Access-Control-Allow-Methods\",\r\n                             \"GET, POST, OPTIONS, DELETE, PUT\")\r\n        return response\r\n\r\n    def process_headers(self, headers):\r\n        headers.append((\"Access-Control-Allow-Origin\", \"*\"))\r\n        headers.append((\"Access-Control-Allow-Headers\", \"Content-Type, Authorization\"))\r\n        headers.append(\r\n            (\"Access-Control-Allow-Methods\", \"GET, POST, OPTIONS, DELETE, PUT\"))\r\n        return headers\r\n\r\n\r\n# and registering it like that\r\ndef create_app() -> Flask:\r\n    app = Flask(__name__)\r\n    app.register_blueprint(user_blueprint)\r\n    app.wsgi_app = CORSMiddleware(app.wsgi_app)\r\n    return app\r\n```\r\n\r\nSo, my question is: what could be wrong with the Flask middleware?",
        "user": "hrimov",
        "start_time": "2024-07-01T12:41:52Z",
        "end_time": "2024-07-01T15:51:19Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5513.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5512,
        "title": "Document behaviour of __init__ in cli.prepare_import()",
        "body": "The code in [cli](https://github.com/pallets/flask/blob/main/src/flask/cli.py#L215) is a bit confusing: if you have an __init__ file in the project it causes the cli to step out of the directory and import it from outside the directory.\r\n\r\nE.h. I was working in directory /Users/visgean/p/social-flask/chapter2/models_app and the flask run command tried to import the app as chapter2.models_app.app, which did not work:\r\n\r\n```\r\nError: While importing 'chapter2.models_app.app', an ImportError was raised:\r\n```\r\n\r\nI had to dig into the code to see that the solution is to delete the init file, apparently i am not the only one: https://stackoverflow.com/questions/70835630/while-importing-myapp-app-an-import-error-was-raised\r\n\r\n\r\nI think this feature is a bit undcomented and to be honest I am not sure what the goal is. If I run flask run in a directory I dont want it to work at all with the parent directory. E.g. flask should only be aware of the current directory.\r\n\r\nProposed fixes: \r\n- Specifically mention this behavior on start e.g. \"importing app as chapter2.models_app.app due to presence of __init__.py\"\r\n- Mention this behaviour in docs somewhere\r\n- Remove this behavior unless there is a clear need for it. ",
        "user": "Visgean",
        "start_time": "2024-06-28T15:32:58Z",
        "end_time": "2024-06-28T16:32:22Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5512.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5508,
        "title": "get 请求，定义参数类型的问题",
        "body": "为什么在 get 请求中，设置某个参数类型为 int 类型。\r\n![image](https://github.com/pallets/flask/assets/38832100/6f2ad22b-63b1-4ea1-8567-975d146c061c)\r\n\r\n\r\n而在浏览器这样请求时，却报 404  错误。\r\n![image](https://github.com/pallets/flask/assets/38832100/0c28c5c7-bb27-4669-b877-c90fb7b0e68a)\r\n\r\n\r\nFlaks 版本\r\n![image](https://github.com/pallets/flask/assets/38832100/244e1622-2ea0-42ef-98f9-7710c55d83f9)\r\n\r\n",
        "user": "840326521",
        "start_time": "2024-06-25T01:27:43Z",
        "end_time": "2024-06-25T04:45:17Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5508.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5504,
        "title": "allow setting encoding in open_resource()",
        "body": "This is a duplicate of #1740 &mdash; that may have been closed for lack of a clear rationale, however, and I'd like to suggest it again with the following reasoning.\r\n\r\nThe documentation currently gives this example for using `open_resource()`:\r\n\r\n```python\r\nwith app.open_resource(\"schema.sql\") as f:\r\n    conn.executescript(f.read())\r\n```\r\n\r\nOn Windows, however, this can fail to open a file encoded in UTF-8, which most are these days, and safer code looks like this:\r\n\r\n```python\r\nwith app.open_resource(\"schema.sql\", mode=\"rb\") as f:\r\n   conn.executescript(f.read().decode(\"utf-8\"))  # type: ignore [attr-defined]\r\n```\r\n\r\n(The type comment is needed to prevent mypy from complaining about `f.read()` possibly being a string with no `.decode()` method, as it can't tell that the file was opened in 'rb' mode.)\r\n\r\nIt would be cleaner and more flexible to be able to write:\r\n\r\n```python\r\nwith app.open_resource(\"schema.sql\", encoding=\"utf-8\") as f:\r\n   conn.executescript(f.read())\r\n```\r\n",
        "user": "liffiton",
        "start_time": "2024-06-20T16:05:45Z",
        "end_time": "2024-07-11T02:16:47Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5525,
                "title": "Add unit tests to show, that encoding parameter in open_resource method is required",
                "url": "https://github.com/pallets/flask/pull/5525",
                "state": "closed"
            },
            {
                "number": 5526,
                "title": "Add encoding parameter to open resource",
                "url": "https://github.com/pallets/flask/pull/5526",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "8249bc1ed4ae8dbd7df104bc9afc17de35ad1628",
                "message": "add unit tests to show, that encoding parameter in open_resource method is necessary",
                "author": "mark",
                "date": "2024-07-10T14:37:32Z"
            },
            {
                "sha": "8230149e521a0005c54b5321a9abe8b46a8bdd31",
                "message": "[pre-commit.ci] auto fixes from pre-commit.com hooks\n\nfor more information, see https://pre-commit.ci",
                "author": "pre-commit-ci[bot]",
                "date": "2024-07-10T11:47:15Z"
            },
            {
                "sha": "4121e1119301f7c58e3e7d9de58ec73e1387adc2",
                "message": "delete empty string",
                "author": "mark",
                "date": "2024-07-10T15:04:06Z"
            },
            {
                "sha": "28d5a4d71824ff5823ae310e3fd014b48b33d583",
                "message": "add encoding parameter to open_resource\n\nco-authored-by: mark <lopkophacked@protonmail.com>",
                "author": "David Lord",
                "date": "2024-07-10T14:37:32Z"
            }
        ],
        "affected_files": [
            "src/flask/blueprints.py",
            "tests/test_helpers.py",
            "src/flask/app.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 4,
            "total_files": 4,
            "total_prs": 2
        }
    },
    {
        "id": 5502,
        "title": "IPP",
        "body": ".",
        "user": "Kikkoperico",
        "start_time": "2024-06-14T23:57:38Z",
        "end_time": "2024-06-15T00:00:18Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5502.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5494,
        "title": "request parsing special parameters",
        "body": "I want to know when i send \"http://127.0.0.1:5000/?name=xiaojiann+&age=16\" , why request.query_string can get b'name=xiaojiann+' but request.arg get ImmutableMultiDict([('name', 'xiaojiann ')]), request.args use blank space replace +\r\n\r\n<img width=\"739\" alt=\"image\" src=\"https://github.com/pallets/flask/assets/61368566/0a58880c-a70b-4455-a949-4af5ff55ca5b\">\r\n\r\nI try flask version 2.0.3 , 3.0.3 and python version 3.6 , 3.10",
        "user": "liangxiaojian0210",
        "start_time": "2024-06-03T08:06:41Z",
        "end_time": "2024-06-03T12:08:25Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5494.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5491,
        "title": "Avoid opening sessions for static resources",
        "body": "Every HTTP request currently results in an HTTP session being opened via `SessionInterface.open_session`. When a server-side session implementation is used, like [Flask-Session](https://flask-session.readthedocs.io/), this results in storage writes to update the expiry date. Requests for static resources are also subject to this, which can degrade performance.\r\n\r\nIt would be useful to easily opt static resources out of sessions. Currently this is only possible with a custom session interface, for example:\r\n\r\n```python\r\nclass StaticRequestFilteringSessionInterface(SessionInterface):\r\n    def __init__(self, app):\r\n        self._delegate = app.session_interface\r\n        self._exclude_path_prefix = app.static_url_path + \"/\"\r\n\r\n    def open_session(self, app, request):\r\n        if request.path.startswith(self._exclude_path_prefix):\r\n            return self.make_null_session(app)\r\n\r\n        return self._delegate.open_session(app, request)\r\n\r\n    def save_session(self, app, session, response):\r\n        return self._delegate.save_session(app, session, response)\r\n```\r\n\r\nConfigured with:\r\n\r\n```python\r\nfrom flask_session import Session\r\n\r\n...\r\nSession(app)\r\napp.session_interface = StaticRequestFilteringSessionInterface(app)\r\n```",
        "user": "markhobson",
        "start_time": "2024-05-30T18:55:26Z",
        "end_time": "2024-05-30T18:59:37Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5491.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5489,
        "title": "Flask ignores multiple slashes at the beginning of the path",
        "body": "<!--\r\nThis issue tracker is a tool to address bugs in Flask itself. Please use\r\nGitHub Discussions or the Pallets Discord for questions about your own code.\r\n\r\nReplace this comment with a clear outline of what the bug is.\r\n-->\r\n\r\n<!--\r\nDescribe how to replicate the bug.\r\n\r\nInclude a minimal reproducible example that demonstrates the bug.\r\nInclude the full traceback if there was an exception.\r\n-->\r\n\r\n<!--\r\nDescribe the expected behavior that should have happened but didn't.\r\n-->\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.8.14\r\n- Flask version: 2.3.2\r\n\r\nI have a paths with prefix /admin. if you follow a path containing this prefix, proxy  before app see this and asks mTLS auth. But when i follow this path with multiple slashes at the beginning (ex //admin, ///admin) proxy ignore this, but flask think that this is the same path as /admin and return values, client must not see. I think this should not work like this\r\n",
        "user": "Kotifnat",
        "start_time": "2024-05-27T08:49:39Z",
        "end_time": "2024-05-27T16:05:42Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5489.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5483,
        "title": "send_from_directory unclosed file error",
        "body": "When warnings are set to error, pytest claims there is an unclosed file when `send_from_directory` is called.  I assume this indicates there is a resource leak.  Even if Python garbage collects this at some point, this causes issues with testing flask applications that use send_from_directory with warnings as errors enabled.\r\n\r\n1. Create app\r\n\r\napp.py:\r\n```\r\nfrom flask import Flask, send_from_directory\r\napp = Flask(__name__)\r\n\r\n@app.route('/<path:name>')\r\ndef download_resources(name):\r\n    return send_from_directory('resources', name)\r\n```\r\n\r\n\r\n2. Add `resources/file.txt`\r\n\r\n```bash\r\nmkdir resources\r\necho file > resources/file.txt\r\n```\r\n\r\n\r\n3. Add tests\r\n\r\ntests/conftest.py:\r\n```\r\nimport pytest\r\n\r\nfrom app import app as flask_app\r\n\r\n@pytest.fixture\r\ndef app():\r\n    yield flask_app\r\n\r\n@pytest.fixture\r\ndef client(app):\r\n    return app.test_client()\r\n```\r\n\r\ntests/test_app.py:\r\n```\r\ndef test_download(app, client):\r\n    res = client.get('/file.txt')\r\n    assert res.status_code == 200\r\n```\r\n\r\n4. Run tests\r\n\r\nExecute `pytest -Werror`.\r\n\r\nThe results ([results.txt](https://github.com/pallets/flask/files/15325158/results.txt)) include the following error:\r\n` ResourceWarning: unclosed file <_io.BufferedReader name='/flask-test/resources/file.txt'>`\r\n\r\nExpected Results:\r\n\r\nExecute `pytest` without warnings as errors.  This is the expected result:\r\n\r\n```\r\n============================= test session starts ==============================\r\nplatform darwin -- Python 3.11.9, pytest-8.2.0, pluggy-1.5.0\r\nrootdir: /flask-test\r\ncollected 1 item\r\n\r\ntests/test_app.py .                                                      [100%]\r\n\r\n============================== 1 passed in 0.02s ===============================\r\n```\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.11.9\r\n- Flask version: 3.0.3\r\n",
        "user": "PaulWhitingUVC",
        "start_time": "2024-05-15T18:03:38Z",
        "end_time": "2024-05-15T18:31:53Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5483.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5479,
        "title": "Change of query string encoding behaviour in flask 3.0",
        "body": "Flask until 2.0 decoded %-encoded entities from query strings, while it seems that Flask 3.0 does not.\r\n\r\nGiven this `print_args.py`:\r\n\r\n```py\r\nfrom flask import Flask, request\r\n\r\napp = Flask(__name__)\r\n\r\n\r\n@app.route(\"/\")\r\ndef hello_world():\r\n    return request.args.get(\"test\")\r\n```\r\n\r\nOk Flask 2:\r\n\r\n```\r\n$ flask --version\r\nPython 3.11.2\r\nFlask 2.2.2\r\nWerkzeug 2.2.2\r\n$ flask --app print_args run\r\n...\r\ncurl http://127.0.0.1:5000?test=%A0+++a\r\n�   a\r\n```\r\n\r\nOn Flask 3:\r\n\r\n```\r\n$ flask --version\r\nPython 3.11.9\r\nFlask 3.0.3\r\nWerkzeug 3.0.2\r\n$ flask --app print_args run\r\n...\r\ncurl http://127.0.0.1:5000?test=%A0+++\r\n%A0   a\r\n```\r\n\r\nWhile I understand  %A0 is not a valid unicode sequence, this is a change of behaviour may be worth documenting.",
        "user": "spanezz",
        "start_time": "2024-05-07T08:56:15Z",
        "end_time": "2024-05-07T13:31:48Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5479.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5472,
        "title": "Add support for partitioned session cookies",
        "body": "Related issue with historical context: https://github.com/pallets/werkzeug/issues/2797\r\n\r\nPartitioned cookies are now supported in Werkzeug: https://github.com/pallets/werkzeug/pull/2855\r\n\r\nIt would be nice to have first-class support for the flask session cookie using the `Partitioned` flag to provide support for Chrome's CHIPS and allow sessions to continue to work within iframes.\r\n\r\nExample usage might be:\r\n\r\n```python\r\napp.config['SESSION_COOKIE_SAMESITE'] = \"None\"\r\napp.config['SESSION_COOKIE_SECURE'] = True\r\napp.config['SESSION_COOKIE_PARTITIONED'] = True # add this?\r\n```\r\n",
        "user": "bookernath",
        "start_time": "2024-04-30T16:22:37Z",
        "end_time": "2024-11-01T23:26:39Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5499,
                "title": "add SESSION_COOKIE_PARTITIONED config",
                "url": "https://github.com/pallets/flask/pull/5499",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "9efc1ebeeb431769897798cdf8de2c67dcbbc9c0",
                "message": "add SESSION_COOKIE_PARTITIONED config\n\nco-authored-by: Jose Cespedes <josecespedes@ibm.com>",
                "author": "David Lord",
                "date": "2024-06-10T01:55:22Z"
            }
        ],
        "affected_files": [
            "CHANGES.rst",
            "tests/test_basic.py",
            "src/flask/app.py",
            "docs/config.rst",
            "src/flask/sessions.py"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 5,
            "total_prs": 1
        }
    },
    {
        "id": 5471,
        "title": "Failing to start (due to port unavailable) cannot be directly determined by the current python api",
        "body": "I believe that failing to start (due to the designated port being unavailable) cannot be directly determined by the current python api, if not mistaken.\r\n\r\nWhen the port specified for startup is taken, a python code starting the server with Werkzeug cannot know if startup has failed, since no exception is raised, and no api is there to check on its status, while the following is written to stderr:\r\n\r\n> Address already in use\r\n> Port 5000 is in use by another program. Either identify and stop that program, or start the server with a different port.\r\n\r\nexample code:\r\n\r\n```python\r\nfrom flask import Flask\r\nfrom werkzeug.serving import run_simple\r\n\r\napp = Flask(__name__)\r\n\r\ntry:\r\n    run_simple('127.0.0.1', 5000, app)  \r\nexcept Exception as e:\r\n    start_success = False\r\n```\r\n\r\nEven though traditionally most web servers frameworks did not touch up their startup and shutdown usability from code to those levels, I think it would be implied to provide the caller with this basic level of transparency being robustly enabled for them. Apologies in advance if I've missed any obvious way. \r\n\r\n# Environment:\r\n\r\n- Python version: 3.10.13\r\n- Flask version: 3.0.3\r\n- Platform: Ubuntu 22.04\r\n\r\n# Mildly related on the same theme of api startup and shutdown: \r\nhttps://stackoverflow.com/questions/72824420/how-to-shutdown-flask-server",
        "user": "matanox",
        "start_time": "2024-04-28T10:18:02Z",
        "end_time": "2024-04-28T15:13:06Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5471.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5462,
        "title": "Conflicting cookies shenanigans with `SESSION_COOKIE_DOMAIN`",
        "body": "Hi,\r\nI encountered a strange behavior of flask regarding cookies when the value of `SESSION_COOKIE_DOMAIN` is updated after some cookies have been set.\r\nI observed this with Python 3.11, Flask 3.0.2 and Werkzeug 3.0.2 with both Firefox 124 and Chrome 123.\r\nFirst of all, I could not reproduce the issue when serving on http://localhost:5000, so you might need to add `127.0.0.1 flask.localhost` in your `/etc/hosts` to be able to reproduce this, and access the app from http://flask.localhost:5000.\r\n\r\n0. Put the following snippet in an `app.py` and run it with `env FLASK_DEBUG=1 FLASK_APP=app flask run`. \r\n```python\r\nimport flask\r\nimport base64\r\napp = flask.Flask(__name__)\r\napp.config[\"SECRET_KEY\"] = \"super secret\"\r\napp.config[\"SERVER_NAME\"] = \"flask.localhost:5000\"\r\napp.config[\"SESSION_COOKIE_DOMAIN\"] = app.config[\"SERVER_NAME\"]\r\n\r\n@app.route(\"/\", methods=(\"GET\", \"POST\"))\r\ndef index():\r\n    if flask.request.form:\r\n        flask.session[\"value\"] = flask.request.form[\"value\"]\r\n\r\n    session_cookies = [\r\n        base64.b64decode(cookie.split(\".\")[0]).decode()\r\n        for cookie in flask.request.cookies.getlist(\"session\")\r\n    ]\r\n    return (\r\n        '<form action=\"/\" method=\"post\"><input name=\"value\"><input type=\"submit\"></form\"><br>\\n'\r\n        + f'value {flask.session.get(\"value\")}<br>\\n'\r\n        + \"cookies: \" + \" \".join(session_cookies)\r\n    )\r\n```\r\n\r\n2. **Open http://flask.localhost:5000, clean the cookies if existing.**\r\n`flask.session` is empty.\r\n3. **Write `foo` in the form, validate.**\r\n`session[\"value\"]` contains `foo`.\r\n4. **Reload the page**\r\n`session[\"value\"]` still contains `foo`.\r\nThe firefox dev tools indicate that the cookie domain is `.flask.localhost` (with a leading dot).\r\n5. **Comment the `app.config[\"SESSION_COOKIE_DOMAIN\"] = app.config[\"SERVER_NAME\"]` line**\r\n6. **Reload the page**\r\n`session[\"value\"]` still contains `foo`.\r\n7. **Write `bar` in the form, validate.**\r\n`session[\"value\"]` still contains `bar`.\r\n8. **Reload the page**\r\n`session[\"value\"]` contains `foo`, which is unexpected.\r\nA cookie has been set on step 6, and the firefox dev tools indicate that the cookie domain is `flask.localhost` (without a leading dot).\r\nHowever it seems the value is read from the step 2. cookie. that is still around.\r\n`flask.request.cookies.getlist(\"session\")` contains two cookies, with the values `foo` and `bar`.\r\n\r\nThose steps work also by starting with the `SESSION_COOKIE_DOMAIN` commented and then uncomment it at step 4.\r\nThe issue is not reproductible without the `app.config[\"SERVER_NAME\"] = \"flask.localhost:5000\"` line.\r\n\r\nThe [SESSION_COOKIE_DOMAIN documentation](https://flask.palletsprojects.com/en/3.0.x/config/#SESSION_COOKIE_DOMAIN) mentions that different values produce different cookies. However it does not mention that different cookies could conflict, neither that changing the value should be avoided.\r\n\r\nMaybe there is some misconfiguration on my side (is it?) but nonetheless it feels strange that Flask could write in one session cookie (step 6.) and then read from another session cookie (step 7.).\r\n\r\nDeleting the cookies solve the situation, however I can not expect the users of my production application to delete their cookies so the application is functionning again. And the curse is that some of my users have their cookies created with subdomains support, and some other have their cookies without subdomains support. So setting or deleting `SESSION_COOKIE_DOMAIN` will fix the issue for ones while provoking it for the other ones.\r\n\r\nWhat do you think?",
        "user": "azmeuk",
        "start_time": "2024-04-09T17:50:48Z",
        "end_time": "2024-05-25T17:27:14Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5464,
                "title": "`SESSION_COOKIE_DOMAIN` caveat documentation",
                "url": "https://github.com/pallets/flask/pull/5464",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "4a1766c252bac0de1368cc4eaefba1299f77d546",
                "message": "document caveats on SESSION_COOKIE_DOMAIN\n\nChanging this value might result in browsers with several competing session cookies. In\nthat situation there is no guarantee of which one will be sent first, and be used as the\nsession cookie.",
                "author": "Éloi Rivard",
                "date": "2024-04-15T16:28:25Z"
            }
        ],
        "affected_files": [
            "docs/config.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 1,
            "total_prs": 1
        }
    },
    {
        "id": 5458,
        "title": "Calling `flash` after `get_flashed_messages` fails ",
        "body": "In a single request, do this:\r\n- call `get_flashed_messages()`\r\n- call `flash(...)`\r\n- call `get_flashed_messages()` again, observe that it returns the empty list, despite a message just having been flashed.\r\n\r\nAfter the first call to `get_flashed_messages()`, `request_ctx.flashes` is  `[]`, which appears to send this code in `get_flashed_messages` off the rails:\r\n\r\nhttps://github.com/pallets/flask/blob/98a7f9fcf09fce5d32bf25e7f917c1c3026719d1/src/flask/helpers.py#L364-L367\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.11\r\n- Flask version: 3.0.2\r\n",
        "user": "inducer",
        "start_time": "2024-04-07T01:37:11Z",
        "end_time": "2024-04-07T18:57:43Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5458.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5456,
        "title": "Unable to start flask3.0 app on a minimal implementation with `invalid syntax. Perhaps you forgot a comma? (scaffold.py, line 295)`",
        "body": "Simply create a minimal flask3.0 app as follow and execute it, it will fail instantly on importing `from flask import Flask`:\r\n```python\r\nfrom flask import Flask\r\n\r\napp = Flask(__name__)\r\n\r\n@app.route(\"/\")\r\ndef hello_world():\r\n    return \"<p>Hello, World!</p>\"\r\n\r\napp.run()\r\n```\r\n\r\nError trace:\r\n```text\r\nTraceback (most recent call last):\r\n  File \"/home/lazydreamer/anaconda3/envs/test_env/lib/python3.11/runpy.py\", line 198, in _run_module_as_main\r\n    return _run_code(code, main_globals, None,\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/lazydreamer/anaconda3/envs/test_env/lib/python3.11/runpy.py\", line 88, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/lazydreamer/.vscode-server/extensions/ms-python.debugpy-2024.4.0-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py\", line 39, in <module>\r\n    cli.main()\r\n  File \"/home/lazydreamer/.vscode-server/extensions/ms-python.debugpy-2024.4.0-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py\", line 430, in main\r\n    run()\r\n  File \"/home/lazydreamer/.vscode-server/extensions/ms-python.debugpy-2024.4.0-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py\", line 284, in run_file\r\n    runpy.run_path(target, run_name=\"__main__\")\r\n  File \"/home/lazydreamer/.vscode-server/extensions/ms-python.debugpy-2024.4.0-linux-x64/bundled/libs/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py\", line 321, in run_path\r\n    return _run_module_code(code, init_globals, run_name,\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/lazydreamer/.vscode-server/extensions/ms-python.debugpy-2024.4.0-linux-x64/bundled/libs/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py\", line 135, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/home/lazydreamer/.vscode-server/extensions/ms-python.debugpy-2024.4.0-linux-x64/bundled/libs/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py\", line 124, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/lazydreamer/Dev/TestProj/src/main.py\", line 3, in <module>\r\n    from app import flask_app\r\n  File \"/home/lazydreamer/Dev/TestProj/src/app.py\", line 1, in <module>\r\n    from flask import Flask\r\n  File \"/home/lazydreamer/anaconda3/envs/test_env/lib/python3.11/site-packages/flask/__init__.py\", line 6, in <module>\r\n    from .app import Flask as Flask\r\n  File \"/home/lazydreamer/anaconda3/envs/test_env/lib/python3.11/site-packages/flask/app.py\", line 43, in <module>\r\n    from .sansio.app import App\r\n  File \"/home/lazydreamer/anaconda3/envs/test_env/lib/python3.11/site-packages/flask/sansio/app.py\", line 31, in <module>\r\n    from .scaffold import _endpoint_from_view_func\r\n  File \"/home/lazydreamer/anaconda3/envs/test_env/lib/python3.11/site-packages/flask/sansio/scaffold.py\", line 295\r\n    raise TypeError('Use the 'route' decorator to use the 'methods' argument.')\r\n                    ^^^^^^^^^^^^^^^\r\nSyntaxError: invalid syntax. Perhaps you forgot a comma?\r\n```\r\n\r\n![image](https://github.com/pallets/flask/assets/8576808/3dc5e15b-2fd7-4c46-a571-2571135a1a58)\r\n\r\nI am not sure what does the exception message `'Use the 'route' decorator to use the 'methods' argument.'` means as I've just upgraded to Flask3.0, but this message string is definitely not right, and I my project will not encounter any issue on Flask2.3.3.\r\n\r\nEnvironment:\r\n- Python version: 3.11.8\r\n- Flask version: 3.0.2\r\n- OS: Ubuntu",
        "user": "lazydreamerbliss",
        "start_time": "2024-04-06T12:17:26Z",
        "end_time": "2024-04-06T15:06:25Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5456.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5455,
        "title": "HTTP response status 204 (`No Content`) includes superfluous `Content-Type` header",
        "body": "\r\nWhen returning HTTP code `204` Flask will include a `Content-Type` header which is superfluous as there is no content.\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.9\r\n- Flask version: 3.0.2\r\n",
        "user": "ChrisHills463",
        "start_time": "2024-04-02T16:09:38Z",
        "end_time": "2024-04-02T16:28:46Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5455.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5450,
        "title": "Post request response time spikes",
        "body": "Hello,\r\n\r\nin my project I need to upload images as bytes to an endpoint and then process them, within a certain time. The images have a resolution of 600x600 and weight ~700 kB per image. Images are in png format. I have created a minimal flask application with one endpoint. The application is served using a waitress.\r\n\r\nThe problem is that sometimes response time from an endpoint suddenly increases by an order of magnitude. As I have to fit in a certain amount of time, such spikes can cause a critical error.\r\n\r\nI ran a cProfile on the post request and found out that when there is a spike two functions take more time than normal:\r\n\r\n**Normal**\r\n\r\n```\r\nncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n     2    0.000    0.000    0.000    0.000 {method 'sendall' of '_socket.socket' objects}\r\n     1    0.004    0.004    0.004    0.004 {method 'recv_into' of '_socket.socket' objects}\r\n```\r\n\r\n**Spike**\r\n\r\n```\r\nncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n     2    0.008    0.004    0.008    0.004 {method 'sendall' of '_socket.socket' objects}\r\n     1    0.012    0.012    0.012    0.012 {method 'recv_into' of '_socket.socket' objects}\r\n```\r\n\r\nWhat is the cause of these spikes, and can they be resolved in some way?\r\n\r\nCode to reproduce:\r\n\r\n```\r\n# app.py\r\nimport numpy as np\r\nfrom flask import Flask, request\r\n\r\n\r\ndef create_app():\r\n    app = Flask(__name__)\r\n\r\n    @app.route(\"/endpoint\")\r\n    def endpoint():\r\n        data = request.data\r\n        img_arr = np.frombuffer(data, dtype=np.uint8)\r\n        # ...\r\n        return {\"foo\": \"bar\"}\r\n\r\n    return app\r\n```\r\n\r\n```\r\n# wsgi.py\r\nfrom waitress import serve\r\n\r\nfrom app import create_app\r\n\r\n\r\ndef main():\r\n    app = create_app()\r\n    serve(app, host=\"0.0.0.0\", port=\"9009\")\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n```\r\n\r\n```\r\n# send.py\r\n\r\nfrom pathlib import Path\r\n\r\nimport numpy as np\r\nimport requests\r\nfrom PIL import Image\r\n\r\n\r\ndef main():\r\n    img_paths = list(Path(\"images\").rglob(\"*.png\"))\r\n    ses = requests.Session()\r\n    speeds = []\r\n    for img_path in img_paths:\r\n        img_arr = np.asarray(Image.open(img_path))\r\n        response = ses.post(url='http://0.0.0.0:9009/endpoint', data=img_arr.tobytes())\r\n        speeds.append(response.elapsed.total_seconds())\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n```\r\n\r\nPython and package versions:\r\n\r\n```\r\npython==3.8.18\r\n\r\nFlask==3.0.2\r\nnumpy==1.24.4\r\npillow==10.2.0\r\nrequests==2.31.0\r\nwaitress==3.0.0\r\n```\r\n\r\nThree independent performances for 1,000 images:\r\n\r\n[First](https://i.stack.imgur.com/53GEa.png)\r\n\r\n[Second](https://i.stack.imgur.com/1iFrD.png)\r\n\r\n[Third](https://i.stack.imgur.com/TxCpV.png)",
        "user": "chmjelek",
        "start_time": "2024-03-31T10:56:17Z",
        "end_time": "2024-03-31T16:27:32Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5450.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5448,
        "title": "Use of `hashlib.sha1` causes issue in FIPS build",
        "body": "The use of SHA1 found here: https://github.com/pallets/flask/blob/b90a4f1f4a370e92054b9cc9db0efcb864f87ebe/src/flask/sessions.py#L289\r\nprevents applications from running in a FIPS Enabled Environment/OS. The OS will abruptly stop the application from running when it detects a non compliant Hash Algorithm is used.\r\n\r\nDescribe how to replicate the bug:\r\nEnforce FIPS Enabled on the OS (such as RHEL9)\r\n\r\n\r\nUnexpected Behavior Error output:\r\n```bash\r\nTraceback (most recent call last):\r\n  File \"/opt/abc-app/app.py\", line 1, in <module>\r\n    from xxxxxxxxxx import xxxxxxx\r\n  File \"/opt/abc-app/abc-app_ui.py\", line 67, in <module>\r\n    sess.init_app(app=app)\r\n  File \"/opt/abc-app/venv/lib/python3.11/site-packages/flask_session/__init__.py\", line 50, in init_app\r\n    app.session_interface = self._get_interface(app)\r\n                            ^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/abc-app/venv/lib/python3.11/site-packages/flask_session/__init__.py\", line 79, in _get_interface\r\n    session_interface = FileSystemSessionInterface(\r\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/abc-app/venv/lib/python3.11/site-packages/flask_session/sessions.py\", line 312, in __init__\r\n    self.cache = FileSystemCache(cache_dir, threshold=threshold, mode=mode)\r\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/abc-app/venv/lib/python3.11/site-packages/cachelib/file.py\", line 73, in __init__\r\n    self._update_count(value=len(list(self._list_dir())))\r\n  File \"/opt/abc-app/venv/lib/python3.11/site-packages/cachelib/file.py\", line 95, in _update_count\r\n    self.set(self._fs_count_file, new_count, mgmt_element=True)\r\n  File \"/opt/abc-app/venv/lib/python3.11/site-packages/cachelib/file.py\", line 244, in set\r\n    filename = self._get_filename(key)\r\n               ^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/abc-app/venv/lib/python3.11/site-packages/cachelib/file.py\", line 201, in _get_filename\r\n    bkey_hash = self._hash_method(bkey).hexdigest()\r\n                ^^^^^^^^^^^^^^^^^^^^^^^\r\n_hashlib.UnsupportedDigestmodError: [digital envelope routines] unsupported\r\n```\r\n\r\nEnvironment:\r\nRHEL9 FIPS Enabled and Enforced\r\n\r\n- Python version: 3.x\r\n- Flask version: 3.0.2\r\n",
        "user": "jtrinh27",
        "start_time": "2024-03-29T00:05:14Z",
        "end_time": "2024-04-07T18:42:30Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5460,
                "title": "support FIPS builds without SHA-1",
                "url": "https://github.com/pallets/flask/pull/5460",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "db461112c70d5f2bf93c7a6ac27eeb665c232dd0",
                "message": "access sha1 lazily",
                "author": "David Lord",
                "date": "2024-04-07T18:30:30Z"
            }
        ],
        "affected_files": [
            "src/flask/sessions.py",
            "CHANGES.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 2,
            "total_prs": 1
        }
    },
    {
        "id": 5447,
        "title": "When using Flask to receive multiple files, an extra ‘0D’ appears at the end of some images",
        "body": "When using Flask to receive multiple image files, occasionally an extra \"0D\" appears at the end of the image. The original data is saved, and the end of this image is normal \"FFD90D0A\". Packet capture tools also show a normal ending. If this request is sent repeatedly, the same error will continue to occur, and the saved image cannot be resent to reproduce the issue.\r\n\r\nBelow is the main code for sending and receiving. This code cannot be run directly because it needs to read some data.\r\n\r\n```\r\nfiles={}\r\nfiles[i]=(\"name\", data[i], 'image/jpeg')\r\nresponse = requests.post(\r\n            \"http://192.168.1.50:8006/test\",\r\n            files = files,\r\n        )\r\n```\r\n\r\n\r\n```\r\nimport flask\r\n\r\napp = flask.Flask(__name__)\r\n\r\n@app.before_request\r\ndef before_request():\r\n    path=flask.request.path\r\n    data=flask.request.get_data(cache=True, as_text=False)\r\n    flask.request.data1=data\r\n\r\n@app.route('/test', methods = ['POST'])\r\ndef testfile():\r\n    data=flask.request.data1\r\n    files=flask.request.files\r\n    files=[(i,files[i]) for i in files]\r\n    for i in range(len(files)):\r\n        with open(f\"test/{i}.jpg\",\"wb\") as f:\r\n            files[i][1].seek(0, os.SEEK_END)\r\n            file_size = files[i][1].tell()\r\n            files[i][1].seek(0)\r\n            f.write(files[i][1].read(file_size))\r\n    return flask.jsonify({\"code\":0})\r\n\r\nif __name__ == '__main__':\r\n    app.run(host=\"0.0.0.0\",port=8006)\r\n```\r\n\r\n\r\n\r\nI have analyzed the raw data and source code, and used packet capture tools to view the received data, all of which are normal. I suspect there is a problem with the parsing, but the flask source code shows that the parsing will remove \"\\r\\n\", why would there still be errors?\r\n\r\nThe probability of this issue occurring is very small, making it difficult to reproduce. However, when it does occur, the same error will occur.",
        "user": "simpia",
        "start_time": "2024-03-27T08:03:15Z",
        "end_time": "2024-03-27T08:05:05Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5447.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    },
    {
        "id": 5445,
        "title": "Broken HTML Markup in Template Inheritance",
        "body": "The HTML Markup within the docs is broken. A <p> Tag is opened but never closed.",
        "user": "DanielSiepmann",
        "start_time": "2024-03-25T17:33:19Z",
        "end_time": "2024-03-25T17:37:29Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "PR_linked",
        "related_prs": [
            {
                "number": 5446,
                "title": "fix broken HTML markup",
                "url": "https://github.com/pallets/flask/pull/5446",
                "state": "closed"
            }
        ],
        "related_commits": [
            {
                "sha": "133e75c2869cb68c933f4e493df01074efea3d11",
                "message": "fix broken HTML markup\n\nClose the opened <p> Tag.",
                "author": "Daniel Siepmann",
                "date": "2024-03-25T17:30:50Z"
            }
        ],
        "affected_files": [
            "docs/patterns/templateinheritance.rst"
        ],
        "stats": {
            "total_commits": 1,
            "total_files": 1,
            "total_prs": 1
        }
    },
    {
        "id": 5442,
        "title": "Unable to silence logging messages",
        "body": "Im getting ~15 of:\r\n\r\n> 127.0.0.1 - - [16/Mar/2024 12:10:13] \"POST / HTTP/1.1\" 200 -\r\n\r\nin the terminal when Im running a Dash application.\r\n```\r\nserver = flask.Flask(__name__)\r\napp = dash.Dash(\r\n    __name__,\r\n    server=server,\r\n    external_stylesheets=[dbc.themes.BOOTSTRAP],\r\n    meta_tags=[\r\n        {\"name\": \"viewport\", \"content\": \"width=device-width, initial-scale=1\"}\r\n    ],\r\n)\r\n```\r\n(https://github.com/AlexKurek/srt-py/blob/master/srt/dashboard/app.py#L53)\r\n\r\nHow do I silence them? I have found a lot of methods, e.g. [Disable console messages in Flask server](https://stackoverflow.com/questions/14888799/disable-console-messages-in-flask-server), but none of them worked. My guess is that since they worked in previous versions of Flask - could this be a regression?\r\n\r\nEnvironment:\r\n\r\n- Python version: 3.11\r\n- Flask version: 3.0.2\r\n",
        "user": "AlexKurek",
        "start_time": "2024-03-20T11:19:28Z",
        "end_time": "2024-03-20T12:15:23Z",
        "state": "closed",
        "labels": [],
        "resolution_type": "manual",
        "related_prs": [],
        "related_commits": [],
        "affected_files": [
            "discussions/issue_5442.txt"
        ],
        "stats": {
            "total_commits": 0,
            "total_files": 1,
            "total_prs": 0
        }
    }
]